import{_ as V,r as L,k,o as $,l as z,b as D,d as b,s as W,h as j,K as N}from"./index-B1ovB_mj.js";import"https://fastly.jsdelivr.net/gh/GHchenjingqi/resources/mds/pathList.js";const U={class:"content bg"},G={class:"input-box"},K={__name:"AudioVisual",setup(O){let e,u,o,i,s,r,E,p,g=L(!1);const h=window.devicePixelRatio||1;let A=!1;const B=L("https://fastly.jsdelivr.net/gh/GHchenjingqi/qux/thz.mp3");function q(){C(),S(),F()}function C(){e=document.getElementById("acanvas"),u=e.getContext("2d"),e.width=e.clientWidth*h,e.height=e.clientHeight*h,u.scale(h,h)}function S(){o=document.getElementById("acanvas2"),i=o.getContext("2d"),o.width=o.clientWidth*h,o.height=o.clientHeight*h,i.scale(h,h)}function F(){s=document.getElementById("audio"),s.controls=!0,s.autoplay=!1,s.crossOrigin="anonymous",s.addEventListener("play",()=>{g.value=!0,A||P(),R(),I()}),s.addEventListener("pause",()=>{g.value=!1}),s.addEventListener("ended",()=>{g.value=!1,H()});const n=document.getElementById("bttn");n.onclick=()=>{g.value||(s.src=B.value,n.innerHTML="正在播放中",s.play())}}k(()=>g.value,n=>{n||(bttn.innerHTML="播放",s.pause())});function H(){u.clearRect(0,0,e.width,e.height),i.clearRect(0,0,o.width,o.height)}function P(){const n=new AudioContext,t=n.createMediaElementSource(s);r=n.createAnalyser(),E=r.frequencyBinCount,r.fftSize=E/2,t.connect(r),r.connect(n.destination),p=new Uint8Array(E),A=!0}function R(){if(!g)return;requestAnimationFrame(R),u.clearRect(0,0,e.width,e.height),r.getByteFrequencyData(p),u.clearRect(0,0,e.width,e.height);const n=r.frequencyBinCount,t=e.width/n,l=Math.floor(n/2);for(let f=0;f<l;f++){const c=p[f],v=c*(e.height/256),w=c+50>255?255:c+50,a=50,d=150;u.fillStyle=`rgb(${w},${a},${d})`;let y=f*t,m=e.height-v;u.fillRect(y,m,t,v);let x=e.width-(f+1)*t,M=e.height-v;u.fillRect(x,M,t,v)}}function I(){if(!g)return;requestAnimationFrame(I),r.getByteFrequencyData(p),i.clearRect(0,0,o.width,o.height);const n=r.frequencyBinCount,t=o.width/2,l=o.height/2,f=Math.min(t,l)*.8,c=f*.5,v=Math.PI*2/n;for(let a=0;a<n;a++){const d=p[a],y=d*(f-c)/256,m=d+50>255?255:d+50;i.fillStyle=`rgb(${m},50,150)`;const x=a*v,M=(a+1)*v,_=Math.PI*2-M,T=Math.PI*2-x;w(x,M,y),w(_,T,y)}function w(a,d,y){const m=c+y;i.beginPath(),i.moveTo(t+Math.cos(a)*c,l+Math.sin(a)*c),i.lineTo(t+Math.cos(a)*m,l+Math.sin(a)*m),i.arc(t,l,m,a,d),i.lineTo(t+Math.cos(d)*c,l+Math.sin(d)*c),i.arc(t,l,c,d,a,!0),i.closePath(),i.fill()}}return $(()=>{q()}),(n,t)=>(D(),z("section",U,[t[3]||(t[3]=b("h3",null,"音频可视化",-1)),b("div",G,[j(b("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>B.value=l)},null,512),[[N,B.value]]),t[1]||(t[1]=b("button",{id:"bttn"},"播放",-1)),t[2]||(t[2]=b("audio",{id:"audio",style:{display:"none"}},null,-1))]),t[4]||(t[4]=W('<div class="box-a" data-v-e80e6b70><div class="width50" style="width:calc(100% - 600px);" data-v-e80e6b70><canvas id="acanvas" data-v-e80e6b70></canvas></div><div class="width50" style="width:600px;" data-v-e80e6b70><canvas id="acanvas2" data-v-e80e6b70></canvas></div></div><p data-v-e80e6b70>实现代码：<a href="http://localhost:5173/#/knowledge/index?name=audio%E9%9F%B3%E9%A2%91%E5%8F%AF%E8%A7%86%E5%8C%96" data-v-e80e6b70>点击前往</a></p>',2))]))}},J=V(K,[["__scopeId","data-v-e80e6b70"]]);export{J as default};
