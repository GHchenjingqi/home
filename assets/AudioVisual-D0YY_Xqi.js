import{_ as H,r as V,i as $,o as k,j as T,m as W}from"./index-BziPuV5w.js";const z={class:"content bg"},D={__name:"AudioVisual",setup(j){let t,l,i,n,d,r,E,b,y=!1;const h=window.devicePixelRatio||1;let A=!1;const B=V("http://124.70.13.57/music/tdll.mp3");function R(){I(),C(),L()}function I(){t=document.getElementById("acanvas"),l=t.getContext("2d"),t.width=t.clientWidth*h,t.height=t.clientHeight*h,l.scale(h,h)}function C(){i=document.getElementById("acanvas2"),n=i.getContext("2d"),i.width=i.clientWidth*h,i.height=i.clientHeight*h,n.scale(h,h)}function L(){d=document.getElementById("audio"),d.src=B.value,d.controls=!0,d.autoplay=!1,d.crossOrigin="anonymous",d.addEventListener("play",()=>{y=!0,A||q(),M(),_()}),d.addEventListener("pause",()=>{y=!1}),d.addEventListener("ended",()=>{y=!1,S()})}function S(){l.clearRect(0,0,t.width,t.height),n.clearRect(0,0,i.width,i.height)}function q(){const o=new AudioContext,e=o.createMediaElementSource(d);r=o.createAnalyser(),E=r.frequencyBinCount,r.fftSize=E/2,e.connect(r),r.connect(o.destination),b=new Uint8Array(E),A=!0}function M(){if(!y)return;requestAnimationFrame(M),l.clearRect(0,0,t.width,t.height),r.getByteFrequencyData(b),l.clearRect(0,0,t.width,t.height);const o=r.frequencyBinCount,e=t.width/o,u=Math.floor(o/2);for(let f=0;f<u;f++){const c=b[f],g=c*(t.height/256),p=c+50>255?255:c+50,a=50,s=150;l.fillStyle=`rgb(${p},${a},${s})`;let m=f*e,v=t.height-g;l.fillRect(m,v,e,g);let w=t.width-(f+1)*e,x=t.height-g;l.fillRect(w,x,e,g)}}function _(){if(!y)return;requestAnimationFrame(_),r.getByteFrequencyData(b),n.clearRect(0,0,i.width,i.height);const o=r.frequencyBinCount,e=i.width/2,u=i.height/2,f=Math.min(e,u)*.8,c=f*.5,g=Math.PI*2/o;for(let a=0;a<o;a++){const s=b[a],m=s*(f-c)/256,v=s+50>255?255:s+50;n.fillStyle=`rgb(${v},50,150)`;const w=a*g,x=(a+1)*g,F=Math.PI*2-x,P=Math.PI*2-w;p(w,x,m),p(F,P,m)}function p(a,s,m){const v=c+m;n.beginPath(),n.moveTo(e+Math.cos(a)*c,u+Math.sin(a)*c),n.lineTo(e+Math.cos(a)*v,u+Math.sin(a)*v),n.arc(e,u,v,a,s),n.lineTo(e+Math.cos(s)*c,u+Math.sin(s)*c),n.arc(e,u,c,s,a,!0),n.closePath(),n.fill()}}return $(()=>{R()}),(o,e)=>(k(),T("section",z,e[0]||(e[0]=[W('<h3 data-v-81cfaeb1>音频可视化</h3><p data-v-81cfaeb1>点击音频播放体验可视化</p><div class="audin" data-v-81cfaeb1><audio id="audio" data-v-81cfaeb1></audio></div><div class="box-a" data-v-81cfaeb1><div class="width50" style="width:calc(100% - 600px);" data-v-81cfaeb1><canvas id="acanvas" data-v-81cfaeb1></canvas></div><div class="width50" style="width:600px;" data-v-81cfaeb1><canvas id="acanvas2" data-v-81cfaeb1></canvas></div></div><p data-v-81cfaeb1>实现代码：<a href="http://localhost:5173/#/knowledge/index?name=audio%E9%9F%B3%E9%A2%91%E5%8F%AF%E8%A7%86%E5%8C%96" data-v-81cfaeb1>点击前往</a></p>',5)])))}},O=H(D,[["__scopeId","data-v-81cfaeb1"]]);export{O as default};
