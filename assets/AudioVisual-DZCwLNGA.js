import{s as L,A as V,i as k,c as $,o as z,g as w,C as D,x as W,K as N}from"./vue-vendor-C-eO5OHd.js";import{_ as U}from"./index-k_b31qc0.js";import"http://115.190.117.177:10086/mds/pathList.js";const K={class:"content bg"},O={class:"input-box"},X={__name:"AudioVisual",setup(Y){let e,u,o,i,s,d,E,y,g=L(!1);const h=window.devicePixelRatio||1;let B=!1;const A=L("http://115.190.117.177:10086/qux/thz.mp3");function C(){q(),S(),F()}function q(){e=document.getElementById("acanvas"),u=e.getContext("2d"),e.width=e.clientWidth*h,e.height=e.clientHeight*h,u.scale(h,h)}function S(){o=document.getElementById("acanvas2"),i=o.getContext("2d"),o.width=o.clientWidth*h,o.height=o.clientHeight*h,i.scale(h,h)}function F(){s=document.getElementById("audio"),s.controls=!0,s.autoplay=!1,s.crossOrigin="anonymous",s.addEventListener("play",()=>{g.value=!0,B||_(),R(),I()}),s.addEventListener("pause",()=>{g.value=!1}),s.addEventListener("ended",()=>{g.value=!1,P()});const a=document.getElementById("bttn");a.onclick=()=>{g.value||(s.src=A.value,a.innerHTML="正在播放中",s.play())}}V(()=>g.value,a=>{a||(bttn.innerHTML="播放",s.pause())});function P(){u.clearRect(0,0,e.width,e.height),i.clearRect(0,0,o.width,o.height)}function _(){const a=new AudioContext,t=a.createMediaElementSource(s);d=a.createAnalyser(),E=d.frequencyBinCount,d.fftSize=E/2,t.connect(d),d.connect(a.destination),y=new Uint8Array(E),B=!0}function R(){if(!g)return;requestAnimationFrame(R),u.clearRect(0,0,e.width,e.height),d.getByteFrequencyData(y),u.clearRect(0,0,e.width,e.height);const a=d.frequencyBinCount,t=e.width/a,l=Math.floor(a/2);for(let f=0;f<l;f++){const c=y[f],v=c*(e.height/256),x=c+50>255?255:c+50,n=50,r=150;u.fillStyle=`rgb(${x},${n},${r})`;let p=f*t,m=e.height-v;u.fillRect(p,m,t,v);let b=e.width-(f+1)*t,M=e.height-v;u.fillRect(b,M,t,v)}}function I(){if(!g)return;requestAnimationFrame(I),d.getByteFrequencyData(y),i.clearRect(0,0,o.width,o.height);const a=d.frequencyBinCount,t=o.width/2,l=o.height/2,f=Math.min(t,l)*.8,c=f*.5,v=Math.PI*2/a;for(let n=0;n<a;n++){const r=y[n],p=r*(f-c)/256,m=r+50>255?255:r+50;i.fillStyle=`rgb(${m},50,150)`;const b=n*v,M=(n+1)*v,H=Math.PI*2-M,T=Math.PI*2-b;x(b,M,p),x(H,T,p)}function x(n,r,p){const m=c+p;i.beginPath(),i.moveTo(t+Math.cos(n)*c,l+Math.sin(n)*c),i.lineTo(t+Math.cos(n)*m,l+Math.sin(n)*m),i.arc(t,l,m,n,r),i.lineTo(t+Math.cos(r)*c,l+Math.sin(r)*c),i.arc(t,l,c,r,n,!0),i.closePath(),i.fill()}}return k(()=>{C()}),(a,t)=>(z(),$("section",K,[t[3]||(t[3]=w("h3",null,"音频可视化",-1)),w("div",O,[W(w("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=l=>A.value=l)},null,512),[[N,A.value]]),t[1]||(t[1]=w("button",{id:"bttn"},"播放",-1)),t[2]||(t[2]=w("audio",{id:"audio",style:{display:"none"}},null,-1))]),t[4]||(t[4]=D('<div class="box-a" data-v-297aa48a><div class="width50" style="width:calc(100% - 600px);" data-v-297aa48a><canvas id="acanvas" data-v-297aa48a></canvas></div><div class="width50" style="width:600px;" data-v-297aa48a><canvas id="acanvas2" data-v-297aa48a></canvas></div></div><p data-v-297aa48a>实现代码：<a href="http://localhost:5173/#/knowledge/index?name=audio%E9%9F%B3%E9%A2%91%E5%8F%AF%E8%A7%86%E5%8C%96" data-v-297aa48a>点击前往</a></p>',2))]))}},Q=U(X,[["__scopeId","data-v-297aa48a"]]);export{Q as default};
