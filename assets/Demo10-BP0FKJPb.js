import{C as $,V as R,E as H,u as T,L as ee}from"./Loading-BE0QEejk.js";import{c as U,a as X,b as oe,d as te,e as ne}from"./creatMesh-f-UvoTu7.js";import{_ as re,a as ie,c as se,b as ce,w as le,u as Y,d as l}from"./index-B2PJnxXl.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./allscreen-HmwLBpeI.js";import"./loading-DYhx7uO4.js";const f=new H(0,0,0,"YXZ"),m=new R,ae={type:"change"},de={type:"lock"},fe={type:"unlock"},q=Math.PI/2;class me extends ${constructor(o,n=null){super(o,n),this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this._onMouseMove=ue.bind(this),this._onPointerlockChange=he.bind(this),this._onPointerlockError=pe.bind(this),this.domElement!==null&&this.connect()}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}getObject(){return console.warn("THREE.PointerLockControls: getObject() has been deprecated. Use controls.object instead."),this.object}getDirection(o){return o.set(0,0,-1).applyQuaternion(this.object.quaternion)}moveForward(o){if(this.enabled===!1)return;const n=this.object;m.setFromMatrixColumn(n.matrix,0),m.crossVectors(n.up,m),n.position.addScaledVector(m,o)}moveRight(o){if(this.enabled===!1)return;const n=this.object;m.setFromMatrixColumn(n.matrix,0),n.position.addScaledVector(m,o)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}}function ue(i){if(this.enabled===!1||this.isLocked===!1)return;const o=i.movementX||i.mozMovementX||i.webkitMovementX||0,n=i.movementY||i.mozMovementY||i.webkitMovementY||0,a=this.object;f.setFromQuaternion(a.quaternion),f.y-=o*.002*this.pointerSpeed,f.x-=n*.002*this.pointerSpeed,f.x=Math.max(q-this.maxPolarAngle,Math.min(q-this.minPolarAngle,f.x)),a.quaternion.setFromEuler(f),this.dispatchEvent(ae)}function he(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(de),this.isLocked=!0):(this.dispatchEvent(fe),this.isLocked=!1)}function pe(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}const ke={__name:"Demo10",setup(i){let o=null,n=!1,a=!1,_=!1,C=!1,w=0,W=20,u=null,b=1,L=[],y=[],d=[];const O=({THREE:e,scene:r,camera:P,renderer:A})=>{let x=X({r:20,size:20,color:3368601});x.position.y=-.5,r.add(x);const M=new e.Group;[{size:[.5,.5,.5],position:[0,0,0],color:16711680},{size:[1,1,1],position:[6,0,0],color:65280},{size:[1,1,1],position:[-6,0,0],color:65535},{size:[1,1,1],position:[0,0,6],color:16776960},{size:[1,1,1],position:[0,0,-6],color:16711935}].forEach(c=>{const k=oe(c);M.add(k)}),r.add(M);let s=null,h=null,S=null,G=null,K=null,j=null,F=null,B=null;L=[{lineArr:[new e.Vector3(0,0,0),new e.Vector3(3,5,0),new e.Vector3(6,0,0)],startColor:16711680,endColor:65280},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(-3,5,0),new e.Vector3(-6,0,0)],startColor:16711680,endColor:65535},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,3),new e.Vector3(0,0,6)],startColor:16711680,endColor:16776977},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,-3),new e.Vector3(0,0,-6)],startColor:16711680,endColor:16711935}],L.forEach((c,k)=>{let g=k+1;const{line:v,bufferGeometry:E}=U(c);r.add(v);const J=te({lineArr:c.lineArr,color:c.endColor,dashSize:.5,gapSize:.2});r.add(J),g==1&&(K=E,s=v),g==2&&(j=E,h=v),g==3&&(F=E,S=v),g==4&&(B=E,G=v)}),y=[s,h,S,G],d=[K,j,F,B];const I=X({r:.5,size:20,color:16711680,side:e.DoubleSide});I.position.set(0,-.4,0),r.add(I),u=new e.Group,[{r:2,circle:12,color:"#ff0000",position:[0,-.4,0]},{r:2,circle:12,color:"#00ff00",position:[6,-.4,0]},{r:2,circle:12,color:"#00ffff",position:[-6,-.4,0]},{r:2,circle:12,color:"#ffff11",position:[0,-.4,6]},{r:2,circle:12,color:"#ff00ff",position:[0,-.4,-6]}].forEach(c=>{let k=ne(c);u.add(k)}),r.add(u),o=new me(P,A.domElement),r.add(o.object);const p=document.getElementById("box"),D=function(){o.lock()};p.addEventListener("click",D),document.addEventListener("pointerlockchange",function(){document.pointerLockElement===canvas?console.log("Pointer locked"):console.log("Pointer unlocked")},!1),document.addEventListener("pointerlockerror",function(){console.error("Pointer lock failed")}),o.addEventListener("lock",function(){p.style.display="none",p.removeEventListener("click",D)}),o.addEventListener("unlock",function(){p.style.display="block",p.addEventListener("click",D)}),document.addEventListener("keydown",V),document.addEventListener("keyup",z)},V=function(e){switch(e.code){case"ArrowUp":case"KeyW":n=!0;break;case"ArrowLeft":case"KeyA":_=!0;break;case"ArrowDown":case"KeyS":a=!0;break;case"ArrowRight":case"KeyD":C=!0;break}},z=function(e){switch(e.code){case"ArrowUp":case"KeyW":n=!1;break;case"ArrowLeft":case"KeyA":_=!1;break;case"ArrowDown":case"KeyS":a=!1;break;case"ArrowRight":case"KeyD":C=!1;break}},Q=({THREE:e,scene:r,camera:P,renderer:A,stats:x})=>{if(o.isLocked){const t=new e.Vector3;n&&(t.z+=1),a&&(t.z-=1),_&&(t.x-=1),C&&(t.x+=1),o.moveForward(.1*t.z),o.moveRight(.1*t.x)}w<=99?(w+=1,L.forEach((t,s)=>{const{bufferGeometry:h}=U({...t,index:w,num:W});y[s]&&(d[s]?.dispose(),y[s].geometry=h,d[s]=h)})):w=0,u?.children?.length>0&&u.children.forEach(t=>{t.material.opacity<=0?(t.material.opacity=1,b=1):(t.material.opacity+=-.01,b+=.003),t.scale.x=b,t.scale.y=b}),A.render(r,P),x.update()},{loading:N,pregress:Z}=T({el:"#canvas",background:"#333333",cameraPosition:[0,4,10],control:!1,helper:!1,light:!0,creatMesh:O,animation:Q});return ie(()=>{o=null,L=[],y=[],d.length>0&&d.forEach(e=>{e.dispose()}),d=null,document.removeEventListener("keydown",V),document.removeEventListener("keyup",z)}),(e,r)=>(ce(),se(ee,{loading:Y(N),pregress:Y(Z)},{default:le(()=>[...r[0]||(r[0]=[l("canvas",{id:"canvas"},null,-1),l("div",{id:"box"},[l("div",{class:"box"},[l("p",null,[l("b",null,"开始体验")]),l("p",null,"请按键盘： W/A/S/D，配合鼠标控制方向哦！"),l("p",null,"ESC 退出")])],-1)])]),_:1},8,["loading","pregress"]))}},_e=re(ke,[["__scopeId","data-v-98387e46"]]);export{_e as default};
