import{E as Z,V as J,C as $,u as R,L as H}from"./Loading-BH_PUUBy.js";import{c as I,a as T,b as ee,d as oe,e as te}from"./creatMesh-zMN8nIiX.js";import{_ as ne,a as re,b as ie,c as se,w as ce,d as u,u as U}from"./index-gteOFnhJ.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./allscreen-CgF5VMul.js";import"./loading-DFediwCp.js";const h=new Z(0,0,0,"YXZ"),k=new J,le={type:"change"},ae={type:"lock"},de={type:"unlock"},X=Math.PI/2;class fe extends ${constructor(o,t=null){super(o,t),this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this._onMouseMove=me.bind(this),this._onPointerlockChange=ue.bind(this),this._onPointerlockError=pe.bind(this),this.domElement!==null&&this.connect()}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}getObject(){return console.warn("THREE.PointerLockControls: getObject() has been deprecated. Use controls.object instead."),this.object}getDirection(o){return o.set(0,0,-1).applyQuaternion(this.object.quaternion)}moveForward(o){if(this.enabled===!1)return;const t=this.object;k.setFromMatrixColumn(t.matrix,0),k.crossVectors(t.up,k),t.position.addScaledVector(k,o)}moveRight(o){if(this.enabled===!1)return;const t=this.object;k.setFromMatrixColumn(t.matrix,0),t.position.addScaledVector(k,o)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}}function me(s){if(this.enabled===!1||this.isLocked===!1)return;const o=s.movementX||s.mozMovementX||s.webkitMovementX||0,t=s.movementY||s.mozMovementY||s.webkitMovementY||0,p=this.object;h.setFromQuaternion(p.quaternion),h.y-=o*.002*this.pointerSpeed,h.x-=t*.002*this.pointerSpeed,h.x=Math.max(X-this.maxPolarAngle,Math.min(X-this.minPolarAngle,h.x)),p.quaternion.setFromEuler(h),this.dispatchEvent(le)}function ue(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(ae),this.isLocked=!0):(this.dispatchEvent(de),this.isLocked=!1)}function pe(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}const he={__name:"Demo10",setup(s){let o=null,t=!1,p=!1,P=!1,_=!1,i=0,b=20,c,A,l,M,a,D,d,V,f=null,x=1;const Y=({THREE:e,scene:r,camera:S,renderer:z})=>{let L=I({r:20,size:20,color:3368601});L.position.y=-.5,r.add(L);const F=new e.Group;[{size:[.5,.5,.5],position:[0,0,0],color:16711680},{size:[1,1,1],position:[6,0,0],color:65280},{size:[1,1,1],position:[-6,0,0],color:65535},{size:[1,1,1],position:[0,0,6],color:16776960},{size:[1,1,1],position:[0,0,-6],color:16711935}].forEach(m=>{const w=T(m);F.add(w)}),r.add(F),[{lineArr:[new e.Vector3(0,0,0),new e.Vector3(3,5,0),new e.Vector3(6,0,0)],startColor:16711680,endColor:65280},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(-3,5,0),new e.Vector3(-6,0,0)],startColor:16711680,endColor:65535},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,3),new e.Vector3(0,0,6)],startColor:16711680,endColor:16776977},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,-3),new e.Vector3(0,0,-6)],startColor:16711680,endColor:16711935}].forEach((m,w)=>{let g=w+1;const{line:Q,points:y,bufferGeometry:C}=ee(m);r.add(Q);const N=oe({lineArr:m.lineArr,color:m.endColor,dashSize:.5,gapSize:.2});r.add(N),g==1&&(c=C,A=y),g==2&&(l=C,M=y),g==3&&(a=C,D=y),g==4&&(d=C,V=y)});const j=I({r:.5,size:20,color:16711680,side:e.DoubleSide});j.position.set(0,-.4,0),r.add(j),f=new e.Group,[{r:2,circle:12,color:"#ff0000",position:[0,-.4,0]},{r:2,circle:12,color:"#00ff00",position:[6,-.4,0]},{r:2,circle:12,color:"#00ffff",position:[-6,-.4,0]},{r:2,circle:12,color:"#ffff11",position:[0,-.4,6]},{r:2,circle:12,color:"#ff00ff",position:[0,-.4,-6]}].forEach(m=>{let w=te(m);f.add(w)}),r.add(f),o=new fe(S,z.domElement),r.add(o.object);const v=document.getElementById("box"),B=function(){o.lock()};v.addEventListener("click",B),document.addEventListener("pointerlockchange",function(){document.pointerLockElement===canvas?console.log("Pointer locked"):console.log("Pointer unlocked")},!1),document.addEventListener("pointerlockerror",function(){console.error("Pointer lock failed")}),o.addEventListener("lock",function(){v.style.display="none",v.removeEventListener("click",B)}),o.addEventListener("unlock",function(){v.style.display="block",v.addEventListener("click",B)}),document.addEventListener("keydown",E),document.addEventListener("keyup",K)},E=function(e){switch(e.code){case"ArrowUp":case"KeyW":t=!0;break;case"ArrowLeft":case"KeyA":P=!0;break;case"ArrowDown":case"KeyS":p=!0;break;case"ArrowRight":case"KeyD":_=!0;break}},K=function(e){switch(e.code){case"ArrowUp":case"KeyW":t=!1;break;case"ArrowLeft":case"KeyA":P=!1;break;case"ArrowDown":case"KeyS":p=!1;break;case"ArrowRight":case"KeyD":_=!1;break}},q=({THREE:e,scene:r,camera:S,renderer:z,stats:L})=>{var G;if(o.isLocked){const n=new e.Vector3;t&&(n.z+=1),p&&(n.z-=1),P&&(n.x-=1),_&&(n.x+=1),o.moveForward(.1*n.z),o.moveRight(.1*n.x)}i<=99?(i+=1,c&&c.dispose(),l&&l.dispose(),a&&a.dispose(),d&&d.dispose(),c=new e.BufferGeometry,l=new e.BufferGeometry,a=new e.BufferGeometry,d=new e.BufferGeometry,c.setFromPoints(new e.CatmullRomCurve3(A.slice(i,i+b)).getSpacedPoints(100)),l.setFromPoints(new e.CatmullRomCurve3(M.slice(i,i+b)).getSpacedPoints(100)),a.setFromPoints(new e.CatmullRomCurve3(D.slice(i,i+b)).getSpacedPoints(100)),d.setFromPoints(new e.CatmullRomCurve3(V.slice(i,i+b)).getSpacedPoints(100))):i=0,((G=f==null?void 0:f.children)==null?void 0:G.length)>0&&f.children.forEach(n=>{n.material.opacity<=0?(n.material.opacity=1,x=1):(n.material.opacity+=-.01,x+=.003),n.scale.x=x,n.scale.y=x}),z.render(r,S),L.update()},{loading:W,pregress:O}=R({el:"#canvas",background:"#333333",cameraPosition:[0,4,10],control:!1,helper:!1,light:!0,creatMesh:Y,animation:q});return re(()=>{o=null,c.dispose(),l.dispose(),a.dispose(),d.dispose(),c=A=l=M=a=D=d=V=null,document.removeEventListener("keydown",E),document.removeEventListener("keyup",K)}),(e,r)=>(ie(),se(H,{loading:U(W),pregress:U(O)},{default:ce(()=>r[0]||(r[0]=[u("canvas",{id:"canvas"},null,-1),u("div",{id:"box"},[u("div",{class:"box"},[u("p",null,[u("b",null,"开始体验")]),u("p",null,"请按键盘： W/A/S/D，配合鼠标控制方向哦！"),u("p",null,"ESC 退出")])],-1)])),_:1},8,["loading","pregress"]))}},Ce=ne(he,[["__scopeId","data-v-2e8d3af7"]]);export{Ce as default};
