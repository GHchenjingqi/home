import{E as Z,V as J,a as $,u as R,L as T}from"./Loading-79aDrk5N.js";import{c as G,a as H,b as ee,d as oe,e as te}from"./creatMesh-osWYknU5.js";import{_ as ne,d as re,o as ie,c as se,w as ce,u as B,p as ae,a as le,b as l}from"./index-VRAcYr2a.js";import"./allscreen-BbwXwfjp.js";import"./loading-BwWTHRMq.js";const m=new Z(0,0,0,"YXZ"),f=new J,de={type:"change"},me={type:"lock"},fe={type:"unlock"},U=Math.PI/2;class ue extends ${constructor(o,n){super(),this.camera=o,this.domElement=n,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this._onMouseMove=pe.bind(this),this._onPointerlockChange=he.bind(this),this._onPointerlockError=ve.bind(this),this.connect()}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}getObject(){return this.camera}getDirection(o){return o.set(0,0,-1).applyQuaternion(this.camera.quaternion)}moveForward(o){const n=this.camera;f.setFromMatrixColumn(n.matrix,0),f.crossVectors(n.up,f),n.position.addScaledVector(f,o)}moveRight(o){const n=this.camera;f.setFromMatrixColumn(n.matrix,0),n.position.addScaledVector(f,o)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}}function pe(r){if(this.isLocked===!1)return;const o=r.movementX||r.mozMovementX||r.webkitMovementX||0,n=r.movementY||r.mozMovementY||r.webkitMovementY||0,d=this.camera;m.setFromQuaternion(d.quaternion),m.y-=o*.002*this.pointerSpeed,m.x-=n*.002*this.pointerSpeed,m.x=Math.max(U-this.maxPolarAngle,Math.min(U-this.minPolarAngle,m.x)),d.quaternion.setFromEuler(m),this.dispatchEvent(de)}function he(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(me),this.isLocked=!0):(this.dispatchEvent(fe),this.isLocked=!1)}function ve(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}const X=r=>(ae("data-v-9e05b6fd"),r=r(),le(),r),we=X(()=>l("canvas",{id:"canvas"},null,-1)),ke=X(()=>l("div",{id:"box"},[l("div",{class:"box"},[l("p",null,[l("b",null,"开始体验")]),l("p",null,"请按键盘： W/A/S/D"),l("p",null,"ESC 退出")])],-1)),xe={__name:"Demo10",setup(r){let o=null,n=!1,d=!1,b=!1,y=!1,i=0,p=20,L,_,C,P,A,S,D,M,c=null,h=1;const Y=({THREE:e,scene:s,camera:V,renderer:z})=>{let v=G({r:20,size:20,color:3368601});v.position.y=-.5,s.add(v);const w=new e.Group;[{size:[.5,.5,.5],position:[0,0,0],color:16711680},{size:[1,1,1],position:[6,0,0],color:65280},{size:[1,1,1],position:[-6,0,0],color:65535},{size:[1,1,1],position:[0,0,6],color:16776960},{size:[1,1,1],position:[0,0,-6],color:16711935}].forEach(a=>{const u=H(a);w.add(u)}),s.add(w),[{lineArr:[new e.Vector3(0,0,0),new e.Vector3(3,5,0),new e.Vector3(6,0,0)],startColor:16711680,endColor:65280},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(-3,5,0),new e.Vector3(-6,0,0)],startColor:16711680,endColor:65535},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,3),new e.Vector3(0,0,6)],startColor:16711680,endColor:16776977},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,-3),new e.Vector3(0,0,-6)],startColor:16711680,endColor:16711935}].forEach((a,u)=>{let k=u+1;const{line:Q,points:x,bufferGeometry:g}=ee(a);s.add(Q);const N=oe({lineArr:a.lineArr,color:a.endColor,dashSize:.5,gapSize:.2});s.add(N),k==1&&(L=g,_=x),k==2&&(C=g,P=x),k==3&&(A=g,S=x),k==4&&(D=g,M=x)});const t=G({r:.5,size:20,color:16711680,side:e.DoubleSide});t.position.set(0,-.4,0),s.add(t),c=new e.Group,[{r:2,circle:12,color:"#ff0000",position:[0,-.4,0]},{r:2,circle:12,color:"#00ff00",position:[6,-.4,0]},{r:2,circle:12,color:"#00ffff",position:[-6,-.4,0]},{r:2,circle:12,color:"#ffff11",position:[0,-.4,6]},{r:2,circle:12,color:"#ff00ff",position:[0,-.4,-6]}].forEach(a=>{let u=te(a);c.add(u)}),s.add(c),o=new ue(V,z.domElement),s.add(o.getObject());const F=document.getElementById("box");F.addEventListener("click",function(){o.lock()}),o.addEventListener("lock",function(){F.style.display="none"}),o.addEventListener("unlock",function(){F.style.display="block"}),document.addEventListener("keydown",K),document.addEventListener("keyup",I)},K=function(e){switch(e.code){case"ArrowUp":case"KeyW":n=!0;break;case"ArrowLeft":case"KeyA":b=!0;break;case"ArrowDown":case"KeyS":d=!0;break;case"ArrowRight":case"KeyD":y=!0;break}},I=function(e){switch(e.code){case"ArrowUp":case"KeyW":n=!1;break;case"ArrowLeft":case"KeyA":b=!1;break;case"ArrowDown":case"KeyS":d=!1;break;case"ArrowRight":case"KeyD":y=!1;break}},q=({THREE:e,scene:s,camera:V,renderer:z,controls:v,stats:w})=>{var E;if(o.isLocked){const t=new e.Vector3;n&&(t.z+=1),d&&(t.z-=1),b&&(t.x-=1),y&&(t.x+=1),o.moveForward(.1*t.z),o.moveRight(.1*t.x)}i<=99?(i+=1,L.setFromPoints(new e.CatmullRomCurve3(_.slice(i,i+p)).getSpacedPoints(100)),C.setFromPoints(new e.CatmullRomCurve3(P.slice(i,i+p)).getSpacedPoints(100)),A.setFromPoints(new e.CatmullRomCurve3(S.slice(i,i+p)).getSpacedPoints(100)),D.setFromPoints(new e.CatmullRomCurve3(M.slice(i,i+p)).getSpacedPoints(100))):i=0,((E=c==null?void 0:c.children)==null?void 0:E.length)>0&&c.children.forEach(t=>{t.material.opacity<=0?(t.material.opacity=1,h=1):(t.material.opacity+=-.01,h+=.003),t.scale.x=h,t.scale.y=h}),v.update(),z.render(s,V),w.update()},{loading:W,pregress:j}=R({el:"#canvas",background:"#333333",cameraPosition:[0,4,10],controlAuto:!0,helper:!1,light:!0,creatMesh:Y,animation:q});return re(()=>{o=null,L=_=C=P=A=S=D=M=null,document.removeEventListener("keydown",K),document.removeEventListener("keyup",I)}),(e,s)=>(ie(),se(T,{loading:B(W),pregress:B(j)},{default:ce(()=>[we,ke]),_:1},8,["loading","pregress"]))}},Pe=ne(xe,[["__scopeId","data-v-9e05b6fd"]]);export{Pe as default};
