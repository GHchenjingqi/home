import{E as N,V as Z,a as J,u as $,L as R}from"./Loading-1R6JuRE4.js";import{c as B,a as T,b as H,d as ee,e as oe}from"./creatMesh-Ce9v24f3.js";import{_ as te,b as ne,o as re,c as ie,w as se,u as I,a as l}from"./index-B4DqtJxY.js";import"./allscreen-BNbqxyxk.js";import"./loading-ApxcDnq5.js";const m=new N(0,0,0,"YXZ"),f=new Z,ce={type:"change"},ae={type:"lock"},le={type:"unlock"},U=Math.PI/2;class de extends J{constructor(o,n){super(),this.camera=o,this.domElement=n,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this._onMouseMove=me.bind(this),this._onPointerlockChange=fe.bind(this),this._onPointerlockError=ue.bind(this),this.connect()}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}getObject(){return this.camera}getDirection(o){return o.set(0,0,-1).applyQuaternion(this.camera.quaternion)}moveForward(o){const n=this.camera;f.setFromMatrixColumn(n.matrix,0),f.crossVectors(n.up,f),n.position.addScaledVector(f,o)}moveRight(o){const n=this.camera;f.setFromMatrixColumn(n.matrix,0),n.position.addScaledVector(f,o)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}}function me(s){if(this.isLocked===!1)return;const o=s.movementX||s.mozMovementX||s.webkitMovementX||0,n=s.movementY||s.mozMovementY||s.webkitMovementY||0,d=this.camera;m.setFromQuaternion(d.quaternion),m.y-=o*.002*this.pointerSpeed,m.x-=n*.002*this.pointerSpeed,m.x=Math.max(U-this.maxPolarAngle,Math.min(U-this.minPolarAngle,m.x)),d.quaternion.setFromEuler(m),this.dispatchEvent(ce)}function fe(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(ae),this.isLocked=!0):(this.dispatchEvent(le),this.isLocked=!1)}function ue(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}const pe={__name:"Demo10",setup(s){let o=null,n=!1,d=!1,b=!1,y=!1,i=0,p=20,L,C,P,_,A,D,M,V,c=null,h=1;const X=({THREE:e,scene:r,camera:S,renderer:z})=>{let k=B({r:20,size:20,color:3368601});k.position.y=-.5,r.add(k);const v=new e.Group;[{size:[.5,.5,.5],position:[0,0,0],color:16711680},{size:[1,1,1],position:[6,0,0],color:65280},{size:[1,1,1],position:[-6,0,0],color:65535},{size:[1,1,1],position:[0,0,6],color:16776960},{size:[1,1,1],position:[0,0,-6],color:16711935}].forEach(a=>{const u=T(a);v.add(u)}),r.add(v),[{lineArr:[new e.Vector3(0,0,0),new e.Vector3(3,5,0),new e.Vector3(6,0,0)],startColor:16711680,endColor:65280},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(-3,5,0),new e.Vector3(-6,0,0)],startColor:16711680,endColor:65535},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,3),new e.Vector3(0,0,6)],startColor:16711680,endColor:16776977},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,-3),new e.Vector3(0,0,-6)],startColor:16711680,endColor:16711935}].forEach((a,u)=>{let w=u+1;const{line:O,points:x,bufferGeometry:g}=H(a);r.add(O);const Q=ee({lineArr:a.lineArr,color:a.endColor,dashSize:.5,gapSize:.2});r.add(Q),w==1&&(L=g,C=x),w==2&&(P=g,_=x),w==3&&(A=g,D=x),w==4&&(M=g,V=x)});const t=B({r:.5,size:20,color:16711680,side:e.DoubleSide});t.position.set(0,-.4,0),r.add(t),c=new e.Group,[{r:2,circle:12,color:"#ff0000",position:[0,-.4,0]},{r:2,circle:12,color:"#00ff00",position:[6,-.4,0]},{r:2,circle:12,color:"#00ffff",position:[-6,-.4,0]},{r:2,circle:12,color:"#ffff11",position:[0,-.4,6]},{r:2,circle:12,color:"#ff00ff",position:[0,-.4,-6]}].forEach(a=>{let u=oe(a);c.add(u)}),r.add(c),o=new de(S,z.domElement),r.add(o.getObject());const F=document.getElementById("box");F.addEventListener("click",function(){o.lock()}),o.addEventListener("lock",function(){F.style.display="none"}),o.addEventListener("unlock",function(){F.style.display="block"}),document.addEventListener("keydown",K),document.addEventListener("keyup",G)},K=function(e){switch(e.code){case"ArrowUp":case"KeyW":n=!0;break;case"ArrowLeft":case"KeyA":b=!0;break;case"ArrowDown":case"KeyS":d=!0;break;case"ArrowRight":case"KeyD":y=!0;break}},G=function(e){switch(e.code){case"ArrowUp":case"KeyW":n=!1;break;case"ArrowLeft":case"KeyA":b=!1;break;case"ArrowDown":case"KeyS":d=!1;break;case"ArrowRight":case"KeyD":y=!1;break}},Y=({THREE:e,scene:r,camera:S,renderer:z,controls:k,stats:v})=>{var E;if(o.isLocked){const t=new e.Vector3;n&&(t.z+=1),d&&(t.z-=1),b&&(t.x-=1),y&&(t.x+=1),o.moveForward(.1*t.z),o.moveRight(.1*t.x)}i<=99?(i+=1,L.setFromPoints(new e.CatmullRomCurve3(C.slice(i,i+p)).getSpacedPoints(100)),P.setFromPoints(new e.CatmullRomCurve3(_.slice(i,i+p)).getSpacedPoints(100)),A.setFromPoints(new e.CatmullRomCurve3(D.slice(i,i+p)).getSpacedPoints(100)),M.setFromPoints(new e.CatmullRomCurve3(V.slice(i,i+p)).getSpacedPoints(100))):i=0,((E=c==null?void 0:c.children)==null?void 0:E.length)>0&&c.children.forEach(t=>{t.material.opacity<=0?(t.material.opacity=1,h=1):(t.material.opacity+=-.01,h+=.003),t.scale.x=h,t.scale.y=h}),k.update(),z.render(r,S),v.update()},{loading:q,pregress:W}=$({el:"#canvas",background:"#333333",cameraPosition:[0,4,10],controlAuto:!0,helper:!1,light:!0,creatMesh:X,animation:Y});return ne(()=>{o=null,L=C=P=_=A=D=M=V=null,document.removeEventListener("keydown",K),document.removeEventListener("keyup",G)}),(e,r)=>(re(),ie(R,{loading:I(q),pregress:I(W)},{default:se(()=>r[0]||(r[0]=[l("canvas",{id:"canvas"},null,-1),l("div",{id:"box"},[l("div",{class:"box"},[l("p",null,[l("b",null,"开始体验")]),l("p",null,"请按键盘： W/A/S/D"),l("p",null,"ESC 退出")])],-1)])),_:1},8,["loading","pregress"]))}},be=te(pe,[["__scopeId","data-v-9e05b6fd"]]);export{be as default};
