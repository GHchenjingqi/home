import{u as W,L as N}from"./Loading-79aDrk5N.js";import{_ as J,d as O,o as j,c as q,w as Q,u as X,p as Y,a as Z,b as p}from"./index-VRAcYr2a.js";import"./allscreen-BbwXwfjp.js";import"./loading-BwWTHRMq.js";const V=u=>(Y("data-v-22b61b71"),u=u(),Z(),u),$=V(()=>p("canvas",{id:"canvas"},null,-1)),R=V(()=>p("div",{id:"box"},[p("div",{class:"box"},[p("p",null,"空格开始"),p("p",null,"w 控制小球前进")])],-1)),T={__name:"Demo18",setup(u){let w=null,v=null,a=null,s=null,f=null,r,y=!1,b=!1,x=!1;const k=async({THREE:e,scene:t,controls:c,transControls:L,camera:_,renderer:m})=>{m.shadowMap.enabled=!0,m.shadowMap.type=e.PCFSoftShadowMap,w=new e.Group;let o=new e.Group,i=new e.Group;const n=new e.SphereGeometry(.2,36,18);s=new e.Mesh(n,new e.MeshBasicMaterial({color:16736767})),s.position.set(-15,0,0),o.add(s),o.position.y=.2,o.position.z=.4,t.add(o),f=new e.Mesh(n,new e.MeshBasicMaterial({color:25087})),f.position.set(-15,0,0),i.add(f),i.position.y=.2,i.position.z=-.4,t.add(i),r=s.position,a=new e.CatmullRomCurve3([new e.Vector3(-55,0,0),new e.Vector3(-15,0,0),new e.Vector3(-5,1,0),new e.Vector3(0,0,0),new e.Vector3(.5,.5,0),new e.Vector3(1,.5,0),new e.Vector3(2,1,0),new e.Vector3(3,1.5,0),new e.Vector3(5,0,0),new e.Vector3(6,1,0),new e.Vector3(10,2,0),new e.Vector3(15,2,5),new e.Vector3(8,2,5),new e.Vector3(4,1,6),new e.Vector3(0,0,5)]);const U=new e.PlaneGeometry(500,500),g=new e.TextureLoader().load("/public/images/grass.png");g.wrapS=e.RepeatWrapping,g.wrapT=e.RepeatWrapping,g.repeat.set(1e3,1e3);const B=new e.MeshBasicMaterial({color:65280,map:g}),d=new e.Mesh(U,B);d.quaternion.setFromAxisAngle(new e.Vector3(1,0,0),-Math.PI/2),d.castShadow=!0,d.receiveShadow=!0,d.position.y=-.5,t.add(d);const C=new e.TubeGeometry(a,120,.8,2,!1),D=new e.MeshBasicMaterial({color:5658198}),S=new e.Mesh(C,D);w.add(S),S.castShadow=!0,t.add(w);const I=new e.TubeGeometry(a,120,.2,2,!1),F=new e.ShaderMaterial({uniforms:{diffuse:{value:new e.Color(16777062)},dashLength:{value:.6},gapLength:{value:2.15}},vertexShader:`
           varying vec2 vUv;
           void main() {
               vUv = uv;
               gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
           }
       `,fragmentShader:`
           varying vec2 vUv;
           uniform vec3 diffuse;
           uniform float dashLength;
           uniform float gapLength;
           void main() {
               float distance = mod(vUv.x * dashLength + vUv.y * gapLength, dashLength + gapLength);
               if (distance < dashLength) {
                   gl_FragColor = vec4(diffuse, 1.0);
               } else {
                   discard;
               }
           }
       `}),M=new e.Mesh(I,F);M.position.y=.01,M.position.z=-.12,t.add(M),document.addEventListener("keydown",A),document.addEventListener("keyup",z)},A=function(e){switch(e.code){case"ArrowUp":case"KeyW":y=!0,l+=.01;break;case"ArrowLeft":case"KeyA":b=!0;break;case"ArrowDown":case"KeyS":break;case"ArrowRight":case"KeyD":x=!0;break;case"Space":G();break}},G=()=>{let e=document.getElementById("box");e.style.display="none"},z=function(e){switch(e.code){case"ArrowUp":case"KeyW":y=!1;break;case"ArrowLeft":case"KeyA":b=!1;break;case"ArrowDown":case"KeyS":break;case"ArrowRight":case"KeyD":x=!1;break}};let h=0,l=0;const K=({THREE:e,scene:t,camera:c,renderer:L,stats:_})=>{if(_.update(),L.render(t,c),h<1){const m=a.getPointAt(h);if(f.position.copy(m),l<1){r=a.getPointAt(l),a.getPoints(a.points.length);const i=.1,n=new e.Vector3;y&&(n.x+=1),b&&(n.z-=1),x&&(n.z+=1),r.x=r.x+n.x*i,r.z=r.z+n.z*i,s.position.copy(r)}else l=0;let o=JSON.parse(JSON.stringify(s.position));o.x>5?c.position.set(o.x+6,o.y+2,o.z-2):l==0?c.lookAt(0,0,0):(c.position.set(o.x-3,o.y+1,o.z),c.lookAt(s.position)),h+=.001}else h=0},{loading:P}=W({el:"#canvas",background:"#d3e3f3",cameraPosition:[-10,2,0],control:!0,controlAutoSpeed:!1,helper:!1,light:!0,creatMesh:k,animation:K});return O(()=>{v=w=null,v&&document.body.removeEventListener("click",v)}),(e,t)=>(j(),q(N,{loading:X(P)},{default:Q(()=>[$,R]),_:1},8,["loading"]))}},ne=J(T,[["__scopeId","data-v-22b61b71"]]);export{ne as default};
