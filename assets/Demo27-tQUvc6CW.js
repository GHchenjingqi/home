import{u as it,L as st}from"./Loading-WzBiX3uU.js";import{m as rt,k as v,i as lt}from"./creatMesh-DHCg5GWV.js";import{u as ct}from"./useRay-BXLpuDR_.js";import{u as dt,K as L}from"./keyCodes-C3o8slVe.js";import{C as S}from"./camera-controls.module-CggtOxtI.js";import{Z}from"./zoomtastic.umd-DXSdxC-m.js";import{W as ut}from"./Water-D2ervaCJ.js";import{_ as mt,g as pt,o as ht,c as gt,w as yt,a as d,u as N}from"./index-CBcyRm_t.js";import"./allscreen-CUO7nlcE.js";import"./loading-C-YUrJ_O.js";import"./_commonjsHelpers-Cpj98o6Y.js";const Y=[{url:"/public/images/2.jpg",rotation:{x:0,y:Math.PI,z:0},scale:{x:1.6,y:1.6,z:1},position:{x:-2.480360132066057,y:1.02914583548867,z:-3.8840465703459124}},{url:"/public/images/1.jpg",rotation:{x:0,y:Math.PI/2,z:0},scale:{x:.6,y:.6,z:1},position:{x:1.616760671057668,y:1.0103806696280644,z:-2.9235002018346625}},{url:"/public/images/3.jpg",rotation:{x:0,y:-Math.PI/2,z:0},scale:{x:.6,y:.6,z:1},position:{x:-5.263541604983203,y:.9416043550166153,z:-.8699767840378825}},{url:"/public/images/4.jpg",rotation:{x:0,y:Math.PI/2,z:0},scale:{x:.6,y:.6,z:1},position:{x:1.516760671057668,y:1.0103806696280644,z:-.5235002018346626}},{url:"/public/images/5.jpg",rotation:{x:0,y:-Math.PI*2,z:0},scale:{x:1,y:1,z:1},position:{x:-3.997948866131494,y:.8198050714546645,z:2.5871518341211726}},{url:"/public/images/6.jpg",position:{x:1.363645229509038,y:.9849856905460515,z:2},scale:{x:.6,y:.6,z:1},rotation:{x:0,y:1.5707963267948966,z:0}}],O=!1,ft={__name:"Demo27",setup(xt){let o=null,b=-1,V=null,s=null,A=null,m=null,P=null;const X=async({THREE:e,scene:n,transControls:D,renderer:k,camera:p,gridHelper:C,axesHelper:I})=>{S.install({THREE:e}),Z.mount();const{keyEvent:y,clearKeys:J,getKeyTime:wt}=await dt();A=J;const f=new e.Group;let h=Y[0].position;const x=rt({size:[10,64],position:[0,0,0],shadow:!0,type:"standard",color:13606249});x.rotation.x=-Math.PI/2,x.position.y=b-.05,x.name="plane",f.add(x);const _=v(n.children,"home");_.rotation.y=-Math.PI/8,_.scale.set(15,15,15),_.position.set(0,2.8,-4);const K=v(n.children,"tree");K.scale.set(15,15,15),K.position.set(5.55,2.707,-2.471),P=v(n.children,"michelle"),P.scale.set(1.2,1.2,1.2),P.position.set(3.8736,-1,4.935);const w=new e.Group,B=v(n.children,"light");B.scale.set(3,3,3),w.add(B);const z=new e.PointLight(16777215,80,0);z.position.set(0,b,.7),z.lookAt(0,-3,.7),z.castShadow=!0;const Q=new e.SphereGeometry(20,32,32),$=new e.MeshStandardMaterial({color:15114812,emissive:15114812,emissiveIntensity:1e3,roughness:.5,metalness:0}),G=new e.Mesh(Q,$);G.position.set(0,250,1e3),n.background=new e.Color(265780),n.add(G);const T=new e.AmbientLight(16777215,.4);n.add(T);let W=[{nubmer:1850,color:16777215,size:1.5,scalar:1,multiple:1e3}];for(let t=0;t<W.length;t++){const a=lt(W[t]);a.rotation.x=Math.random()*6,a.rotation.y=Math.random()*6,a.rotation.z=Math.random()*6,a.matrixAutoUpdate=!1,a.updateMatrix(),a.position.set(0,0,0),n.add(a)}const H=new e.PlaneGeometry(1e3,1e3);m=new ut(H,{textureWidth:512,textureHeight:512,waterNormals:new e.TextureLoader().load("/home//public/images/waternormals.jpg",function(t){t.wrapS=t.wrapT=e.RepeatWrapping}),sunDirection:new e.Vector3,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:n.fog!==void 0}),m.rotation.x=-Math.PI/2,m.position.y=b-.25,n.add(m),o=new S(p,k.domElement),o.enableTransition=!0,o.transitionTime=1,o.minZoom=.5,o.maxZoom=1,o.mouseButtons.wheel=S.ACTION.ZOOM,o.saveState(),o.update(),w.position.set(-2.0809,4.78445,-1.37862),w.add(z),n.add(w);const R=y(L.W,16.666),E=y(L.A,16.666),tt=y(L.S,16.666),et=y(L.D,16.666);E.addEventListener("holding",function(t){o.truck(-.001,0,!1)}),et.addEventListener("holding",function(t){o.truck(.001,0,!1)}),R.addEventListener("holding",function(t){o.forward(.001,!1)}),tt.addEventListener("holding",function(t){o.forward(-.001,!1)});const ot=new e.TextureLoader,at=1,M=1.5;Y.forEach(t=>{ot.load("/home/"+t.url,a=>{const{width:g,height:l}=a.image;a.image.width>M?(t.width=M,t.height=M/g*l):(t.height=at,t.width=M/l*g);const i=new e.BoxGeometry(t.width,t.height,.05),u=new e.MeshLambertMaterial({map:a,color:16777215}),c=new e.MeshBasicMaterial({color:"#ffffff"}),r=new e.Mesh(i,[c,c,c,c,c,u]);r.name="pic",r.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),r.scale.set(t.scale.x,t.scale.y,t.scale.z),r.position.set(t.position.x,t.position.y,t.position.z),r.orginData=t,h=r.position,f.add(r)})}),n.add(f),o.setLookAt(1,1,1,h.x,h.y,h.z,!0);const nt=(t,a,g)=>{if(!o)return;o.saveState();const l=.01,i=new e.Vector3(t.x,t.y,t.z);i.lerp(new e.Vector3(a.x,a.y,a.z),l);const u=new e.Vector3,c=new e.Vector3;o.getPosition(u),o.getTarget(c),new e.Vector3(t.x,t.y,t.z).lerp(new e.Vector3(a.x,a.y,a.z),l),o.setLookAt(t.x,t.y,t.z,i.x,i.y,i.z,!0)};let j=[];document.body.addEventListener("mousedown",t=>{j=[t.clientX,t.clientY]}),document.body.addEventListener("mouseup",async t=>{const[a,g]=j;if(Math.abs(a-t.clientX)>2||Math.abs(g-t.clientY)>2)return;let l=await ct({el:"#canvas",camera:p,group:f,event:t});if(l!=null&&l.object){if(s&&(s=null),s=l.object,s.name=="plane"){const i=l.point;if(i.x<1.64&&i.x>-5.04&&i.z>-3.96&&i.z<1.977){const u={x:i.x,y:.5,z:i.z};nt(u,h)}}if(s.name=="pic"){let{x:i,y:u,z:c}=s.position;h={x:i,y:u,z:c};let r=o.getPosition();o.setLookAt(r.x,r.y,r.z,i,u,c,!0)}s!=null&&s.orginData&&Z.show("/home/"+(s==null?void 0:s.orginData.url))}})},U=({renderer:e,scene:n,clock:D,camera:k,stats:p,mixer:C})=>{const I=D.getDelta();o==null||o.update(I),p==null||p.update(),m&&(m.material.uniforms.time.value+=1/60),C&&C.update(I),e.render(n,k)},{loading:q,pregress:F}=it({el:"#canvas",background:"#111111",cameraPosition:[0,1.5,1],modelPath:["home.glb","light2.glb","tree.glb","michelle.glb"],modelName:["home","light","tree","michelle"],control:!1,transformControls:O,helper:O,light:!1,showStats:!1,creatMesh:X,animation:U});return pt(()=>{A(),document.body.removeEventListener("click",V),V=null,o=null}),(e,n)=>(ht(),gt(st,{loading:N(q),pregress:N(F)},{default:yt(()=>n[0]||(n[0]=[d("canvas",{id:"canvas"},null,-1),d("div",{class:"tips"},[d("p",null,"鼠标点击相册，预览图片，点击地面相机视角移动！"),d("p",null,"cameraControls相机控制："),d("ul",null,[d("li",null,"W 前进"),d("li",null,"S 后退"),d("li",null,"A 向左"),d("li",null,"D 向右")])],-1)])),_:1},8,["loading","pregress"]))}},Vt=mt(ft,[["__scopeId","data-v-e60b2df6"]]);export{Vt as default};
