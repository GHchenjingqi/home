import{_ as Nn,r as br,q as ka,N as Da,o as yt,j as Ut,a as Ye,F as Tr,l as so,n as Aa,t as Fa,E as Ma,h as Ea,v as La,G as Sr,i as Vo,g as Ra,c as Pa,w as Oa,u as lo,p as Ia}from"./index-BiR2tmUB.js";import{u as jo}from"./allscreen-Dwh9EWX0.js";import{U as Ba,k as Ga,R as Na,ah as Wa,ai as za,aj as Xo,a as Wn,c as Fr,h as In,ak as Va,al as uo,am as ja,an as Xa,ao as Ha,y as fo,ap as Ya,M as Ka,D as Ja,f as Za,V as Mr,Y as Er,u as qa,L as Qa}from"./Loading-CMMGbIOt.js";import{u as $a,K as wn,C as cr}from"./camera-controls.module-CQwCF4WW.js";import{k as lt,o as ei,i as ti}from"./creatMesh-CnULTRNw.js";import{u as ni}from"./useRay-BAQMZpyl.js";import{Z as co}from"./zoomtastic.umd-DXSdxC-m.js";import{T as ri,E as oi,r as ai}from"./tween.esm-Dp1EtNfj.js";import"./loading-yi1sZU8z.js";import"./_commonjsHelpers-Cpj98o6Y.js";const ii={class:"accordion solution"},si=["onClick"],li={class:"left-top"},ui=["innerHTML"],fi={class:"right"},ci={class:"box"},di=["title","onClick"],hi={__name:"Accordion",props:{items:{type:Array,default:()=>[]}},setup(s){const n=br(0),f=ka(),u=Da(),t=jo(),e=l=>l.replace(/([a-zA-Z]+)/g,'<span style="font-size:20px">$1</span>'),r=l=>e(l),i=async(l,c)=>{u.showLoading(),await f.push(l),o(c)},o=async l=>{t.setFlagStatus(!1),await Ma();const c=document.getElementById("menu");if(c){const d=c.getElementsByClassName("menu-item");d[l]&&(c.scrollTop=d[l].offsetTop)}u.hideLoading()},a=l=>{n.value=l};return(l,c)=>(yt(),Ut("div",ii,[Ye("ul",null,[(yt(!0),Ut(Tr,null,so(s.items,(d,h)=>(yt(),Ut("li",{key:h,class:Aa(["accordion-item",{on:n.value===h}]),onClick:v=>a(h)},[c[0]||(c[0]=Ye("div",{class:"left"},null,-1)),Ye("div",li,[Ye("div",{innerHTML:r(d.title)},null,8,ui)]),Ye("div",fi,[Ye("dl",null,[Ye("div",ci,[(yt(!0),Ut(Tr,null,so(d.children,(v,m)=>(yt(),Ut("dd",{key:m,title:v.name,onClick:g=>i(v.path,m)},Fa(v.name),9,di))),128))])])])],10,si))),128))])]))}},pi=Nn(hi,[["__scopeId","data-v-c363bd40"]]),vi={class:"book-boom"},mi={class:"know-rec box"},gi={__name:"KnowHome",props:{show:{type:Boolean,default:!1},menus:{type:Array,default:()=>[]}},emits:["bookHide"],setup(s,{emit:n}){const f=n,u=()=>{f("bookHide")};return(t,e)=>Ea((yt(),Ut("div",vi,[Ye("div",{class:"boom-layer",onClick:u}),Ye("div",mi,[Sr(pi,{items:s.menus},null,8,["items"])])],512)),[[La,s.show]])}},_i=Nn(gi,[["__scopeId","data-v-264d42f9"]]);/**
 * anime.js - ESM
 * @version v4.0.0
 * @author Julian Garnier
 * @license MIT
 * @copyright (c) 2025 Julian Garnier
 * @see https://animejs.com
 */const ct=typeof window<"u",dr=ct?window:null,Wt=ct?document:null,Ne={OBJECT:0,ATTRIBUTE:1,CSS:2,TRANSFORM:3,CSS_VAR:4},ke={NUMBER:0,UNIT:1,COLOR:2,COMPLEX:3},nt={NONE:0,AUTO:1,FORCE:2},$e={replace:0,none:1,blend:2},ho=Symbol(),Lr=Symbol(),Ho=Symbol(),zn=Symbol(),yi=Symbol(),Re=1e-11,Yo=1e12,zt=1e3,xr=120,Ct="",fn=new Map;fn.set("x","translateX");fn.set("y","translateY");fn.set("z","translateZ");const Rr=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Ko=Rr.reduce((s,n)=>({...s,[n]:n+"("}),{}),tt=()=>{},bi=/(^#([\da-f]{3}){1,2}$)|(^#([\da-f]{4}){1,2}$)/i,Ti=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i,Si=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,xi=/hsl\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*\)/i,wi=/hsla\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,po=/[-+]?\d*\.?\d+(?:e[-+]?\d)?/gi,Ui=/^([-+]?\d*\.?\d+(?:e[-+]?\d+)?)([a-z]+|%)$/i,Ci=/([a-z])([A-Z])/g,ki=/(\w+)(\([^)]+\)+)/g,Jo={id:null,keyframes:null,playbackEase:null,playbackRate:1,frameRate:xr,loop:0,reversed:!1,alternate:!1,autoplay:!0,duration:zt,delay:0,loopDelay:0,ease:"out(2)",composition:$e.replace,modifier:s=>s,onBegin:tt,onBeforeUpdate:tt,onUpdate:tt,onLoop:tt,onPause:tt,onComplete:tt,onRender:tt},je={defaults:Jo,root:Wt,scope:null,precision:4,timeScale:1,tickThreshold:200},Zo={version:"4.0.0",engine:null};ct&&(dr.AnimeJS||(dr.AnimeJS=[]),dr.AnimeJS.push(Zo));const Di=s=>s.replace(Ci,"$1-$2").toLowerCase(),Bt=(s,n)=>s.indexOf(n)===0,ln=Date.now,un=Array.isArray,hr=s=>s&&s.constructor===Object,Ai=s=>typeof s=="number"&&!isNaN(s),Vn=s=>typeof s=="string",Bn=s=>typeof s=="function",Le=s=>typeof s>"u",pr=s=>Le(s)||s===null,qo=s=>ct&&s instanceof SVGElement,Qo=s=>bi.test(s),$o=s=>Bt(s,"rgb"),ea=s=>Bt(s,"hsl"),Fi=s=>Qo(s)||$o(s)||ea(s),Mn=s=>!je.defaults.hasOwnProperty(s),Un=s=>Vn(s)?parseFloat(s):s,Rt=Math.pow,Mi=Math.sqrt,Ei=Math.sin,Li=Math.cos,Ri=Math.abs,Pi=Math.ceil,ta=Math.floor,Oi=Math.asin,Pr=Math.PI,vo=Math.round,He=(s,n,f)=>s<n?n:s>f?f:s,mo={},Oe=(s,n)=>{if(n<0)return s;if(!n)return vo(s);let f=mo[n];return f||(f=mo[n]=10**n),vo(s*f)/f},St=(s,n,f)=>s+(n-s)*f,En=s=>s===1/0?Yo:s===-1/0?-1e12:s,Gt=s=>s<Re?Re:s,Je=s=>un(s)?[...s]:s,Ii=(s,n)=>{const f={...s};for(let u in n){const t=s[u];f[u]=Le(t)?n[u]:t}return f},We=(s,n,f,u="_prev",t="_next")=>{let e=s._head,r=t;for(f&&(e=s._tail,r=u);e;){const i=e[r];n(e),e=i}},on=(s,n,f="_prev",u="_next")=>{const t=n[f],e=n[u];t?t[u]=e:s._head=e,e?e[f]=t:s._tail=t,n[f]=null,n[u]=null},It=(s,n,f,u="_prev",t="_next")=>{let e=s._tail;for(;e&&f&&f(e,n);)e=e[u];const r=e?e[t]:s._head;e?e[t]=n:s._head=n,r?r[u]=n:s._tail=n,n[u]=e,n[t]=r};class na{constructor(n=0){this.deltaTime=0,this._currentTime=n,this._elapsedTime=n,this._startTime=n,this._lastTime=n,this._scheduledTime=0,this._frameDuration=Oe(zt/xr,0),this._fps=xr,this._speed=1,this._hasChildren=!1,this._head=null,this._tail=null}get fps(){return this._fps}set fps(n){const f=this._frameDuration,u=+n,t=u<Re?Re:u,e=Oe(zt/t,0);this._fps=t,this._frameDuration=e,this._scheduledTime+=e-f}get speed(){return this._speed}set speed(n){const f=+n;this._speed=f<Re?Re:f}requestTick(n){const f=this._scheduledTime,u=this._elapsedTime;if(this._elapsedTime+=n-u,u<f)return nt.NONE;const t=this._frameDuration,e=u-f;return this._scheduledTime+=e<t?t:e,nt.AUTO}computeDeltaTime(n){const f=n-this._lastTime;return this.deltaTime=f,this._lastTime=n,f}}const Ln=(s,n,f,u,t)=>{const e=s.parent,r=s.duration,i=s.completed,o=s.iterationDuration,a=s.iterationCount,l=s._currentIteration,c=s._loopDelay,d=s._reversed,h=s._alternate,v=s._hasChildren,m=s._delay,g=s._currentTime,I=m+o,k=n-m,w=He(g,-m,r),y=He(k,-m,r),x=k-g,O=y>0,U=y>=r,M=r<=Re,V=t===nt.FORCE;let G=0,ee=k,_=0;if(a>1){const ae=~~(y/(o+(U?0:c)));s._currentIteration=He(ae,0,a),U&&s._currentIteration--,G=s._currentIteration%2,ee=y%(o+c)||0}const B=d^(h&&G),C=s._ease;let X=U?B?0:r:B?o-ee:ee;C&&(X=o*C(X/o)||0);const j=(e?e.backwards:k<g)?!B:!!B;if(s._currentTime=k,s._iterationTime=X,s.backwards=j,O&&!s.began?(s.began=!0,!f&&!(e&&(j||!e.began))&&s.onBegin(s)):k<=0&&(s.began=!1),!f&&!v&&O&&s._currentIteration!==l&&s.onLoop(s),V||t===nt.AUTO&&(n>=m&&n<=I||n<=m&&w>m||n>=I&&w!==r)||X>=I&&w!==r||X<=m&&w>0||n<=w&&w===r&&i||U&&!i&&M){if(O&&(s.computeDeltaTime(w),f||s.onBeforeUpdate(s)),!v){const ae=V||(j?x*-1:x)>=je.tickThreshold,re=s._offset+(e?e._offset:0)+m+X;let b=s._head,R,p,T,A,E=0;for(;b;){const S=b._composition,N=b._currentTime,P=b._changeDuration,z=b._absoluteStartTime+b._changeDuration,q=b._nextRep,F=b._prevRep,D=S!==$e.none;if((ae||(N!==P||re<=z+(q?q._delay:0))&&(N!==0||re>=b._absoluteStartTime))&&(!D||!b._isOverridden&&(!b._isOverlapped||re<=z)&&(!q||q._isOverridden||re<=q._absoluteStartTime)&&(!F||F._isOverridden||re>=F._absoluteStartTime+F._changeDuration+b._delay))){const L=b._currentTime=He(X-b._startTime,0,P),Z=b._ease(L/b._updateDuration),K=b._modifier,Y=b._valueType,J=b._tweenType,Q=J===Ne.OBJECT,H=Y===ke.NUMBER,oe=H&&Q||Z===0||Z===1?-1:je.precision;let te,W;if(H)te=W=K(Oe(St(b._fromNumber,b._toNumber,Z),oe));else if(Y===ke.UNIT)W=K(Oe(St(b._fromNumber,b._toNumber,Z),oe)),te=`${W}${b._unit}`;else if(Y===ke.COLOR){const se=b._fromNumbers,ne=b._toNumbers,ie=Oe(He(K(St(se[0],ne[0],Z)),0,255),0),$=Oe(He(K(St(se[1],ne[1],Z)),0,255),0),Se=Oe(He(K(St(se[2],ne[2],Z)),0,255),0),le=He(K(Oe(St(se[3],ne[3],Z),oe)),0,1);if(te=`rgba(${ie},${$},${Se},${le})`,D){const ue=b._numbers;ue[0]=ie,ue[1]=$,ue[2]=Se,ue[3]=le}}else if(Y===ke.COMPLEX){te=b._strings[0];for(let se=0,ne=b._toNumbers.length;se<ne;se++){const ie=K(Oe(St(b._fromNumbers[se],b._toNumbers[se],Z),oe)),$=b._strings[se+1];te+=`${$?ie+$:ie}`,D&&(b._numbers[se]=ie)}}if(D&&(b._number=W),!u&&S!==$e.blend){const se=b.property;R=b.target,Q?R[se]=te:J===Ne.ATTRIBUTE?R.setAttribute(se,te):(p=R.style,J===Ne.TRANSFORM?(R!==T&&(T=R,A=R[zn]),A[se]=te,E=1):J===Ne.CSS?p[se]=te:J===Ne.CSS_VAR&&p.setProperty(se,te)),O&&(_=1)}else b._value=te}if(E&&b._renderTransforms){let L=Ct;for(let Z in A)L+=`${Ko[Z]}${A[Z]}) `;p.transform=L,E=0}b=b._next}!f&&_&&s.onRender(s)}!f&&O&&s.onUpdate(s)}return e&&M?!f&&(e.began&&!j&&k>=r&&!i||j&&k<=Re&&i)&&(s.onComplete(s),s.completed=!j):O&&U?a===1/0?s._startTime+=s.duration:s._currentIteration>=a-1&&(s.paused=!0,!i&&!v&&(s.completed=!0,!f&&!(e&&(j||!e.began))&&(s.onComplete(s),s._resolve(s)))):s.completed=!1,_},Pt=(s,n,f,u,t)=>{const e=s._currentIteration;if(Ln(s,n,f,u,t),s._hasChildren){const r=s,i=r.backwards,o=u?n:r._iterationTime,a=ln();let l=0,c=!0;if(!u&&r._currentIteration!==e){const d=r.iterationDuration;We(r,h=>{if(!i)!h.completed&&!h.backwards&&h._currentTime<h.iterationDuration&&Ln(h,d,f,1,nt.FORCE),h.began=!1,h.completed=!1;else{const v=h.duration,m=h._offset+h._delay,g=m+v;!f&&v<=Re&&(!m||g===d)&&h.onComplete(h)}}),f||r.onLoop(r)}We(r,d=>{const h=Oe((o-d._offset)*d._speed,12),v=d._fps<r._fps?d.requestTick(a):t;l+=Ln(d,h,f,u,v),!d.completed&&c&&(c=!1)},i),!f&&l&&r.onRender(r),c&&r._currentTime>=r.duration&&(r.paused=!0,r.completed||(r.completed=!0,f||(r.onComplete(r),r._resolve(r))))}},Nt={animation:null,update:tt},Bi=s=>{let n=Nt.animation;return n||(n={duration:Re,computeDeltaTime:tt,_offset:0,_delay:0,_head:null,_tail:null},Nt.animation=n,Nt.update=()=>{s.forEach(f=>{for(let u in f){const t=f[u],e=t._head;if(e){const r=e._valueType,i=r===ke.COMPLEX||r===ke.COLOR?Je(e._fromNumbers):null;let o=e._fromNumber,a=t._tail;for(;a&&a!==e;){if(i)for(let l=0,c=a._numbers.length;l<c;l++)i[l]+=a._numbers[l];else o+=a._number;a=a._prevAdd}e._toNumber=o,e._toNumbers=i}}}),Ln(n,1,1,0,nt.FORCE)}),n},ra=ct?requestAnimationFrame:setImmediate,Gi=ct?cancelAnimationFrame:clearImmediate;class Ni extends na{constructor(n){super(n),this.useDefaultMainLoop=!0,this.pauseOnDocumentHidden=!0,this.defaults=Jo,this.paused=!!(ct&&Wt.hidden),this.reqId=null}update(){const n=this._currentTime=ln();if(this.requestTick(n)){this.computeDeltaTime(n);const f=this._speed,u=this._fps;let t=this._head;for(;t;){const e=t._next;t.paused?(on(this,t),this._hasChildren=!!this._tail,t._running=!1,t.completed&&!t._cancelled&&t.cancel()):Pt(t,(n-t._startTime)*t._speed*f,0,0,t._fps<u?t.requestTick(n):nt.AUTO),t=e}Nt.update()}}wake(){return this.useDefaultMainLoop&&!this.reqId&&!this.paused&&(this.reqId=ra(oa)),this}pause(){return this.paused=!0,Wi()}resume(){if(this.paused)return this.paused=!1,We(this,n=>n.resetTime()),this.wake()}get speed(){return this._speed*(je.timeScale===1?1:zt)}set speed(n){this._speed=n*je.timeScale,We(this,f=>f.speed=f._speed)}get timeUnit(){return je.timeScale===1?"ms":"s"}set timeUnit(n){const u=n==="s",t=u?.001:1;if(je.timeScale!==t){je.timeScale=t,je.tickThreshold=200*t;const e=u?.001:zt;this.defaults.duration*=e,this._speed*=e}}get precision(){return je.precision}set precision(n){je.precision=n}}const Xe=(()=>{const s=new Ni(ln());return ct&&(Zo.engine=s,Wt.addEventListener("visibilitychange",()=>{s.pauseOnDocumentHidden&&(Wt.hidden?s.pause():s.resume())})),s})(),oa=()=>{Xe._head?(Xe.reqId=ra(oa),Xe.update()):Xe.reqId=0},Wi=()=>(Gi(Xe.reqId),Xe.reqId=0,Xe),zi=(s,n,f)=>{const u=s.style.transform;let t;if(u){const e=s[zn];let r;for(;r=ki.exec(u);){const i=r[1],o=r[2].slice(1,-1);e[i]=o,i===n&&(t=o,f&&(f[n]=o))}}return u&&!Le(t)?t:Bt(n,"scale")?"1":Bt(n,"rotate")||Bt(n,"skew")?"0deg":"0px"};function go(s){const n=Vn(s)?je.root.querySelectorAll(s):s;if(n instanceof NodeList||n instanceof HTMLCollection)return n}function Vi(s){if(pr(s))return[];if(un(s)){const f=s.flat(1/0),u=[];for(let t=0,e=f.length;t<e;t++){const r=f[t];if(!pr(r)){const i=go(r);if(i)for(let o=0,a=i.length;o<a;o++){const l=i[o];if(!pr(l)){let c=!1;for(let d=0,h=u.length;d<h;d++)if(u[d]===l){c=!0;break}c||u.push(l)}}else{let o=!1;for(let a=0,l=u.length;a<l;a++)if(u[a]===r){o=!0;break}o||u.push(r)}}}return u}if(!ct)return[s];const n=go(s);return n?Array.from(n):[s]}function ji(s){const n=Vi(s),f=n.length;if(f)for(let u=0;u<f;u++){const t=n[u];if(!t[ho]){t[ho]=!0;const e=qo(t);(t.nodeType||e)&&(t[Lr]=!0,t[Ho]=e,t[zn]={})}}return n}const Xi=["opacity","rotate","overflow","color"],Hi=(s,n)=>{if(Xi.includes(n))return!1;if(s.getAttribute(n)||n in s){if(n==="scale"){const f=s.parentNode;return f&&f.tagName==="filter"}return!0}},Yi=s=>{const n=Ti.exec(s)||Si.exec(s),f=Le(n[4])?1:+n[4];return[+n[1],+n[2],+n[3],f]},Ki=s=>{const n=s.length,f=n===4||n===5;return[+("0x"+s[1]+s[f?1:2]),+("0x"+s[f?2:3]+s[f?2:4]),+("0x"+s[f?3:5]+s[f?3:6]),n===5||n===9?+(+("0x"+s[f?4:7]+s[f?4:8])/255).toFixed(3):1]},vr=(s,n,f)=>(f<0&&(f+=1),f>1&&(f-=1),f<1/6?s+(n-s)*6*f:f<1/2?n:f<2/3?s+(n-s)*(2/3-f)*6:s),Ji=s=>{const n=xi.exec(s)||wi.exec(s),f=+n[1]/360,u=+n[2]/100,t=+n[3]/100,e=Le(n[4])?1:+n[4];let r,i,o;if(u===0)r=i=o=t;else{const a=t<.5?t*(1+u):t+u-t*u,l=2*t-a;r=Oe(vr(l,a,f+1/3)*255,0),i=Oe(vr(l,a,f)*255,0),o=Oe(vr(l,a,f-1/3)*255,0)}return[r,i,o,e]},Zi=s=>$o(s)?Yi(s):Qo(s)?Ki(s):ea(s)?Ji(s):[0,0,0,1],Ze=(s,n)=>Le(s)?n:s,gt=(s,n,f,u,t)=>{if(Bn(s)){const e=()=>{const r=s(n,f,u);return isNaN(+r)?r||0:+r};return t&&(t.func=e),e()}else return s},aa=(s,n)=>s[Lr]?s[Ho]&&Hi(s,n)?Ne.ATTRIBUTE:Rr.includes(n)||fn.get(n)?Ne.TRANSFORM:Bt(n,"--")?Ne.CSS_VAR:n in s.style?Ne.CSS:n in s?Ne.OBJECT:Ne.ATTRIBUTE:Ne.OBJECT,_o=(s,n,f)=>{const u=s.style[n];u&&f&&(f[n]=u);const t=u||getComputedStyle(s[yi]||s).getPropertyValue(n);return t==="auto"?"0":t},tn=(s,n,f,u)=>{const t=Le(f)?aa(s,n):f;return t===Ne.OBJECT?s[n]||0:t===Ne.ATTRIBUTE?s.getAttribute(n):t===Ne.TRANSFORM?zi(s,n,u):t===Ne.CSS_VAR?_o(s,n,u).trimStart():_o(s,n,u)},yo=(s,n,f)=>f==="-"?s-n:f==="+"?s+n:s*n,Or=()=>({t:ke.NUMBER,n:0,u:null,o:null,d:null,s:null}),ut=(s,n)=>{if(n.t=ke.NUMBER,n.n=0,n.u=null,n.o=null,n.d=null,n.s=null,!s)return n;const f=+s;if(isNaN(f)){let u=s;u[1]==="="&&(n.o=u[0],u=u.slice(2));const t=u.includes(" ")?!1:Ui.exec(u);if(t)return n.t=ke.UNIT,n.n=+t[1],n.u=t[2],n;if(n.o)return n.n=+u,n;if(Fi(u))return n.t=ke.COLOR,n.d=Zi(u),n;{const e=u.match(po);return n.t=ke.COMPLEX,n.d=e?e.map(Number):[],n.s=u.split(po)||[],n}}else return n.n=f,n},bo=(s,n)=>(n.t=s._valueType,n.n=s._toNumber,n.u=s._unit,n.o=null,n.d=Je(s._toNumbers),n.s=Je(s._strings),n),xt=Or(),Gn={_rep:new WeakMap,_add:new Map},Ir=(s,n,f="_rep")=>{const u=Gn[f];let t=u.get(s);return t||(t={},u.set(s,t)),t[n]?t[n]:t[n]={_head:null,_tail:null}},qi=(s,n)=>s._isOverridden||s._absoluteStartTime>n._absoluteStartTime,Rn=s=>{s._isOverlapped=1,s._isOverridden=1,s._changeDuration=Re,s._currentTime=Re},ia=(s,n)=>{const f=s._composition;if(f===$e.replace){const u=s._absoluteStartTime;It(n,s,qi,"_prevRep","_nextRep");const t=s._prevRep;if(t){const e=t.parent,r=t._absoluteStartTime+t._changeDuration;if(s.parent.id!==e.id&&e.iterationCount>1&&r+(e.duration-e.iterationDuration)>u){Rn(t);let a=t._prevRep;for(;a&&a.parent.id===e.id;)Rn(a),a=a._prevRep}const i=u-s._delay;if(r>i){const a=t._startTime,l=r-(a+t._updateDuration);t._changeDuration=i-l-a,t._currentTime=t._changeDuration,t._isOverlapped=1,t._changeDuration<Re&&Rn(t)}let o=!0;if(We(e,a=>{a._isOverlapped||(o=!1)}),o){const a=e.parent;if(a){let l=!0;We(a,c=>{c!==e&&We(c,d=>{d._isOverlapped||(l=!1)})}),l&&a.cancel()}else e.cancel()}}}else if(f===$e.blend){const u=Ir(s.target,s.property,"_add"),t=Bi(Gn._add);let e=u._head;e||(e={...s},e._composition=$e.replace,e._updateDuration=Re,e._startTime=0,e._numbers=Je(s._fromNumbers),e._number=0,e._next=null,e._prev=null,It(u,e),It(t,e));const r=s._toNumber;if(s._fromNumber=e._fromNumber-r,s._toNumber=0,s._numbers=Je(s._fromNumbers),s._number=0,e._fromNumber=r,s._toNumbers){const i=Je(s._toNumbers);i&&i.forEach((o,a)=>{s._fromNumbers[a]=e._fromNumbers[a]-o,s._toNumbers[a]=0}),e._fromNumbers=i}It(u,s,null,"_prevAdd","_nextAdd")}return s},Qi=s=>{const n=s._composition;if(n!==$e.none){const f=s.target,u=s.property,r=Gn._rep.get(f)[u];if(on(r,s,"_prevRep","_nextRep"),n===$e.blend){const i=Gn._add,o=i.get(f);if(!o)return;const a=o[u],l=Nt.animation;on(a,s,"_prevAdd","_nextAdd");const c=a._head;if(c&&c===a._tail){on(a,c,"_prevAdd","_nextAdd"),on(l,c);let d=!0;for(let h in o)if(o[h]._head){d=!1;break}d&&i.delete(f)}}}return s},To=s=>(s.paused=!0,s.began=!1,s.completed=!1,s),wr=s=>(s._cancelled&&(s._hasChildren?We(s,wr):We(s,n=>{n._composition!==$e.none&&ia(n,Ir(n.target,n.property))}),s._cancelled=0),s);let $i=0;class es extends na{constructor(n={},f=null,u=0){super(0);const{id:t,delay:e,duration:r,reversed:i,alternate:o,loop:a,loopDelay:l,autoplay:c,frameRate:d,playbackRate:h,onComplete:v,onLoop:m,onPause:g,onBegin:I,onBeforeUpdate:k,onUpdate:w}=n,y=f?0:Xe._elapsedTime,x=f?f.defaults:je.defaults,O=Bn(e)||Le(e)?x.delay:+e,U=Bn(r)||Le(r)?1/0:+r,M=Ze(a,x.loop),V=Ze(l,x.loopDelay),G=M===!0||M===1/0||M<0?1/0:M+1;let ee=0;if(f)ee=u;else{let _=ln();Xe.paused&&(Xe.requestTick(_),_=Xe._elapsedTime),ee=_-Xe._startTime}this.id=Le(t)?++$i:t,this.parent=f,this.duration=En((U+V)*G-V)||Re,this.backwards=!1,this.paused=!0,this.began=!1,this.completed=!1,this.onBegin=I||x.onBegin,this.onBeforeUpdate=k||x.onBeforeUpdate,this.onUpdate=w||x.onUpdate,this.onLoop=m||x.onLoop,this.onPause=g||x.onPause,this.onComplete=v||x.onComplete,this.iterationDuration=U,this.iterationCount=G,this._autoplay=f?!1:Ze(c,x.autoplay),this._offset=ee,this._delay=O,this._loopDelay=V,this._iterationTime=0,this._currentIteration=0,this._resolve=tt,this._running=!1,this._reversed=+Ze(i,x.reversed),this._reverse=this._reversed,this._cancelled=0,this._alternate=Ze(o,x.alternate),this._prev=null,this._next=null,this._elapsedTime=y,this._startTime=y,this._lastTime=y,this._fps=Ze(d,x.frameRate),this._speed=Ze(h,x.playbackRate)}get cancelled(){return!!this._cancelled}set cancelled(n){n?this.cancel():this.reset(1).play()}get currentTime(){return He(Oe(this._currentTime,je.precision),-this._delay,this.duration)}set currentTime(n){const f=this.paused;this.pause().seek(+n),f||this.resume()}get iterationCurrentTime(){return Oe(this._iterationTime,je.precision)}set iterationCurrentTime(n){this.currentTime=this.iterationDuration*this._currentIteration+n}get progress(){return He(Oe(this._currentTime/this.duration,5),0,1)}set progress(n){this.currentTime=this.duration*n}get iterationProgress(){return He(Oe(this._iterationTime/this.iterationDuration,5),0,1)}set iterationProgress(n){const f=this.iterationDuration;this.currentTime=f*this._currentIteration+f*n}get currentIteration(){return this._currentIteration}set currentIteration(n){this.currentTime=this.iterationDuration*He(+n,0,this.iterationCount-1)}get reversed(){return!!this._reversed}set reversed(n){n?this.reverse():this.play()}get speed(){return super.speed}set speed(n){super.speed=n,this.resetTime()}reset(n=0){return wr(this),this._reversed&&!this._reverse&&(this.reversed=!1),this._iterationTime=this.iterationDuration,Pt(this,0,1,n,nt.FORCE),To(this),this._hasChildren&&We(this,To),this}init(n=0){this.fps=this._fps,this.speed=this._speed,!n&&this._hasChildren&&Pt(this,this.duration,1,n,nt.FORCE),this.reset(n);const f=this._autoplay;return f===!0?this.resume():f&&!Le(f.linked)&&f.link(this),this}resetTime(){const n=1/(this._speed*Xe._speed);return this._startTime=ln()-(this._currentTime+this._delay)*n,this}pause(){return this.paused?this:(this.paused=!0,this.onPause(this),this)}resume(){return this.paused?(this.paused=!1,this.duration<=Re&&!this._hasChildren?Pt(this,Re,0,0,nt.FORCE):(this._running||(It(Xe,this),Xe._hasChildren=!0,this._running=!0),this.resetTime(),this._startTime-=12,Xe.wake()),this):this}restart(){return this.reset(0).resume()}seek(n,f=0,u=0){wr(this),this.completed=!1;const t=this.paused;return this.paused=!0,Pt(this,n+this._delay,~~f,~~u,nt.AUTO),t?this:this.resume()}alternate(){const n=this._reversed,f=this.iterationCount,u=this.iterationDuration,t=f===1/0?ta(Yo/u):f;return this._reversed=+(this._alternate&&!(t%2)?n:!n),f===1/0?this.iterationProgress=this._reversed?1-this.iterationProgress:this.iterationProgress:this.seek(u*t-this._currentTime),this.resetTime(),this}play(){return this._reversed&&this.alternate(),this.resume()}reverse(){return this._reversed||this.alternate(),this.resume()}cancel(){return this._hasChildren?We(this,n=>n.cancel(),!0):We(this,Qi),this._cancelled=1,this.pause()}stretch(n){const f=this.duration;if(f===Gt(n))return this;const u=n/f,t=n<=Re;return this.duration=t?Re:Gt(En(Oe(f*u,12))),this.iterationDuration=t?Re:Gt(En(Oe(this.iterationDuration*u,12))),this._offset*=u,this._delay*=u,this._loopDelay*=u,this}revert(){Pt(this,0,1,0,nt.AUTO);const n=this._autoplay;return n&&n.linked&&n.linked===this&&n.revert(),this.cancel()}complete(){return this.seek(this.duration).cancel()}then(n=tt){const f=this.then,u=()=>{this.then=null,n(this),this.then=f,this._resolve=tt};return new Promise(t=>(this._resolve=()=>t(u()),this.completed&&this._resolve(),this))}}const Vt=s=>s,sa=(s,n,f)=>(((1-3*f+3*n)*s+(3*f-6*n))*s+3*n)*s,ts=(s,n,f)=>{let u=0,t=1,e,r,i=0;do r=u+(t-u)/2,e=sa(r,n,f)-s,e>0?t=r:u=r;while(Ri(e)>1e-7&&++i<100);return r},ns=(s=.5,n=0,f=.5,u=1)=>s===n&&f===u?Vt:t=>t===0||t===1?t:sa(ts(t,s,f),n,u),rs=(s=10,n)=>{const f=n?Pi:ta;return u=>f(He(u,0,1)*s)*(1/s)},la=(...s)=>{const n=s.length;if(!n)return Vt;const f=n-1,u=s[0],t=s[f],e=[0],r=[Un(u)];for(let i=1;i<f;i++){const o=s[i],a=Vn(o)?o.trim().split(" "):[o],l=a[0],c=a[1];e.push(Le(c)?i/f:Un(c)/100),r.push(Un(l))}return r.push(Un(t)),e.push(1),function(o){for(let a=1,l=e.length;a<l;a++){const c=e[a];if(o<=c){const d=e[a-1],h=r[a-1];return h+(r[a]-h)*(o-d)/(c-d)}}return r[r.length-1]}},os=(s=10,n=1)=>{const f=[0],u=s-1;for(let t=1;t<u;t++){const e=f[t-1],r=t/u,i=(t+1)/u,o=r+(i-r)*Math.random(),a=r*(1-n)+o*n;f.push(He(a,e,1))}return f.push(1),la(...f)},as=Pr/2,So=Pr*2,nn=(s=1.68)=>n=>Rt(n,+s),xo={[Ct]:nn,Quad:nn(2),Cubic:nn(3),Quart:nn(4),Quint:nn(5),Sine:s=>1-Li(s*as),Circ:s=>1-Mi(1-s*s),Expo:s=>s?Rt(2,10*s-10):0,Bounce:s=>{let n,f=4;for(;s<((n=Rt(2,--f))-1)/11;);return 1/Rt(4,3-f)-7.5625*Rt((n*3-2)/22-s,2)},Back:(s=1.70158)=>n=>(+s+1)*n*n*n-+s*n*n,Elastic:(s=1,n=.3)=>{const f=He(+s,1,10),u=He(+n,Re,2),t=u/So*Oi(1/f),e=So/u;return r=>r===0||r===1?r:-f*Rt(2,-10*(1-r))*Ei((1-r-t)*e)}},Ur={in:s=>n=>s(n),out:s=>n=>1-s(1-n),inOut:s=>n=>n<.5?s(n*2)/2:1-s(n*-2+2)/2,outIn:s=>n=>n<.5?(1-s(1-n*2))/2:(s(n*2-1)+1)/2},is=(s,n,f)=>{if(f[s])return f[s];if(s.indexOf("(")<=-1){const t=Ur[s]||s.includes("Back")||s.includes("Elastic")?n[s]():n[s];return t?f[s]=t:Vt}else{const u=s.slice(0,-1).split("("),t=n[u[0]];return t?f[s]=t(...u[1].split(",")):Vt}},ss=(()=>{const s={linear:la,irregular:os,steps:rs,cubicBezier:ns};for(let n in Ur)for(let f in xo){const u=xo[f],t=Ur[n];s[n+f]=f===Ct||f==="Back"||f==="Elastic"?(e,r)=>t(u(e,r)):t(u)}return s})(),ls={linear:Vt},wo=s=>Bn(s)?s:Vn(s)?is(s,ss,ls):Vt,Uo={},us=(s,n,f)=>{if(f===Ne.TRANSFORM){const u=fn.get(s);return u||s}else if(f===Ne.CSS||f===Ne.ATTRIBUTE&&qo(n)&&s in n.style){const u=Uo[s];if(u)return u;{const t=s&&Di(s);return Uo[s]=t,t}}else return s},mr={deg:1,rad:180/Pr,turn:360},Co={},fs=(s,n,f,u=!1)=>{const t=n.u,e=n.n;if(n.t===ke.UNIT&&t===f)return n;const r=e+t+f,i=Co[r];if(!Le(i)&&!u)n.n=i;else{let o;if(t in mr)o=e*mr[t]/mr[f];else{const l=s.cloneNode(),c=s.parentNode,d=c&&c!==Wt?c:Wt.body;d.appendChild(l);const h=l.style;h.width=100+t;const v=l.offsetWidth||100;h.width=100+f;const m=l.offsetWidth||100,g=v/m;d.removeChild(l),o=g*e}n.n=o,Co[r]=o}return n.t,ke.UNIT,n.u=f,n},ua=s=>{if(s._hasChildren)We(s,ua,!0);else{const n=s;n.pause(),We(n,f=>{const u=f.property,t=f.target;if(t[Lr]){const e=t.style,r=n._inlineStyles[u];if(f._tweenType===Ne.TRANSFORM){const i=t[zn];if(Le(r)||r===Ct?delete i[u]:i[u]=r,f._renderTransforms)if(!Object.keys(i).length)e.removeProperty("transform");else{let o=Ct;for(let a in i)o+=Ko[a]+i[a]+") ";e.transform=o}}else Le(r)||r===Ct?e.removeProperty(u):e[u]=r;n._tail===f&&n.targets.forEach(i=>{i.getAttribute&&i.getAttribute("style")===Ct&&i.removeAttribute("style")})}})}return s},be=Or(),xe=Or(),Cn={func:null},kn=[null],Et=[null,null],Dn={to:null};let cs=0,_t,ft;const ds=(s,n)=>{const f={};if(un(s)){const u=[].concat(...s.map(t=>Object.keys(t))).filter(Mn);for(let t=0,e=u.length;t<e;t++){const r=u[t],i=s.map(o=>{const a={};for(let l in o){const c=o[l];Mn(l)?l===r&&(a.to=c):a[l]=c}return a});f[r]=i}}else{const u=Ze(n.duration,je.defaults.duration);Object.keys(s).map(e=>({o:parseFloat(e)/100,p:s[e]})).sort((e,r)=>e.o-r.o).forEach(e=>{const r=e.o,i=e.p;for(let o in i)if(Mn(o)){let a=f[o];a||(a=f[o]=[]);const l=r*u;let c=a.length,d=a[c-1];const h={to:i[o]};let v=0;for(let m=0;m<c;m++)v+=a[m].duration;c===1&&(h.from=d.to),i.ease&&(h.ease=i.ease),h.duration=l-(c?v:0),a.push(h)}return e});for(let e in f){const r=f[e];let i;for(let o=0,a=r.length;o<a;o++){const l=r[o],c=l.ease;l.ease=i||void 0,i=c}r[0].duration||r.shift()}}return f};class hs extends es{constructor(n,f,u,t,e=!1,r=0,i=0){super(f,u,t);const o=ji(n),a=o.length,l=f.keyframes,c=l?Ii(ds(l,f),f):f,{delay:d,duration:h,ease:v,playbackEase:m,modifier:g,composition:I,onRender:k}=c,w=u?u.defaults:je.defaults,y=Ze(m,w.playbackEase),x=y?wo(y):null,O=!Le(v)&&!Le(v.ease),U=O?v.ease:Ze(v,x?"linear":w.ease),M=O?v.duration:Ze(h,w.duration),V=Ze(d,w.delay),G=g||w.modifier,ee=Le(I)&&a>=zt?$e.none:Le(I)?w.composition:I,_={},B=this._offset+(u?u._offset:0);let C=NaN,X=NaN,j=0,ae=0;for(let re=0;re<a;re++){const b=o[re],R=r||re,p=i||a;let T=NaN,A=NaN;for(let E in c)if(Mn(E)){const S=aa(b,E),N=us(E,b,S);let P=c[E];const z=un(P);if(e&&!z&&(Et[0]=P,Et[1]=P,P=Et),z){const K=P.length,Y=!hr(P[0]);K===2&&Y?(Dn.to=P,kn[0]=Dn,_t=kn):K>2&&Y?(_t=[],P.forEach((J,Q)=>{Q?Q===1?(Et[1]=J,_t.push(Et)):_t.push(J):Et[0]=J})):_t=P}else kn[0]=P,_t=kn;let q=null,F=null,D=NaN,L=0,Z=0;for(let K=_t.length;Z<K;Z++){const Y=_t[Z];hr(Y)?ft=Y:(Dn.to=Y,ft=Dn),Cn.func=null;const J=gt(ft.to,b,R,p,Cn);let Q;hr(J)&&!Le(J.to)?(ft=J,Q=J.to):Q=J;const H=gt(ft.from,b,R,p),oe=ft.ease,te=!Le(oe)&&!Le(oe.ease),W=te?oe.ease:oe||U,se=te?oe.duration:gt(Ze(ft.duration,K>1?gt(M,b,R,p)/K:M),b,R,p),ne=gt(Ze(ft.delay,Z?0:V),b,R,p),ie=gt(Ze(ft.composition,ee),b,R,p),$=Ai(ie)?ie:$e[ie],Se=ft.modifier||G,le=!Le(H),ue=!Le(Q),ce=un(Q),me=ce||le&&ue,De=F?L+ne:ne,Ae=B+De;!ae&&(le||ce)&&(ae=1);let he=F;if($!==$e.none){q||(q=Ir(b,N));let pe=q._head;for(;pe&&!pe._isOverridden&&pe._absoluteStartTime<=Ae;)if(he=pe,pe=pe._nextRep,pe&&pe._absoluteStartTime>=Ae)for(;pe;)Rn(pe),pe=pe._nextRep}if(me?(ut(ce?gt(Q[0],b,R,p):H,be),ut(ce?gt(Q[1],b,R,p,Cn):Q,xe),be.t===ke.NUMBER&&(he?he._valueType===ke.UNIT&&(be.t=ke.UNIT,be.u=he._unit):(ut(tn(b,N,S,_),xt),xt.t===ke.UNIT&&(be.t=ke.UNIT,be.u=xt.u)))):(ue?ut(Q,xe):F?bo(F,xe):ut(u&&he&&he.parent.parent===u?he._value:tn(b,N,S,_),xe),le?ut(H,be):F?bo(F,be):ut(u&&he&&he.parent.parent===u?he._value:tn(b,N,S,_),be)),be.o&&(be.n=yo(he?he._toNumber:ut(tn(b,N,S,_),xt).n,be.n,be.o)),xe.o&&(xe.n=yo(be.n,xe.n,xe.o)),be.t!==xe.t){if(be.t===ke.COMPLEX||xe.t===ke.COMPLEX){const pe=be.t===ke.COMPLEX?be:xe,_e=be.t===ke.COMPLEX?xe:be;_e.t=ke.COMPLEX,_e.s=Je(pe.s),_e.d=pe.d.map(()=>_e.n)}else if(be.t===ke.UNIT||xe.t===ke.UNIT){const pe=be.t===ke.UNIT?be:xe,_e=be.t===ke.UNIT?xe:be;_e.t=ke.UNIT,_e.u=pe.u}else if(be.t===ke.COLOR||xe.t===ke.COLOR){const pe=be.t===ke.COLOR?be:xe,_e=be.t===ke.COLOR?xe:be;_e.t=ke.COLOR,_e.s=pe.s,_e.d=[0,0,0,1]}}if(be.u!==xe.u){let pe=xe.u?be:xe;pe=fs(b,pe,xe.u?xe.u:be.u,!1)}if(xe.d&&be.d&&xe.d.length!==be.d.length){const pe=be.d.length>xe.d.length?be:xe,_e=pe===be?xe:be;_e.d=pe.d.map((ze,Fe)=>Le(_e.d[Fe])?0:_e.d[Fe]),_e.s=Je(pe.s)}const ge=Oe(+se||Re,12),fe={parent:this,id:cs++,property:N,target:b,_value:null,_func:Cn.func,_ease:wo(W),_fromNumbers:Je(be.d),_toNumbers:Je(xe.d),_strings:Je(xe.s),_fromNumber:be.n,_toNumber:xe.n,_numbers:Je(be.d),_number:be.n,_unit:xe.u,_modifier:Se,_currentTime:0,_startTime:De,_delay:+ne,_updateDuration:ge,_changeDuration:ge,_absoluteStartTime:Ae,_tweenType:S,_valueType:xe.t,_composition:$,_isOverlapped:0,_isOverridden:0,_renderTransforms:0,_prevRep:null,_nextRep:null,_prevAdd:null,_nextAdd:null,_prev:null,_next:null};$!==$e.none&&ia(fe,q),isNaN(D)&&(D=fe._startTime),L=Oe(De+ge,12),F=fe,j++,It(this,fe)}(isNaN(X)||D<X)&&(X=D),(isNaN(C)||L>C)&&(C=L),S===Ne.TRANSFORM&&(T=j-Z,A=j)}if(!isNaN(T)){let E=0;We(this,S=>{E>=T&&E<A&&(S._renderTransforms=1,S._composition===$e.blend&&We(Nt.animation,N=>{N.id===S.id&&(N._renderTransforms=1)})),E++})}}a||console.warn("No target found. Make sure the element you're trying to animate is accessible before creating your animation."),X?(We(this,re=>{re._startTime-re._delay||(re._delay-=X),re._startTime-=X}),C-=X):X=0,C||(C=Re,this.iterationCount=0),this.targets=o,this.duration=C===Re?Re:En((C+this._loopDelay)*this.iterationCount-this._loopDelay)||Re,this.onRender=k||w.onRender,this._ease=x,this._delay=X,this.iterationDuration=C,this._inlineStyles=_,!this._autoplay&&ae&&this.onRender(this)}stretch(n){const f=this.duration;if(f===Gt(n))return this;const u=n/f;return We(this,t=>{t._updateDuration=Gt(Oe(t._updateDuration*u,12)),t._changeDuration=Gt(Oe(t._changeDuration*u,12)),t._currentTime*=u,t._startTime*=u,t._absoluteStartTime*=u}),super.stretch(n)}refresh(){return We(this,n=>{const f=tn(n.target,n.property,n._tweenType);ut(f,xt),n._fromNumbers=Je(xt.d),n._fromNumber=xt.n,n._func&&(ut(n._func(),xe),n._toNumbers=Je(xe.d),n._strings=Je(xe.s),n._toNumber=xe.n)}),this}revert(){return super.revert(),ua(this)}then(n){return super.then(n)}}const ko=(s,n)=>new hs(s,n,null,0,!1).init(),ps=["x","y","z"];[...ps,...Rr.filter(s=>["X","Y","Z"].some(n=>s.endsWith(n)))];ct&&(Le(CSS)||Object.hasOwnProperty.call(CSS,"registerProperty"));function vs(){var s=Object.create(null);function n(t,e){var r=t.id,i=t.name,o=t.dependencies;o===void 0&&(o=[]);var a=t.init;a===void 0&&(a=function(){});var l=t.getTransferables;if(l===void 0&&(l=null),!s[r])try{o=o.map(function(d){return d&&d.isWorkerModule&&(n(d,function(h){if(h instanceof Error)throw h}),d=s[d.id].value),d}),a=u("<"+i+">.init",a),l&&(l=u("<"+i+">.getTransferables",l));var c=null;typeof a=="function"?c=a.apply(void 0,o):console.error("worker module init function failed to rehydrate"),s[r]={id:r,value:c,getTransferables:l},e(c)}catch(d){d&&d.noLog||console.error(d),e(d)}}function f(t,e){var r,i=t.id,o=t.args;(!s[i]||typeof s[i].value!="function")&&e(new Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var a=(r=s[i]).value.apply(r,o);a&&typeof a.then=="function"?a.then(l,function(c){return e(c instanceof Error?c:new Error(""+c))}):l(a)}catch(c){e(c)}function l(c){try{var d=s[i].getTransferables&&s[i].getTransferables(c);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),e(c,d)}catch(h){console.error(h),e(h)}}}function u(t,e){var r=void 0;self.troikaDefine=function(o){return r=o};var i=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(i)}catch(o){console.error(o)}return URL.revokeObjectURL(i),delete self.troikaDefine,r}self.addEventListener("message",function(t){var e=t.data,r=e.messageId,i=e.action,o=e.data;try{i==="registerModule"&&n(o,function(a){a instanceof Error?postMessage({messageId:r,success:!1,error:a.message}):postMessage({messageId:r,success:!0,result:{isCallable:typeof a=="function"}})}),i==="callModule"&&f(o,function(a,l){a instanceof Error?postMessage({messageId:r,success:!1,error:a.message}):postMessage({messageId:r,success:!0,result:a},l||void 0)})}catch(a){postMessage({messageId:r,success:!1,error:a.stack})}})}function ms(s){var n=function(){for(var f=[],u=arguments.length;u--;)f[u]=arguments[u];return n._getInitResult().then(function(t){if(typeof t=="function")return t.apply(void 0,f);throw new Error("Worker module function was called but `init` did not return a callable function")})};return n._getInitResult=function(){var f=s.dependencies,u=s.init;f=Array.isArray(f)?f.map(function(e){return e&&(e=e.onMainThread||e,e._getInitResult&&(e=e._getInitResult())),e}):[];var t=Promise.all(f).then(function(e){return u.apply(null,e)});return n._getInitResult=function(){return t},t},n}var fa=function(){var s=!1;if(typeof window<"u"&&typeof window.document<"u")try{var n=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));n.terminate(),s=!0}catch(f){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+f.message+"]")}return fa=function(){return s},s},gs=0,_s=0,gr=!1,an=Object.create(null),sn=Object.create(null),Cr=Object.create(null);function jt(s){if((!s||typeof s.init!="function")&&!gr)throw new Error("requires `options.init` function");var n=s.dependencies,f=s.init,u=s.getTransferables,t=s.workerId,e=ms(s);t==null&&(t="#default");var r="workerModule"+ ++gs,i=s.name||r,o=null;n=n&&n.map(function(l){return typeof l=="function"&&!l.workerModuleData&&(gr=!0,l=jt({workerId:t,name:"<"+i+"> function dependency: "+l.name,init:`function(){return (
`+Pn(l)+`
)}`}),gr=!1),l&&l.workerModuleData&&(l=l.workerModuleData),l});function a(){for(var l=[],c=arguments.length;c--;)l[c]=arguments[c];if(!fa())return e.apply(void 0,l);if(!o){o=Do(t,"registerModule",a.workerModuleData);var d=function(){o=null,sn[t].delete(d)};(sn[t]||(sn[t]=new Set)).add(d)}return o.then(function(h){var v=h.isCallable;if(v)return Do(t,"callModule",{id:r,args:l});throw new Error("Worker module function was called but `init` did not return a callable function")})}return a.workerModuleData={isWorkerModule:!0,id:r,name:i,dependencies:n,init:Pn(f),getTransferables:u&&Pn(u)},a.onMainThread=e,a}function ys(s){sn[s]&&sn[s].forEach(function(n){n()}),an[s]&&(an[s].terminate(),delete an[s])}function Pn(s){var n=s.toString();return!/^function/.test(n)&&/^\w+\s*\(/.test(n)&&(n="function "+n),n}function bs(s){var n=an[s];if(!n){var f=Pn(vs);n=an[s]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+s.replace(/\*/g,"")+` **/

;(`+f+")()"],{type:"application/javascript"}))),n.onmessage=function(u){var t=u.data,e=t.messageId,r=Cr[e];if(!r)throw new Error("WorkerModule response with empty or unknown messageId");delete Cr[e],r(t)}}return n}function Do(s,n,f){return new Promise(function(u,t){var e=++_s;Cr[e]=function(r){r.success?u(r.result):t(new Error("Error in worker "+n+" call: "+r.error))},bs(s).postMessage({messageId:e,action:n,data:f})})}function ca(){var s=function(n){function f(b,R,p,T,A,E,S,N){var P=1-S;N.x=P*P*b+2*P*S*p+S*S*A,N.y=P*P*R+2*P*S*T+S*S*E}function u(b,R,p,T,A,E,S,N,P,z){var q=1-P;z.x=q*q*q*b+3*q*q*P*p+3*q*P*P*A+P*P*P*S,z.y=q*q*q*R+3*q*q*P*T+3*q*P*P*E+P*P*P*N}function t(b,R){for(var p=/([MLQCZ])([^MLQCZ]*)/g,T,A,E,S,N;T=p.exec(b);){var P=T[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(z){return parseFloat(z)});switch(T[1]){case"M":S=A=P[0],N=E=P[1];break;case"L":(P[0]!==S||P[1]!==N)&&R("L",S,N,S=P[0],N=P[1]);break;case"Q":{R("Q",S,N,S=P[2],N=P[3],P[0],P[1]);break}case"C":{R("C",S,N,S=P[4],N=P[5],P[0],P[1],P[2],P[3]);break}case"Z":(S!==A||N!==E)&&R("L",S,N,A,E);break}}}function e(b,R,p){p===void 0&&(p=16);var T={x:0,y:0};t(b,function(A,E,S,N,P,z,q,F,D){switch(A){case"L":R(E,S,N,P);break;case"Q":{for(var L=E,Z=S,K=1;K<p;K++)f(E,S,z,q,N,P,K/(p-1),T),R(L,Z,T.x,T.y),L=T.x,Z=T.y;break}case"C":{for(var Y=E,J=S,Q=1;Q<p;Q++)u(E,S,z,q,F,D,N,P,Q/(p-1),T),R(Y,J,T.x,T.y),Y=T.x,J=T.y;break}}})}var r="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",i="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",o=new WeakMap,a={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function l(b,R){var p=b.getContext?b.getContext("webgl",a):b,T=o.get(p);if(!T){let q=function(Y){var J=E[Y];if(!J&&(J=E[Y]=p.getExtension(Y),!J))throw new Error(Y+" not supported");return J},F=function(Y,J){var Q=p.createShader(J);return p.shaderSource(Q,Y),p.compileShader(Q),Q},D=function(Y,J,Q,H){if(!S[Y]){var oe={},te={},W=p.createProgram();p.attachShader(W,F(J,p.VERTEX_SHADER)),p.attachShader(W,F(Q,p.FRAGMENT_SHADER)),p.linkProgram(W),S[Y]={program:W,transaction:function(ne){p.useProgram(W),ne({setUniform:function($,Se){for(var le=[],ue=arguments.length-2;ue-- >0;)le[ue]=arguments[ue+2];var ce=te[Se]||(te[Se]=p.getUniformLocation(W,Se));p["uniform"+$].apply(p,[ce].concat(le))},setAttribute:function($,Se,le,ue,ce){var me=oe[$];me||(me=oe[$]={buf:p.createBuffer(),loc:p.getAttribLocation(W,$),data:null}),p.bindBuffer(p.ARRAY_BUFFER,me.buf),p.vertexAttribPointer(me.loc,Se,p.FLOAT,!1,0,0),p.enableVertexAttribArray(me.loc),A?p.vertexAttribDivisor(me.loc,ue):q("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(me.loc,ue),ce!==me.data&&(p.bufferData(p.ARRAY_BUFFER,ce,le),me.data=ce)}})}}}S[Y].transaction(H)},L=function(Y,J){P++;try{p.activeTexture(p.TEXTURE0+P);var Q=N[Y];Q||(Q=N[Y]=p.createTexture(),p.bindTexture(p.TEXTURE_2D,Q),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST)),p.bindTexture(p.TEXTURE_2D,Q),J(Q,P)}finally{P--}},Z=function(Y,J,Q){var H=p.createFramebuffer();z.push(H),p.bindFramebuffer(p.FRAMEBUFFER,H),p.activeTexture(p.TEXTURE0+J),p.bindTexture(p.TEXTURE_2D,Y),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,Y,0);try{Q(H)}finally{p.deleteFramebuffer(H),p.bindFramebuffer(p.FRAMEBUFFER,z[--z.length-1]||null)}},K=function(){E={},S={},N={},P=-1,z.length=0};var A=typeof WebGL2RenderingContext<"u"&&p instanceof WebGL2RenderingContext,E={},S={},N={},P=-1,z=[];p.canvas.addEventListener("webglcontextlost",function(Y){K(),Y.preventDefault()},!1),o.set(p,T={gl:p,isWebGL2:A,getExtension:q,withProgram:D,withTexture:L,withTextureFramebuffer:Z,handleContextLoss:K})}R(T)}function c(b,R,p,T,A,E,S,N){S===void 0&&(S=15),N===void 0&&(N=null),l(b,function(P){var z=P.gl,q=P.withProgram,F=P.withTexture;F("copy",function(D,L){z.texImage2D(z.TEXTURE_2D,0,z.RGBA,A,E,0,z.RGBA,z.UNSIGNED_BYTE,R),q("copy",r,i,function(Z){var K=Z.setUniform,Y=Z.setAttribute;Y("aUV",2,z.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),K("1i","image",L),z.bindFramebuffer(z.FRAMEBUFFER,N||null),z.disable(z.BLEND),z.colorMask(S&8,S&4,S&2,S&1),z.viewport(p,T,A,E),z.scissor(p,T,A,E),z.drawArrays(z.TRIANGLES,0,3)})})})}function d(b,R,p){var T=b.width,A=b.height;l(b,function(E){var S=E.gl,N=new Uint8Array(T*A*4);S.readPixels(0,0,T,A,S.RGBA,S.UNSIGNED_BYTE,N),b.width=R,b.height=p,c(S,N,0,0,T,A)})}var h=Object.freeze({__proto__:null,withWebGLContext:l,renderImageData:c,resizeWebGLCanvasWithoutClearing:d});function v(b,R,p,T,A,E){E===void 0&&(E=1);var S=new Uint8Array(b*R),N=T[2]-T[0],P=T[3]-T[1],z=[];e(p,function(Y,J,Q,H){z.push({x1:Y,y1:J,x2:Q,y2:H,minX:Math.min(Y,Q),minY:Math.min(J,H),maxX:Math.max(Y,Q),maxY:Math.max(J,H)})}),z.sort(function(Y,J){return Y.maxX-J.maxX});for(var q=0;q<b;q++)for(var F=0;F<R;F++){var D=Z(T[0]+N*(q+.5)/b,T[1]+P*(F+.5)/R),L=Math.pow(1-Math.abs(D)/A,E)/2;D<0&&(L=1-L),L=Math.max(0,Math.min(255,Math.round(L*255))),S[F*b+q]=L}return S;function Z(Y,J){for(var Q=1/0,H=1/0,oe=z.length;oe--;){var te=z[oe];if(te.maxX+H<=Y)break;if(Y+H>te.minX&&J-H<te.maxY&&J+H>te.minY){var W=I(Y,J,te.x1,te.y1,te.x2,te.y2);W<Q&&(Q=W,H=Math.sqrt(Q))}}return K(Y,J)&&(H=-H),H}function K(Y,J){for(var Q=0,H=z.length;H--;){var oe=z[H];if(oe.maxX<=Y)break;var te=oe.y1>J!=oe.y2>J&&Y<(oe.x2-oe.x1)*(J-oe.y1)/(oe.y2-oe.y1)+oe.x1;te&&(Q+=oe.y1<oe.y2?1:-1)}return Q!==0}}function m(b,R,p,T,A,E,S,N,P,z){E===void 0&&(E=1),N===void 0&&(N=0),P===void 0&&(P=0),z===void 0&&(z=0),g(b,R,p,T,A,E,S,null,N,P,z)}function g(b,R,p,T,A,E,S,N,P,z,q){E===void 0&&(E=1),P===void 0&&(P=0),z===void 0&&(z=0),q===void 0&&(q=0);for(var F=v(b,R,p,T,A,E),D=new Uint8Array(F.length*4),L=0;L<F.length;L++)D[L*4+q]=F[L];c(S,D,P,z,b,R,1<<3-q,N)}function I(b,R,p,T,A,E){var S=A-p,N=E-T,P=S*S+N*N,z=P?Math.max(0,Math.min(1,((b-p)*S+(R-T)*N)/P)):0,q=b-(p+z*S),F=R-(T+z*N);return q*q+F*F}var k=Object.freeze({__proto__:null,generate:v,generateIntoCanvas:m,generateIntoFramebuffer:g}),w="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",y="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",x="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",O=new Float32Array([0,0,2,0,0,2]),U=null,M=!1,V={},G=new WeakMap;function ee(b){if(!M&&!X(b))throw new Error("WebGL generation not supported")}function _(b,R,p,T,A,E,S){if(E===void 0&&(E=1),S===void 0&&(S=null),!S&&(S=U,!S)){var N=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!N)throw new Error("OffscreenCanvas or DOM canvas not supported");S=U=N.getContext("webgl",{depth:!1})}ee(S);var P=new Uint8Array(b*R*4);l(S,function(D){var L=D.gl,Z=D.withTexture,K=D.withTextureFramebuffer;Z("readable",function(Y,J){L.texImage2D(L.TEXTURE_2D,0,L.RGBA,b,R,0,L.RGBA,L.UNSIGNED_BYTE,null),K(Y,J,function(Q){C(b,R,p,T,A,E,L,Q,0,0,0),L.readPixels(0,0,b,R,L.RGBA,L.UNSIGNED_BYTE,P)})})});for(var z=new Uint8Array(b*R),q=0,F=0;q<P.length;q+=4)z[F++]=P[q];return z}function B(b,R,p,T,A,E,S,N,P,z){E===void 0&&(E=1),N===void 0&&(N=0),P===void 0&&(P=0),z===void 0&&(z=0),C(b,R,p,T,A,E,S,null,N,P,z)}function C(b,R,p,T,A,E,S,N,P,z,q){E===void 0&&(E=1),P===void 0&&(P=0),z===void 0&&(z=0),q===void 0&&(q=0),ee(S);var F=[];e(p,function(D,L,Z,K){F.push(D,L,Z,K)}),F=new Float32Array(F),l(S,function(D){var L=D.gl,Z=D.isWebGL2,K=D.getExtension,Y=D.withProgram,J=D.withTexture,Q=D.withTextureFramebuffer,H=D.handleContextLoss;if(J("rawDistances",function(oe,te){(b!==oe._lastWidth||R!==oe._lastHeight)&&L.texImage2D(L.TEXTURE_2D,0,L.RGBA,oe._lastWidth=b,oe._lastHeight=R,0,L.RGBA,L.UNSIGNED_BYTE,null),Y("main",w,y,function(W){var se=W.setAttribute,ne=W.setUniform,ie=!Z&&K("ANGLE_instanced_arrays"),$=!Z&&K("EXT_blend_minmax");se("aUV",2,L.STATIC_DRAW,0,O),se("aLineSegment",4,L.DYNAMIC_DRAW,1,F),ne.apply(void 0,["4f","uGlyphBounds"].concat(T)),ne("1f","uMaxDistance",A),ne("1f","uExponent",E),Q(oe,te,function(Se){L.enable(L.BLEND),L.colorMask(!0,!0,!0,!0),L.viewport(0,0,b,R),L.scissor(0,0,b,R),L.blendFunc(L.ONE,L.ONE),L.blendEquationSeparate(L.FUNC_ADD,Z?L.MAX:$.MAX_EXT),L.clear(L.COLOR_BUFFER_BIT),Z?L.drawArraysInstanced(L.TRIANGLES,0,3,F.length/4):ie.drawArraysInstancedANGLE(L.TRIANGLES,0,3,F.length/4)})}),Y("post",r,x,function(W){W.setAttribute("aUV",2,L.STATIC_DRAW,0,O),W.setUniform("1i","tex",te),L.bindFramebuffer(L.FRAMEBUFFER,N),L.disable(L.BLEND),L.colorMask(q===0,q===1,q===2,q===3),L.viewport(P,z,b,R),L.scissor(P,z,b,R),L.drawArrays(L.TRIANGLES,0,3)})}),L.isContextLost())throw H(),new Error("webgl context lost")})}function X(b){var R=!b||b===U?V:b.canvas||b,p=G.get(R);if(p===void 0){M=!0;var T=null;try{var A=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],E=_(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,b);p=E&&A.length===E.length&&E.every(function(S,N){return S===A[N]}),p||(T="bad trial run results",console.info(A,E))}catch(S){p=!1,T=S.message}T&&console.warn("WebGL SDF generation not supported:",T),M=!1,G.set(R,p)}return p}var j=Object.freeze({__proto__:null,generate:_,generateIntoCanvas:B,generateIntoFramebuffer:C,isSupported:X});function ae(b,R,p,T,A,E){A===void 0&&(A=Math.max(T[2]-T[0],T[3]-T[1])/2),E===void 0&&(E=1);try{return _.apply(j,arguments)}catch(S){return console.info("WebGL SDF generation failed, falling back to JS",S),v.apply(k,arguments)}}function re(b,R,p,T,A,E,S,N,P,z){A===void 0&&(A=Math.max(T[2]-T[0],T[3]-T[1])/2),E===void 0&&(E=1),N===void 0&&(N=0),P===void 0&&(P=0),z===void 0&&(z=0);try{return B.apply(j,arguments)}catch(q){return console.info("WebGL SDF generation failed, falling back to JS",q),m.apply(k,arguments)}}return n.forEachPathCommand=t,n.generate=ae,n.generateIntoCanvas=re,n.javascript=k,n.pathToLineSegments=e,n.webgl=j,n.webglUtils=h,Object.defineProperty(n,"__esModule",{value:!0}),n}({});return s}function Ts(){var s=function(n){var f={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},u={},t={};u.L=1,t[1]="L",Object.keys(f).forEach(function(H,oe){u[H]=1<<oe+1,t[u[H]]=H}),Object.freeze(u);var e=u.LRI|u.RLI|u.FSI,r=u.L|u.R|u.AL,i=u.B|u.S|u.WS|u.ON|u.FSI|u.LRI|u.RLI|u.PDI,o=u.BN|u.RLE|u.LRE|u.RLO|u.LRO|u.PDF,a=u.S|u.WS|u.B|e|u.PDI|o,l=null;function c(){if(!l){l=new Map;var H=function(te){if(f.hasOwnProperty(te)){var W=0;f[te].split(",").forEach(function(se){var ne=se.split("+"),ie=ne[0],$=ne[1];ie=parseInt(ie,36),$=$?parseInt($,36):0,l.set(W+=ie,u[te]);for(var Se=0;Se<$;Se++)l.set(++W,u[te])})}};for(var oe in f)H(oe)}}function d(H){return c(),l.get(H.codePointAt(0))||u.L}function h(H){return t[d(H)]}var v={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function m(H,oe){var te=36,W=0,se=new Map,ne=oe&&new Map,ie;return H.split(",").forEach(function $(Se){if(Se.indexOf("+")!==-1)for(var le=+Se;le--;)$(ie);else{ie=Se;var ue=Se.split(">"),ce=ue[0],me=ue[1];ce=String.fromCodePoint(W+=parseInt(ce,te)),me=String.fromCodePoint(W+=parseInt(me,te)),se.set(ce,me),oe&&ne.set(me,ce)}}),{map:se,reverseMap:ne}}var g,I,k;function w(){if(!g){var H=m(v.pairs,!0),oe=H.map,te=H.reverseMap;g=oe,I=te,k=m(v.canonical,!1).map}}function y(H){return w(),g.get(H)||null}function x(H){return w(),I.get(H)||null}function O(H){return w(),k.get(H)||null}var U=u.L,M=u.R,V=u.EN,G=u.ES,ee=u.ET,_=u.AN,B=u.CS,C=u.B,X=u.S,j=u.ON,ae=u.BN,re=u.NSM,b=u.AL,R=u.LRO,p=u.RLO,T=u.LRE,A=u.RLE,E=u.PDF,S=u.LRI,N=u.RLI,P=u.FSI,z=u.PDI;function q(H,oe){for(var te=125,W=new Uint32Array(H.length),se=0;se<H.length;se++)W[se]=d(H[se]);var ne=new Map;function ie(qe,it){var Qe=W[qe];W[qe]=it,ne.set(Qe,ne.get(Qe)-1),Qe&i&&ne.set(i,ne.get(i)-1),ne.set(it,(ne.get(it)||0)+1),it&i&&ne.set(i,(ne.get(i)||0)+1)}for(var $=new Uint8Array(H.length),Se=new Map,le=[],ue=null,ce=0;ce<H.length;ce++)ue||le.push(ue={start:ce,end:H.length-1,level:oe==="rtl"?1:oe==="ltr"?0:ao(ce,!1)}),W[ce]&C&&(ue.end=ce,ue=null);for(var me=A|T|p|R|e|z|E|C,De=function(qe){return qe+(qe&1?1:2)},Ae=function(qe){return qe+(qe&1?2:1)},he=0;he<le.length;he++){ue=le[he];var ge=[{_level:ue.level,_override:0,_isolate:0}],fe=void 0,pe=0,_e=0,ze=0;ne.clear();for(var Fe=ue.start;Fe<=ue.end;Fe++){var ve=W[Fe];if(fe=ge[ge.length-1],ne.set(ve,(ne.get(ve)||0)+1),ve&i&&ne.set(i,(ne.get(i)||0)+1),ve&me)if(ve&(A|T)){$[Fe]=fe._level;var Ue=(ve===A?Ae:De)(fe._level);Ue<=te&&!pe&&!_e?ge.push({_level:Ue,_override:0,_isolate:0}):pe||_e++}else if(ve&(p|R)){$[Fe]=fe._level;var rt=(ve===p?Ae:De)(fe._level);rt<=te&&!pe&&!_e?ge.push({_level:rt,_override:ve&p?M:U,_isolate:0}):pe||_e++}else if(ve&e){ve&P&&(ve=ao(Fe+1,!0)===1?N:S),$[Fe]=fe._level,fe._override&&ie(Fe,fe._override);var Ce=(ve===N?Ae:De)(fe._level);Ce<=te&&pe===0&&_e===0?(ze++,ge.push({_level:Ce,_override:0,_isolate:1,_isolInitIndex:Fe})):pe++}else if(ve&z){if(pe>0)pe--;else if(ze>0){for(_e=0;!ge[ge.length-1]._isolate;)ge.pop();var Te=ge[ge.length-1]._isolInitIndex;Te!=null&&(Se.set(Te,Fe),Se.set(Fe,Te)),ge.pop(),ze--}fe=ge[ge.length-1],$[Fe]=fe._level,fe._override&&ie(Fe,fe._override)}else ve&E?(pe===0&&(_e>0?_e--:!fe._isolate&&ge.length>1&&(ge.pop(),fe=ge[ge.length-1])),$[Fe]=fe._level):ve&C&&($[Fe]=ue.level);else $[Fe]=fe._level,fe._override&&ve!==ae&&ie(Fe,fe._override)}for(var Ie=[],Me=null,ye=ue.start;ye<=ue.end;ye++){var Ee=W[ye];if(!(Ee&o)){var we=$[ye],Be=Ee&e,Pe=Ee===z;Me&&we===Me._level?(Me._end=ye,Me._endsWithIsolInit=Be):Ie.push(Me={_start:ye,_end:ye,_level:we,_startsWithPDI:Pe,_endsWithIsolInit:Be})}}for(var Ge=[],ot=0;ot<Ie.length;ot++){var dt=Ie[ot];if(!dt._startsWithPDI||dt._startsWithPDI&&!Se.has(dt._start)){for(var pt=[Me=dt],bt=void 0;Me&&Me._endsWithIsolInit&&(bt=Se.get(Me._end))!=null;)for(var ht=ot+1;ht<Ie.length;ht++)if(Ie[ht]._start===bt){pt.push(Me=Ie[ht]);break}for(var Ke=[],Tt=0;Tt<pt.length;Tt++)for(var Gr=pt[Tt],Xn=Gr._start;Xn<=Gr._end;Xn++)Ke.push(Xn);for(var Ta=$[Ke[0]],Nr=ue.level,cn=Ke[0]-1;cn>=0;cn--)if(!(W[cn]&o)){Nr=$[cn];break}var Hn=Ke[Ke.length-1],Sa=$[Hn],Wr=ue.level;if(!(W[Hn]&e)){for(var dn=Hn+1;dn<=ue.end;dn++)if(!(W[dn]&o)){Wr=$[dn];break}}Ge.push({_seqIndices:Ke,_sosType:Math.max(Nr,Ta)%2?M:U,_eosType:Math.max(Wr,Sa)%2?M:U})}}for(var Yn=0;Yn<Ge.length;Yn++){var Kn=Ge[Yn],de=Kn._seqIndices,Xt=Kn._sosType,xa=Kn._eosType,Dt=$[de[0]]&1?M:U;if(ne.get(re))for(var hn=0;hn<de.length;hn++){var zr=de[hn];if(W[zr]&re){for(var Jn=Xt,pn=hn-1;pn>=0;pn--)if(!(W[de[pn]]&o)){Jn=W[de[pn]];break}ie(zr,Jn&(e|z)?j:Jn)}}if(ne.get(V))for(var vn=0;vn<de.length;vn++){var Vr=de[vn];if(W[Vr]&V)for(var mn=vn-1;mn>=-1;mn--){var jr=mn===-1?Xt:W[de[mn]];if(jr&r){jr===b&&ie(Vr,_);break}}}if(ne.get(b))for(var Zn=0;Zn<de.length;Zn++){var Xr=de[Zn];W[Xr]&b&&ie(Xr,M)}if(ne.get(G)||ne.get(B))for(var Ht=1;Ht<de.length-1;Ht++){var qn=de[Ht];if(W[qn]&(G|B)){for(var At=0,Qn=0,$n=Ht-1;$n>=0&&(At=W[de[$n]],!!(At&o));$n--);for(var er=Ht+1;er<de.length&&(Qn=W[de[er]],!!(Qn&o));er++);At===Qn&&(W[qn]===G?At===V:At&(V|_))&&ie(qn,At)}}if(ne.get(V))for(var st=0;st<de.length;st++){var wa=de[st];if(W[wa]&V){for(var gn=st-1;gn>=0&&W[de[gn]]&(ee|o);gn--)ie(de[gn],V);for(st++;st<de.length&&W[de[st]]&(ee|o|V);st++)W[de[st]]!==V&&ie(de[st],V)}}if(ne.get(ee)||ne.get(G)||ne.get(B))for(var Yt=0;Yt<de.length;Yt++){var Hr=de[Yt];if(W[Hr]&(ee|G|B)){ie(Hr,j);for(var _n=Yt-1;_n>=0&&W[de[_n]]&o;_n--)ie(de[_n],j);for(var yn=Yt+1;yn<de.length&&W[de[yn]]&o;yn++)ie(de[yn],j)}}if(ne.get(V))for(var tr=0,Yr=Xt;tr<de.length;tr++){var Kr=de[tr],nr=W[Kr];nr&V?Yr===U&&ie(Kr,U):nr&r&&(Yr=nr)}if(ne.get(i)){var Kt=M|V|_,Jr=Kt|U,bn=[];{for(var Ft=[],Mt=0;Mt<de.length;Mt++)if(W[de[Mt]]&i){var Jt=H[de[Mt]],Zr=void 0;if(y(Jt)!==null)if(Ft.length<63)Ft.push({char:Jt,seqIndex:Mt});else break;else if((Zr=x(Jt))!==null)for(var Zt=Ft.length-1;Zt>=0;Zt--){var rr=Ft[Zt].char;if(rr===Zr||rr===x(O(Jt))||y(O(rr))===Jt){bn.push([Ft[Zt].seqIndex,Mt]),Ft.length=Zt;break}}}bn.sort(function(qe,it){return qe[0]-it[0]})}for(var or=0;or<bn.length;or++){for(var qr=bn[or],Tn=qr[0],ar=qr[1],Qr=!1,at=0,ir=Tn+1;ir<ar;ir++){var $r=de[ir];if(W[$r]&Jr){Qr=!0;var eo=W[$r]&Kt?M:U;if(eo===Dt){at=eo;break}}}if(Qr&&!at){at=Xt;for(var sr=Tn-1;sr>=0;sr--){var to=de[sr];if(W[to]&Jr){var no=W[to]&Kt?M:U;no!==Dt?at=no:at=Dt;break}}}if(at){if(W[de[Tn]]=W[de[ar]]=at,at!==Dt){for(var qt=Tn+1;qt<de.length;qt++)if(!(W[de[qt]]&o)){d(H[de[qt]])&re&&(W[de[qt]]=at);break}}if(at!==Dt){for(var Qt=ar+1;Qt<de.length;Qt++)if(!(W[de[Qt]]&o)){d(H[de[Qt]])&re&&(W[de[Qt]]=at);break}}}}for(var vt=0;vt<de.length;vt++)if(W[de[vt]]&i){for(var ro=vt,lr=vt,ur=Xt,$t=vt-1;$t>=0;$t--)if(W[de[$t]]&o)ro=$t;else{ur=W[de[$t]]&Kt?M:U;break}for(var oo=xa,en=vt+1;en<de.length;en++)if(W[de[en]]&(i|o))lr=en;else{oo=W[de[en]]&Kt?M:U;break}for(var fr=ro;fr<=lr;fr++)W[de[fr]]=ur===oo?ur:Dt;vt=lr}}}for(var et=ue.start;et<=ue.end;et++){var Ua=$[et],Sn=W[et];if(Ua&1?Sn&(U|V|_)&&$[et]++:Sn&M?$[et]++:Sn&(_|V)&&($[et]+=2),Sn&o&&($[et]=et===0?ue.level:$[et-1]),et===ue.end||d(H[et])&(X|C))for(var xn=et;xn>=0&&d(H[xn])&a;xn--)$[xn]=ue.level}}return{levels:$,paragraphs:le};function ao(qe,it){for(var Qe=qe;Qe<H.length;Qe++){var mt=W[Qe];if(mt&(M|b))return 1;if(mt&(C|U)||it&&mt===z)return 0;if(mt&e){var io=Ca(Qe);Qe=io===-1?H.length:io}}return 0}function Ca(qe){for(var it=1,Qe=qe+1;Qe<H.length;Qe++){var mt=W[Qe];if(mt&C)break;if(mt&z){if(--it===0)return Qe}else mt&e&&it++}return-1}}var F="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",D;function L(){if(!D){var H=m(F,!0),oe=H.map,te=H.reverseMap;te.forEach(function(W,se){oe.set(se,W)}),D=oe}}function Z(H){return L(),D.get(H)||null}function K(H,oe,te,W){var se=H.length;te=Math.max(0,te==null?0:+te),W=Math.min(se-1,W==null?se-1:+W);for(var ne=new Map,ie=te;ie<=W;ie++)if(oe[ie]&1){var $=Z(H[ie]);$!==null&&ne.set(ie,$)}return ne}function Y(H,oe,te,W){var se=H.length;te=Math.max(0,te==null?0:+te),W=Math.min(se-1,W==null?se-1:+W);var ne=[];return oe.paragraphs.forEach(function(ie){var $=Math.max(te,ie.start),Se=Math.min(W,ie.end);if($<Se){for(var le=oe.levels.slice($,Se+1),ue=Se;ue>=$&&d(H[ue])&a;ue--)le[ue]=ie.level;for(var ce=ie.level,me=1/0,De=0;De<le.length;De++){var Ae=le[De];Ae>ce&&(ce=Ae),Ae<me&&(me=Ae|1)}for(var he=ce;he>=me;he--)for(var ge=0;ge<le.length;ge++)if(le[ge]>=he){for(var fe=ge;ge+1<le.length&&le[ge+1]>=he;)ge++;ge>fe&&ne.push([fe+$,ge+$])}}}),ne}function J(H,oe,te,W){var se=Q(H,oe,te,W),ne=[].concat(H);return se.forEach(function(ie,$){ne[$]=(oe.levels[ie]&1?Z(H[ie]):null)||H[ie]}),ne.join("")}function Q(H,oe,te,W){for(var se=Y(H,oe,te,W),ne=[],ie=0;ie<H.length;ie++)ne[ie]=ie;return se.forEach(function($){for(var Se=$[0],le=$[1],ue=ne.slice(Se,le+1),ce=ue.length;ce--;)ne[le-ce]=ue[ce]}),ne}return n.closingToOpeningBracket=x,n.getBidiCharType=d,n.getBidiCharTypeName=h,n.getCanonicalBracket=O,n.getEmbeddingLevels=q,n.getMirroredCharacter=Z,n.getMirroredCharactersMap=K,n.getReorderSegments=Y,n.getReorderedIndices=Q,n.getReorderedString=J,n.openingToClosingBracket=y,Object.defineProperty(n,"__esModule",{value:!0}),n}({});return s}const da=/\bvoid\s+main\s*\(\s*\)\s*{/g;function kr(s){const n=/^[ \t]*#include +<([\w\d./]+)>/gm;function f(u,t){let e=za[t];return e?kr(e):u}return s.replace(n,f)}const Ve=[];for(let s=0;s<256;s++)Ve[s]=(s<16?"0":"")+s.toString(16);function Ss(){const s=Math.random()*4294967295|0,n=Math.random()*4294967295|0,f=Math.random()*4294967295|0,u=Math.random()*4294967295|0;return(Ve[s&255]+Ve[s>>8&255]+Ve[s>>16&255]+Ve[s>>24&255]+"-"+Ve[n&255]+Ve[n>>8&255]+"-"+Ve[n>>16&15|64]+Ve[n>>24&255]+"-"+Ve[f&63|128]+Ve[f>>8&255]+"-"+Ve[f>>16&255]+Ve[f>>24&255]+Ve[u&255]+Ve[u>>8&255]+Ve[u>>16&255]+Ve[u>>24&255]).toUpperCase()}const wt=Object.assign||function(){let s=arguments[0];for(let n=1,f=arguments.length;n<f;n++){let u=arguments[n];if(u)for(let t in u)Object.prototype.hasOwnProperty.call(u,t)&&(s[t]=u[t])}return s},xs=Date.now(),Ao=new WeakMap,Fo=new Map;let ws=1e10;function Dr(s,n){const f=Ds(n);let u=Ao.get(s);if(u||Ao.set(s,u=Object.create(null)),u[f])return new u[f];const t=`_onBeforeCompile${f}`,e=function(a,l){s.onBeforeCompile.call(this,a,l);const c=this.customProgramCacheKey()+"|"+a.vertexShader+"|"+a.fragmentShader;let d=Fo[c];if(!d){const h=Us(this,a,n,f);d=Fo[c]=h}a.vertexShader=d.vertexShader,a.fragmentShader=d.fragmentShader,wt(a.uniforms,this.uniforms),n.timeUniform&&(a.uniforms[n.timeUniform]={get value(){return Date.now()-xs}}),this[t]&&this[t](a)},r=function(){return i(n.chained?s:s.clone())},i=function(a){const l=Object.create(a,o);return Object.defineProperty(l,"baseMaterial",{value:s}),Object.defineProperty(l,"id",{value:ws++}),l.uuid=Ss(),l.uniforms=wt({},a.uniforms,n.uniforms),l.defines=wt({},a.defines,n.defines),l.defines[`TROIKA_DERIVED_MATERIAL_${f}`]="",l.extensions=wt({},a.extensions,n.extensions),l._listeners=void 0,l},o={constructor:{value:r},isDerivedMaterial:{value:!0},type:{get:()=>s.type,set:a=>{s.type=a}},isDerivedFrom:{writable:!0,configurable:!0,value:function(a){const l=this.baseMaterial;return a===l||l.isDerivedMaterial&&l.isDerivedFrom(a)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return s.customProgramCacheKey()+"|"+f}},onBeforeCompile:{get(){return e},set(a){this[t]=a}},copy:{writable:!0,configurable:!0,value:function(a){return s.copy.call(this,a),!s.isShaderMaterial&&!s.isDerivedMaterial&&(wt(this.extensions,a.extensions),wt(this.defines,a.defines),wt(this.uniforms,Ba.clone(a.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const a=new s.constructor;return i(a).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let a=this._depthMaterial;return a||(a=this._depthMaterial=Dr(s.isDerivedMaterial?s.getDepthMaterial():new Ga({depthPacking:Na}),n),a.defines.IS_DEPTH_MATERIAL="",a.uniforms=this.uniforms),a}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let a=this._distanceMaterial;return a||(a=this._distanceMaterial=Dr(s.isDerivedMaterial?s.getDistanceMaterial():new Wa,n),a.defines.IS_DISTANCE_MATERIAL="",a.uniforms=this.uniforms),a}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:a,_distanceMaterial:l}=this;a&&a.dispose(),l&&l.dispose(),s.dispose.call(this)}}};return u[f]=r,new r}function Us(s,{vertexShader:n,fragmentShader:f},u,t){let{vertexDefs:e,vertexMainIntro:r,vertexMainOutro:i,vertexTransform:o,fragmentDefs:a,fragmentMainIntro:l,fragmentMainOutro:c,fragmentColorTransform:d,customRewriter:h,timeUniform:v}=u;if(e=e||"",r=r||"",i=i||"",a=a||"",l=l||"",c=c||"",(o||h)&&(n=kr(n)),(d||h)&&(f=f.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),f=kr(f)),h){let m=h({vertexShader:n,fragmentShader:f});n=m.vertexShader,f=m.fragmentShader}if(d){let m=[];f=f.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,g=>(m.push(g),"")),c=`${d}
${m.join(`
`)}
${c}`}if(v){const m=`
uniform float ${v};
`;e=m+e,a=m+a}return o&&(n=`vec3 troika_position_${t};
vec3 troika_normal_${t};
vec2 troika_uv_${t};
${n}
`,e=`${e}
void troikaVertexTransform${t}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${o}
}
`,r=`
troika_position_${t} = vec3(position);
troika_normal_${t} = vec3(normal);
troika_uv_${t} = vec2(uv);
troikaVertexTransform${t}(troika_position_${t}, troika_normal_${t}, troika_uv_${t});
${r}
`,n=n.replace(/\b(position|normal|uv)\b/g,(m,g,I,k)=>/\battribute\s+vec[23]\s+$/.test(k.substr(0,I))?g:`troika_${g}_${t}`),s.map&&s.map.channel>0||(n=n.replace(/\bMAP_UV\b/g,`troika_uv_${t}`))),n=Mo(n,t,e,r,i),f=Mo(f,t,a,l,c),{vertexShader:n,fragmentShader:f}}function Mo(s,n,f,u,t){return(u||t||f)&&(s=s.replace(da,`
${f}
void troikaOrigMain${n}() {`),s+=`
void main() {
  ${u}
  troikaOrigMain${n}();
  ${t}
}`),s}function Cs(s,n){return s==="uniforms"?void 0:typeof n=="function"?n.toString():n}let ks=0;const Eo=new Map;function Ds(s){const n=JSON.stringify(s,Cs);let f=Eo.get(n);return f==null&&Eo.set(n,f=++ks),f}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function As(){return typeof window>"u"&&(self.window=self),function(s){var n={parse:function(t){var e=n._bin,r=new Uint8Array(t);if(e.readASCII(r,0,4)=="ttcf"){var i=4;e.readUshort(r,i),i+=2,e.readUshort(r,i),i+=2;var o=e.readUint(r,i);i+=4;for(var a=[],l=0;l<o;l++){var c=e.readUint(r,i);i+=4,a.push(n._readFont(r,c))}return a}return[n._readFont(r,0)]},_readFont:function(t,e){var r=n._bin,i=e;r.readFixed(t,e),e+=4;var o=r.readUshort(t,e);e+=2,r.readUshort(t,e),e+=2,r.readUshort(t,e),e+=2,r.readUshort(t,e),e+=2;for(var a=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],l={_data:t,_offset:i},c={},d=0;d<o;d++){var h=r.readASCII(t,e,4);e+=4,r.readUint(t,e),e+=4;var v=r.readUint(t,e);e+=4;var m=r.readUint(t,e);e+=4,c[h]={offset:v,length:m}}for(d=0;d<a.length;d++){var g=a[d];c[g]&&(l[g.trim()]=n[g.trim()].parse(t,c[g].offset,c[g].length,l))}return l},_tabOffset:function(t,e,r){for(var i=n._bin,o=i.readUshort(t,r+4),a=r+12,l=0;l<o;l++){var c=i.readASCII(t,a,4);a+=4,i.readUint(t,a),a+=4;var d=i.readUint(t,a);if(a+=4,i.readUint(t,a),a+=4,c==e)return d}return 0}};n._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return n._bin.readShort(t,e)/16384},readInt:function(t,e){return n._bin._view(t).getInt32(e)},readInt8:function(t,e){return n._bin._view(t).getInt8(e)},readShort:function(t,e){return n._bin._view(t).getInt16(e)},readUshort:function(t,e){return n._bin._view(t).getUint16(e)},readUshorts:function(t,e,r){for(var i=[],o=0;o<r;o++)i.push(n._bin.readUshort(t,e+2*o));return i},readUint:function(t,e){return n._bin._view(t).getUint32(e)},readUint64:function(t,e){return 4294967296*n._bin.readUint(t,e)+n._bin.readUint(t,e+4)},readASCII:function(t,e,r){for(var i="",o=0;o<r;o++)i+=String.fromCharCode(t[e+o]);return i},readUnicode:function(t,e,r){for(var i="",o=0;o<r;o++){var a=t[e++]<<8|t[e++];i+=String.fromCharCode(a)}return i},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,r){var i=n._bin._tdec;return i&&e==0&&r==t.length?i.decode(t):n._bin.readASCII(t,e,r)},readBytes:function(t,e,r){for(var i=[],o=0;o<r;o++)i.push(t[e+o]);return i},readASCIIArray:function(t,e,r){for(var i=[],o=0;o<r;o++)i.push(String.fromCharCode(t[e+o]));return i},_view:function(t){return t._dataView||(t._dataView=t.buffer?new DataView(t.buffer,t.byteOffset,t.byteLength):new DataView(new Uint8Array(t).buffer))}},n._lctf={},n._lctf.parse=function(t,e,r,i,o){var a=n._bin,l={},c=e;a.readFixed(t,e),e+=4;var d=a.readUshort(t,e);e+=2;var h=a.readUshort(t,e);e+=2;var v=a.readUshort(t,e);return e+=2,l.scriptList=n._lctf.readScriptList(t,c+d),l.featureList=n._lctf.readFeatureList(t,c+h),l.lookupList=n._lctf.readLookupList(t,c+v,o),l},n._lctf.readLookupList=function(t,e,r){var i=n._bin,o=e,a=[],l=i.readUshort(t,e);e+=2;for(var c=0;c<l;c++){var d=i.readUshort(t,e);e+=2;var h=n._lctf.readLookupTable(t,o+d,r);a.push(h)}return a},n._lctf.readLookupTable=function(t,e,r){var i=n._bin,o=e,a={tabs:[]};a.ltype=i.readUshort(t,e),e+=2,a.flag=i.readUshort(t,e),e+=2;var l=i.readUshort(t,e);e+=2;for(var c=a.ltype,d=0;d<l;d++){var h=i.readUshort(t,e);e+=2;var v=r(t,c,o+h,a);a.tabs.push(v)}return a},n._lctf.numOfOnes=function(t){for(var e=0,r=0;r<32;r++)t>>>r&1&&e++;return e},n._lctf.readClassDef=function(t,e){var r=n._bin,i=[],o=r.readUshort(t,e);if(e+=2,o==1){var a=r.readUshort(t,e);e+=2;var l=r.readUshort(t,e);e+=2;for(var c=0;c<l;c++)i.push(a+c),i.push(a+c),i.push(r.readUshort(t,e)),e+=2}if(o==2){var d=r.readUshort(t,e);for(e+=2,c=0;c<d;c++)i.push(r.readUshort(t,e)),e+=2,i.push(r.readUshort(t,e)),e+=2,i.push(r.readUshort(t,e)),e+=2}return i},n._lctf.getInterval=function(t,e){for(var r=0;r<t.length;r+=3){var i=t[r],o=t[r+1];if(t[r+2],i<=e&&e<=o)return r}return-1},n._lctf.readCoverage=function(t,e){var r=n._bin,i={};i.fmt=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);return e+=2,i.fmt==1&&(i.tab=r.readUshorts(t,e,o)),i.fmt==2&&(i.tab=r.readUshorts(t,e,3*o)),i},n._lctf.coverageIndex=function(t,e){var r=t.tab;if(t.fmt==1)return r.indexOf(e);if(t.fmt==2){var i=n._lctf.getInterval(r,e);if(i!=-1)return r[i+2]+(e-r[i])}return-1},n._lctf.readFeatureList=function(t,e){var r=n._bin,i=e,o=[],a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=r.readASCII(t,e,4);e+=4;var d=r.readUshort(t,e);e+=2;var h=n._lctf.readFeatureTable(t,i+d);h.tag=c.trim(),o.push(h)}return o},n._lctf.readFeatureTable=function(t,e){var r=n._bin,i=e,o={},a=r.readUshort(t,e);e+=2,a>0&&(o.featureParams=i+a);var l=r.readUshort(t,e);e+=2,o.tab=[];for(var c=0;c<l;c++)o.tab.push(r.readUshort(t,e+2*c));return o},n._lctf.readScriptList=function(t,e){var r=n._bin,i=e,o={},a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=r.readASCII(t,e,4);e+=4;var d=r.readUshort(t,e);e+=2,o[c.trim()]=n._lctf.readScriptTable(t,i+d)}return o},n._lctf.readScriptTable=function(t,e){var r=n._bin,i=e,o={},a=r.readUshort(t,e);e+=2,a>0&&(o.default=n._lctf.readLangSysTable(t,i+a));var l=r.readUshort(t,e);e+=2;for(var c=0;c<l;c++){var d=r.readASCII(t,e,4);e+=4;var h=r.readUshort(t,e);e+=2,o[d.trim()]=n._lctf.readLangSysTable(t,i+h)}return o},n._lctf.readLangSysTable=function(t,e){var r=n._bin,i={};r.readUshort(t,e),e+=2,i.reqFeature=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);return e+=2,i.features=r.readUshorts(t,e,o),i},n.CFF={},n.CFF.parse=function(t,e,r){var i=n._bin;(t=new Uint8Array(t.buffer,e,r))[e=0],t[++e],t[++e],t[++e],e++;var o=[];e=n.CFF.readIndex(t,e,o);for(var a=[],l=0;l<o.length-1;l++)a.push(i.readASCII(t,e+o[l],o[l+1]-o[l]));e+=o[o.length-1];var c=[];e=n.CFF.readIndex(t,e,c);var d=[];for(l=0;l<c.length-1;l++)d.push(n.CFF.readDict(t,e+c[l],e+c[l+1]));e+=c[c.length-1];var h=d[0],v=[];e=n.CFF.readIndex(t,e,v);var m=[];for(l=0;l<v.length-1;l++)m.push(i.readASCII(t,e+v[l],v[l+1]-v[l]));if(e+=v[v.length-1],n.CFF.readSubrs(t,e,h),h.CharStrings){e=h.CharStrings,v=[],e=n.CFF.readIndex(t,e,v);var g=[];for(l=0;l<v.length-1;l++)g.push(i.readBytes(t,e+v[l],v[l+1]-v[l]));h.CharStrings=g}if(h.ROS){e=h.FDArray;var I=[];for(e=n.CFF.readIndex(t,e,I),h.FDArray=[],l=0;l<I.length-1;l++){var k=n.CFF.readDict(t,e+I[l],e+I[l+1]);n.CFF._readFDict(t,k,m),h.FDArray.push(k)}e+=I[I.length-1],e=h.FDSelect,h.FDSelect=[];var w=t[e];if(e++,w!=3)throw w;var y=i.readUshort(t,e);for(e+=2,l=0;l<y+1;l++)h.FDSelect.push(i.readUshort(t,e),t[e+2]),e+=3}return h.Encoding&&(h.Encoding=n.CFF.readEncoding(t,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=n.CFF.readCharset(t,h.charset,h.CharStrings.length)),n.CFF._readFDict(t,h,m),h},n.CFF._readFDict=function(t,e,r){var i;for(var o in e.Private&&(i=e.Private[1],e.Private=n.CFF.readDict(t,i,i+e.Private[0]),e.Private.Subrs&&n.CFF.readSubrs(t,i+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(o)!=-1&&(e[o]=r[e[o]-426+35])},n.CFF.readSubrs=function(t,e,r){var i=n._bin,o=[];e=n.CFF.readIndex(t,e,o);var a,l=o.length;a=l<1240?107:l<33900?1131:32768,r.Bias=a,r.Subrs=[];for(var c=0;c<o.length-1;c++)r.Subrs.push(i.readBytes(t,e+o[c],o[c+1]-o[c]))},n.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],n.CFF.glyphByUnicode=function(t,e){for(var r=0;r<t.charset.length;r++)if(t.charset[r]==e)return r;return-1},n.CFF.glyphBySE=function(t,e){return e<0||e>255?-1:n.CFF.glyphByUnicode(t,n.CFF.tableSE[e])},n.CFF.readEncoding=function(t,e,r){n._bin;var i=[".notdef"],o=t[e];if(e++,o!=0)throw"error: unknown encoding format: "+o;var a=t[e];e++;for(var l=0;l<a;l++)i.push(t[e+l]);return i},n.CFF.readCharset=function(t,e,r){var i=n._bin,o=[".notdef"],a=t[e];if(e++,a==0)for(var l=0;l<r;l++){var c=i.readUshort(t,e);e+=2,o.push(c)}else{if(a!=1&&a!=2)throw"error: format: "+a;for(;o.length<r;){c=i.readUshort(t,e),e+=2;var d=0;for(a==1?(d=t[e],e++):(d=i.readUshort(t,e),e+=2),l=0;l<=d;l++)o.push(c),c++}}return o},n.CFF.readIndex=function(t,e,r){var i=n._bin,o=i.readUshort(t,e)+1,a=t[e+=2];if(e++,a==1)for(var l=0;l<o;l++)r.push(t[e+l]);else if(a==2)for(l=0;l<o;l++)r.push(i.readUshort(t,e+2*l));else if(a==3)for(l=0;l<o;l++)r.push(16777215&i.readUint(t,e+3*l-1));else if(o!=1)throw"unsupported offset size: "+a+", count: "+o;return(e+=o*a)-1},n.CFF.getCharString=function(t,e,r){var i=n._bin,o=t[e],a=t[e+1];t[e+2],t[e+3],t[e+4];var l=1,c=null,d=null;o<=20&&(c=o,l=1),o==12&&(c=100*o+a,l=2),21<=o&&o<=27&&(c=o,l=1),o==28&&(d=i.readShort(t,e+1),l=3),29<=o&&o<=31&&(c=o,l=1),32<=o&&o<=246&&(d=o-139,l=1),247<=o&&o<=250&&(d=256*(o-247)+a+108,l=2),251<=o&&o<=254&&(d=256*-(o-251)-a-108,l=2),o==255&&(d=i.readInt(t,e+1)/65535,l=5),r.val=d??"o"+c,r.size=l},n.CFF.readCharString=function(t,e,r){for(var i=e+r,o=n._bin,a=[];e<i;){var l=t[e],c=t[e+1];t[e+2],t[e+3],t[e+4];var d=1,h=null,v=null;l<=20&&(h=l,d=1),l==12&&(h=100*l+c,d=2),l!=19&&l!=20||(h=l,d=2),21<=l&&l<=27&&(h=l,d=1),l==28&&(v=o.readShort(t,e+1),d=3),29<=l&&l<=31&&(h=l,d=1),32<=l&&l<=246&&(v=l-139,d=1),247<=l&&l<=250&&(v=256*(l-247)+c+108,d=2),251<=l&&l<=254&&(v=256*-(l-251)-c-108,d=2),l==255&&(v=o.readInt(t,e+1)/65535,d=5),a.push(v??"o"+h),e+=d}return a},n.CFF.readDict=function(t,e,r){for(var i=n._bin,o={},a=[];e<r;){var l=t[e],c=t[e+1];t[e+2],t[e+3],t[e+4];var d=1,h=null,v=null;if(l==28&&(v=i.readShort(t,e+1),d=3),l==29&&(v=i.readInt(t,e+1),d=5),32<=l&&l<=246&&(v=l-139,d=1),247<=l&&l<=250&&(v=256*(l-247)+c+108,d=2),251<=l&&l<=254&&(v=256*-(l-251)-c-108,d=2),l==255)throw v=i.readInt(t,e+1)/65535,d=5,"unknown number";if(l==30){var m=[];for(d=1;;){var g=t[e+d];d++;var I=g>>4,k=15&g;if(I!=15&&m.push(I),k!=15&&m.push(k),k==15)break}for(var w="",y=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],x=0;x<m.length;x++)w+=y[m[x]];v=parseFloat(w)}l<=21&&(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][l],d=1,l==12&&(h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][c],d=2)),h!=null?(o[h]=a.length==1?a[0]:a,a=[]):a.push(v),e+=d}return o},n.cmap={},n.cmap.parse=function(t,e,r){t=new Uint8Array(t.buffer,e,r),e=0;var i=n._bin,o={};i.readUshort(t,e),e+=2;var a=i.readUshort(t,e);e+=2;var l=[];o.tables=[];for(var c=0;c<a;c++){var d=i.readUshort(t,e);e+=2;var h=i.readUshort(t,e);e+=2;var v=i.readUint(t,e);e+=4;var m="p"+d+"e"+h,g=l.indexOf(v);if(g==-1){var I;g=o.tables.length,l.push(v);var k=i.readUshort(t,v);k==0?I=n.cmap.parse0(t,v):k==4?I=n.cmap.parse4(t,v):k==6?I=n.cmap.parse6(t,v):k==12?I=n.cmap.parse12(t,v):console.debug("unknown format: "+k,d,h,v),o.tables.push(I)}if(o[m]!=null)throw"multiple tables for one platform+encoding";o[m]=g}return o},n.cmap.parse0=function(t,e){var r=n._bin,i={};i.format=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);e+=2,r.readUshort(t,e),e+=2,i.map=[];for(var a=0;a<o-6;a++)i.map.push(t[e+a]);return i},n.cmap.parse4=function(t,e){var r=n._bin,i=e,o={};o.format=r.readUshort(t,e),e+=2;var a=r.readUshort(t,e);e+=2,r.readUshort(t,e),e+=2;var l=r.readUshort(t,e);e+=2;var c=l/2;o.searchRange=r.readUshort(t,e),e+=2,o.entrySelector=r.readUshort(t,e),e+=2,o.rangeShift=r.readUshort(t,e),e+=2,o.endCount=r.readUshorts(t,e,c),e+=2*c,e+=2,o.startCount=r.readUshorts(t,e,c),e+=2*c,o.idDelta=[];for(var d=0;d<c;d++)o.idDelta.push(r.readShort(t,e)),e+=2;for(o.idRangeOffset=r.readUshorts(t,e,c),e+=2*c,o.glyphIdArray=[];e<i+a;)o.glyphIdArray.push(r.readUshort(t,e)),e+=2;return o},n.cmap.parse6=function(t,e){var r=n._bin,i={};i.format=r.readUshort(t,e),e+=2,r.readUshort(t,e),e+=2,r.readUshort(t,e),e+=2,i.firstCode=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);e+=2,i.glyphIdArray=[];for(var a=0;a<o;a++)i.glyphIdArray.push(r.readUshort(t,e)),e+=2;return i},n.cmap.parse12=function(t,e){var r=n._bin,i={};i.format=r.readUshort(t,e),e+=2,e+=2,r.readUint(t,e),e+=4,r.readUint(t,e),e+=4;var o=r.readUint(t,e);e+=4,i.groups=[];for(var a=0;a<o;a++){var l=e+12*a,c=r.readUint(t,l+0),d=r.readUint(t,l+4),h=r.readUint(t,l+8);i.groups.push([c,d,h])}return i},n.glyf={},n.glyf.parse=function(t,e,r,i){for(var o=[],a=0;a<i.maxp.numGlyphs;a++)o.push(null);return o},n.glyf._parseGlyf=function(t,e){var r=n._bin,i=t._data,o=n._tabOffset(i,"glyf",t._offset)+t.loca[e];if(t.loca[e]==t.loca[e+1])return null;var a={};if(a.noc=r.readShort(i,o),o+=2,a.xMin=r.readShort(i,o),o+=2,a.yMin=r.readShort(i,o),o+=2,a.xMax=r.readShort(i,o),o+=2,a.yMax=r.readShort(i,o),o+=2,a.xMin>=a.xMax||a.yMin>=a.yMax)return null;if(a.noc>0){a.endPts=[];for(var l=0;l<a.noc;l++)a.endPts.push(r.readUshort(i,o)),o+=2;var c=r.readUshort(i,o);if(o+=2,i.length-o<c)return null;a.instructions=r.readBytes(i,o,c),o+=c;var d=a.endPts[a.noc-1]+1;for(a.flags=[],l=0;l<d;l++){var h=i[o];if(o++,a.flags.push(h),(8&h)!=0){var v=i[o];o++;for(var m=0;m<v;m++)a.flags.push(h),l++}}for(a.xs=[],l=0;l<d;l++){var g=(2&a.flags[l])!=0,I=(16&a.flags[l])!=0;g?(a.xs.push(I?i[o]:-i[o]),o++):I?a.xs.push(0):(a.xs.push(r.readShort(i,o)),o+=2)}for(a.ys=[],l=0;l<d;l++)g=(4&a.flags[l])!=0,I=(32&a.flags[l])!=0,g?(a.ys.push(I?i[o]:-i[o]),o++):I?a.ys.push(0):(a.ys.push(r.readShort(i,o)),o+=2);var k=0,w=0;for(l=0;l<d;l++)k+=a.xs[l],w+=a.ys[l],a.xs[l]=k,a.ys[l]=w}else{var y;a.parts=[];do{y=r.readUshort(i,o),o+=2;var x={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(a.parts.push(x),x.glyphIndex=r.readUshort(i,o),o+=2,1&y){var O=r.readShort(i,o);o+=2;var U=r.readShort(i,o);o+=2}else O=r.readInt8(i,o),o++,U=r.readInt8(i,o),o++;2&y?(x.m.tx=O,x.m.ty=U):(x.p1=O,x.p2=U),8&y?(x.m.a=x.m.d=r.readF2dot14(i,o),o+=2):64&y?(x.m.a=r.readF2dot14(i,o),o+=2,x.m.d=r.readF2dot14(i,o),o+=2):128&y&&(x.m.a=r.readF2dot14(i,o),o+=2,x.m.b=r.readF2dot14(i,o),o+=2,x.m.c=r.readF2dot14(i,o),o+=2,x.m.d=r.readF2dot14(i,o),o+=2)}while(32&y);if(256&y){var M=r.readUshort(i,o);for(o+=2,a.instr=[],l=0;l<M;l++)a.instr.push(i[o]),o++}}return a},n.GDEF={},n.GDEF.parse=function(t,e,r,i){var o=e;e+=4;var a=n._bin.readUshort(t,e);return{glyphClassDef:a===0?null:n._lctf.readClassDef(t,o+a)}},n.GPOS={},n.GPOS.parse=function(t,e,r,i){return n._lctf.parse(t,e,r,i,n.GPOS.subt)},n.GPOS.subt=function(t,e,r,i){var o=n._bin,a=r,l={};if(l.fmt=o.readUshort(t,r),r+=2,e==1||e==2||e==3||e==7||e==8&&l.fmt<=2){var c=o.readUshort(t,r);r+=2,l.coverage=n._lctf.readCoverage(t,c+a)}if(e==1&&l.fmt==1){var d=o.readUshort(t,r);r+=2,d!=0&&(l.pos=n.GPOS.readValueRecord(t,r,d))}else if(e==2&&l.fmt>=1&&l.fmt<=2){d=o.readUshort(t,r),r+=2;var h=o.readUshort(t,r);r+=2;var v=n._lctf.numOfOnes(d),m=n._lctf.numOfOnes(h);if(l.fmt==1){l.pairsets=[];var g=o.readUshort(t,r);r+=2;for(var I=0;I<g;I++){var k=a+o.readUshort(t,r);r+=2;var w=o.readUshort(t,k);k+=2;for(var y=[],x=0;x<w;x++){var O=o.readUshort(t,k);k+=2,d!=0&&(_=n.GPOS.readValueRecord(t,k,d),k+=2*v),h!=0&&(B=n.GPOS.readValueRecord(t,k,h),k+=2*m),y.push({gid2:O,val1:_,val2:B})}l.pairsets.push(y)}}if(l.fmt==2){var U=o.readUshort(t,r);r+=2;var M=o.readUshort(t,r);r+=2;var V=o.readUshort(t,r);r+=2;var G=o.readUshort(t,r);for(r+=2,l.classDef1=n._lctf.readClassDef(t,a+U),l.classDef2=n._lctf.readClassDef(t,a+M),l.matrix=[],I=0;I<V;I++){var ee=[];for(x=0;x<G;x++){var _=null,B=null;d!=0&&(_=n.GPOS.readValueRecord(t,r,d),r+=2*v),h!=0&&(B=n.GPOS.readValueRecord(t,r,h),r+=2*m),ee.push({val1:_,val2:B})}l.matrix.push(ee)}}}else if(e==4&&l.fmt==1)l.markCoverage=n._lctf.readCoverage(t,o.readUshort(t,r)+a),l.baseCoverage=n._lctf.readCoverage(t,o.readUshort(t,r+2)+a),l.markClassCount=o.readUshort(t,r+4),l.markArray=n.GPOS.readMarkArray(t,o.readUshort(t,r+6)+a),l.baseArray=n.GPOS.readBaseArray(t,o.readUshort(t,r+8)+a,l.markClassCount);else if(e==6&&l.fmt==1)l.mark1Coverage=n._lctf.readCoverage(t,o.readUshort(t,r)+a),l.mark2Coverage=n._lctf.readCoverage(t,o.readUshort(t,r+2)+a),l.markClassCount=o.readUshort(t,r+4),l.mark1Array=n.GPOS.readMarkArray(t,o.readUshort(t,r+6)+a),l.mark2Array=n.GPOS.readBaseArray(t,o.readUshort(t,r+8)+a,l.markClassCount);else{if(e==9&&l.fmt==1){var C=o.readUshort(t,r);r+=2;var X=o.readUint(t,r);if(r+=4,i.ltype==9)i.ltype=C;else if(i.ltype!=C)throw"invalid extension substitution";return n.GPOS.subt(t,i.ltype,a+X)}console.debug("unsupported GPOS table LookupType",e,"format",l.fmt)}return l},n.GPOS.readValueRecord=function(t,e,r){var i=n._bin,o=[];return o.push(1&r?i.readShort(t,e):0),e+=1&r?2:0,o.push(2&r?i.readShort(t,e):0),e+=2&r?2:0,o.push(4&r?i.readShort(t,e):0),e+=4&r?2:0,o.push(8&r?i.readShort(t,e):0),e+=8&r?2:0,o},n.GPOS.readBaseArray=function(t,e,r){var i=n._bin,o=[],a=e,l=i.readUshort(t,e);e+=2;for(var c=0;c<l;c++){for(var d=[],h=0;h<r;h++)d.push(n.GPOS.readAnchorRecord(t,a+i.readUshort(t,e))),e+=2;o.push(d)}return o},n.GPOS.readMarkArray=function(t,e){var r=n._bin,i=[],o=e,a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=n.GPOS.readAnchorRecord(t,r.readUshort(t,e+2)+o);c.markClass=r.readUshort(t,e),i.push(c),e+=4}return i},n.GPOS.readAnchorRecord=function(t,e){var r=n._bin,i={};return i.fmt=r.readUshort(t,e),i.x=r.readShort(t,e+2),i.y=r.readShort(t,e+4),i},n.GSUB={},n.GSUB.parse=function(t,e,r,i){return n._lctf.parse(t,e,r,i,n.GSUB.subt)},n.GSUB.subt=function(t,e,r,i){var o=n._bin,a=r,l={};if(l.fmt=o.readUshort(t,r),r+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&l.fmt<=2||e==6&&l.fmt<=2){var c=o.readUshort(t,r);r+=2,l.coverage=n._lctf.readCoverage(t,a+c)}if(e==1&&l.fmt>=1&&l.fmt<=2){if(l.fmt==1)l.delta=o.readShort(t,r),r+=2;else if(l.fmt==2){var d=o.readUshort(t,r);r+=2,l.newg=o.readUshorts(t,r,d),r+=2*l.newg.length}}else if(e==2&&l.fmt==1){d=o.readUshort(t,r),r+=2,l.seqs=[];for(var h=0;h<d;h++){var v=o.readUshort(t,r)+a;r+=2;var m=o.readUshort(t,v);l.seqs.push(o.readUshorts(t,v+2,m))}}else if(e==4)for(l.vals=[],d=o.readUshort(t,r),r+=2,h=0;h<d;h++){var g=o.readUshort(t,r);r+=2,l.vals.push(n.GSUB.readLigatureSet(t,a+g))}else if(e==5&&l.fmt==2){if(l.fmt==2){var I=o.readUshort(t,r);r+=2,l.cDef=n._lctf.readClassDef(t,a+I),l.scset=[];var k=o.readUshort(t,r);for(r+=2,h=0;h<k;h++){var w=o.readUshort(t,r);r+=2,l.scset.push(w==0?null:n.GSUB.readSubClassSet(t,a+w))}}}else if(e==6&&l.fmt==3){if(l.fmt==3){for(h=0;h<3;h++){d=o.readUshort(t,r),r+=2;for(var y=[],x=0;x<d;x++)y.push(n._lctf.readCoverage(t,a+o.readUshort(t,r+2*x)));r+=2*d,h==0&&(l.backCvg=y),h==1&&(l.inptCvg=y),h==2&&(l.ahedCvg=y)}d=o.readUshort(t,r),r+=2,l.lookupRec=n.GSUB.readSubstLookupRecords(t,r,d)}}else{if(e==7&&l.fmt==1){var O=o.readUshort(t,r);r+=2;var U=o.readUint(t,r);if(r+=4,i.ltype==9)i.ltype=O;else if(i.ltype!=O)throw"invalid extension substitution";return n.GSUB.subt(t,i.ltype,a+U)}console.debug("unsupported GSUB table LookupType",e,"format",l.fmt)}return l},n.GSUB.readSubClassSet=function(t,e){var r=n._bin.readUshort,i=e,o=[],a=r(t,e);e+=2;for(var l=0;l<a;l++){var c=r(t,e);e+=2,o.push(n.GSUB.readSubClassRule(t,i+c))}return o},n.GSUB.readSubClassRule=function(t,e){var r=n._bin.readUshort,i={},o=r(t,e),a=r(t,e+=2);e+=2,i.input=[];for(var l=0;l<o-1;l++)i.input.push(r(t,e)),e+=2;return i.substLookupRecords=n.GSUB.readSubstLookupRecords(t,e,a),i},n.GSUB.readSubstLookupRecords=function(t,e,r){for(var i=n._bin.readUshort,o=[],a=0;a<r;a++)o.push(i(t,e),i(t,e+2)),e+=4;return o},n.GSUB.readChainSubClassSet=function(t,e){var r=n._bin,i=e,o=[],a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=r.readUshort(t,e);e+=2,o.push(n.GSUB.readChainSubClassRule(t,i+c))}return o},n.GSUB.readChainSubClassRule=function(t,e){for(var r=n._bin,i={},o=["backtrack","input","lookahead"],a=0;a<o.length;a++){var l=r.readUshort(t,e);e+=2,a==1&&l--,i[o[a]]=r.readUshorts(t,e,l),e+=2*i[o[a]].length}return l=r.readUshort(t,e),e+=2,i.subst=r.readUshorts(t,e,2*l),e+=2*i.subst.length,i},n.GSUB.readLigatureSet=function(t,e){var r=n._bin,i=e,o=[],a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=r.readUshort(t,e);e+=2,o.push(n.GSUB.readLigature(t,i+c))}return o},n.GSUB.readLigature=function(t,e){var r=n._bin,i={chain:[]};i.nglyph=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);e+=2;for(var a=0;a<o-1;a++)i.chain.push(r.readUshort(t,e)),e+=2;return i},n.head={},n.head.parse=function(t,e,r){var i=n._bin,o={};return i.readFixed(t,e),e+=4,o.fontRevision=i.readFixed(t,e),e+=4,i.readUint(t,e),e+=4,i.readUint(t,e),e+=4,o.flags=i.readUshort(t,e),e+=2,o.unitsPerEm=i.readUshort(t,e),e+=2,o.created=i.readUint64(t,e),e+=8,o.modified=i.readUint64(t,e),e+=8,o.xMin=i.readShort(t,e),e+=2,o.yMin=i.readShort(t,e),e+=2,o.xMax=i.readShort(t,e),e+=2,o.yMax=i.readShort(t,e),e+=2,o.macStyle=i.readUshort(t,e),e+=2,o.lowestRecPPEM=i.readUshort(t,e),e+=2,o.fontDirectionHint=i.readShort(t,e),e+=2,o.indexToLocFormat=i.readShort(t,e),e+=2,o.glyphDataFormat=i.readShort(t,e),e+=2,o},n.hhea={},n.hhea.parse=function(t,e,r){var i=n._bin,o={};return i.readFixed(t,e),e+=4,o.ascender=i.readShort(t,e),e+=2,o.descender=i.readShort(t,e),e+=2,o.lineGap=i.readShort(t,e),e+=2,o.advanceWidthMax=i.readUshort(t,e),e+=2,o.minLeftSideBearing=i.readShort(t,e),e+=2,o.minRightSideBearing=i.readShort(t,e),e+=2,o.xMaxExtent=i.readShort(t,e),e+=2,o.caretSlopeRise=i.readShort(t,e),e+=2,o.caretSlopeRun=i.readShort(t,e),e+=2,o.caretOffset=i.readShort(t,e),e+=2,e+=8,o.metricDataFormat=i.readShort(t,e),e+=2,o.numberOfHMetrics=i.readUshort(t,e),e+=2,o},n.hmtx={},n.hmtx.parse=function(t,e,r,i){for(var o=n._bin,a={aWidth:[],lsBearing:[]},l=0,c=0,d=0;d<i.maxp.numGlyphs;d++)d<i.hhea.numberOfHMetrics&&(l=o.readUshort(t,e),e+=2,c=o.readShort(t,e),e+=2),a.aWidth.push(l),a.lsBearing.push(c);return a},n.kern={},n.kern.parse=function(t,e,r,i){var o=n._bin,a=o.readUshort(t,e);if(e+=2,a==1)return n.kern.parseV1(t,e-2,r,i);var l=o.readUshort(t,e);e+=2;for(var c={glyph1:[],rval:[]},d=0;d<l;d++){e+=2,r=o.readUshort(t,e),e+=2;var h=o.readUshort(t,e);e+=2;var v=h>>>8;if((v&=15)!=0)throw"unknown kern table format: "+v;e=n.kern.readFormat0(t,e,c)}return c},n.kern.parseV1=function(t,e,r,i){var o=n._bin;o.readFixed(t,e),e+=4;var a=o.readUint(t,e);e+=4;for(var l={glyph1:[],rval:[]},c=0;c<a;c++){o.readUint(t,e),e+=4;var d=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2;var h=d>>>8;if((h&=15)!=0)throw"unknown kern table format: "+h;e=n.kern.readFormat0(t,e,l)}return l},n.kern.readFormat0=function(t,e,r){var i=n._bin,o=-1,a=i.readUshort(t,e);e+=2,i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2;for(var l=0;l<a;l++){var c=i.readUshort(t,e);e+=2;var d=i.readUshort(t,e);e+=2;var h=i.readShort(t,e);e+=2,c!=o&&(r.glyph1.push(c),r.rval.push({glyph2:[],vals:[]}));var v=r.rval[r.rval.length-1];v.glyph2.push(d),v.vals.push(h),o=c}return e},n.loca={},n.loca.parse=function(t,e,r,i){var o=n._bin,a=[],l=i.head.indexToLocFormat,c=i.maxp.numGlyphs+1;if(l==0)for(var d=0;d<c;d++)a.push(o.readUshort(t,e+(d<<1))<<1);if(l==1)for(d=0;d<c;d++)a.push(o.readUint(t,e+(d<<2)));return a},n.maxp={},n.maxp.parse=function(t,e,r){var i=n._bin,o={},a=i.readUint(t,e);return e+=4,o.numGlyphs=i.readUshort(t,e),e+=2,a==65536&&(o.maxPoints=i.readUshort(t,e),e+=2,o.maxContours=i.readUshort(t,e),e+=2,o.maxCompositePoints=i.readUshort(t,e),e+=2,o.maxCompositeContours=i.readUshort(t,e),e+=2,o.maxZones=i.readUshort(t,e),e+=2,o.maxTwilightPoints=i.readUshort(t,e),e+=2,o.maxStorage=i.readUshort(t,e),e+=2,o.maxFunctionDefs=i.readUshort(t,e),e+=2,o.maxInstructionDefs=i.readUshort(t,e),e+=2,o.maxStackElements=i.readUshort(t,e),e+=2,o.maxSizeOfInstructions=i.readUshort(t,e),e+=2,o.maxComponentElements=i.readUshort(t,e),e+=2,o.maxComponentDepth=i.readUshort(t,e),e+=2),o},n.name={},n.name.parse=function(t,e,r){var i=n._bin,o={};i.readUshort(t,e),e+=2;var a=i.readUshort(t,e);e+=2,i.readUshort(t,e);for(var l,c=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=e+=2,h=0;h<a;h++){var v=i.readUshort(t,e);e+=2;var m=i.readUshort(t,e);e+=2;var g=i.readUshort(t,e);e+=2;var I=i.readUshort(t,e);e+=2;var k=i.readUshort(t,e);e+=2;var w=i.readUshort(t,e);e+=2;var y,x=c[I],O=d+12*a+w;if(v==0)y=i.readUnicode(t,O,k/2);else if(v==3&&m==0)y=i.readUnicode(t,O,k/2);else if(m==0)y=i.readASCII(t,O,k);else if(m==1)y=i.readUnicode(t,O,k/2);else if(m==3)y=i.readUnicode(t,O,k/2);else{if(v!=1)throw"unknown encoding "+m+", platformID: "+v;y=i.readASCII(t,O,k),console.debug("reading unknown MAC encoding "+m+" as ASCII")}var U="p"+v+","+g.toString(16);o[U]==null&&(o[U]={}),o[U][x!==void 0?x:I]=y,o[U]._lang=g}for(var M in o)if(o[M].postScriptName!=null&&o[M]._lang==1033)return o[M];for(var M in o)if(o[M].postScriptName!=null&&o[M]._lang==0)return o[M];for(var M in o)if(o[M].postScriptName!=null&&o[M]._lang==3084)return o[M];for(var M in o)if(o[M].postScriptName!=null)return o[M];for(var M in o){l=M;break}return console.debug("returning name table with languageID "+o[l]._lang),o[l]},n["OS/2"]={},n["OS/2"].parse=function(t,e,r){var i=n._bin.readUshort(t,e);e+=2;var o={};if(i==0)n["OS/2"].version0(t,e,o);else if(i==1)n["OS/2"].version1(t,e,o);else if(i==2||i==3||i==4)n["OS/2"].version2(t,e,o);else{if(i!=5)throw"unknown OS/2 table version: "+i;n["OS/2"].version5(t,e,o)}return o},n["OS/2"].version0=function(t,e,r){var i=n._bin;return r.xAvgCharWidth=i.readShort(t,e),e+=2,r.usWeightClass=i.readUshort(t,e),e+=2,r.usWidthClass=i.readUshort(t,e),e+=2,r.fsType=i.readUshort(t,e),e+=2,r.ySubscriptXSize=i.readShort(t,e),e+=2,r.ySubscriptYSize=i.readShort(t,e),e+=2,r.ySubscriptXOffset=i.readShort(t,e),e+=2,r.ySubscriptYOffset=i.readShort(t,e),e+=2,r.ySuperscriptXSize=i.readShort(t,e),e+=2,r.ySuperscriptYSize=i.readShort(t,e),e+=2,r.ySuperscriptXOffset=i.readShort(t,e),e+=2,r.ySuperscriptYOffset=i.readShort(t,e),e+=2,r.yStrikeoutSize=i.readShort(t,e),e+=2,r.yStrikeoutPosition=i.readShort(t,e),e+=2,r.sFamilyClass=i.readShort(t,e),e+=2,r.panose=i.readBytes(t,e,10),e+=10,r.ulUnicodeRange1=i.readUint(t,e),e+=4,r.ulUnicodeRange2=i.readUint(t,e),e+=4,r.ulUnicodeRange3=i.readUint(t,e),e+=4,r.ulUnicodeRange4=i.readUint(t,e),e+=4,r.achVendID=[i.readInt8(t,e),i.readInt8(t,e+1),i.readInt8(t,e+2),i.readInt8(t,e+3)],e+=4,r.fsSelection=i.readUshort(t,e),e+=2,r.usFirstCharIndex=i.readUshort(t,e),e+=2,r.usLastCharIndex=i.readUshort(t,e),e+=2,r.sTypoAscender=i.readShort(t,e),e+=2,r.sTypoDescender=i.readShort(t,e),e+=2,r.sTypoLineGap=i.readShort(t,e),e+=2,r.usWinAscent=i.readUshort(t,e),e+=2,r.usWinDescent=i.readUshort(t,e),e+=2},n["OS/2"].version1=function(t,e,r){var i=n._bin;return e=n["OS/2"].version0(t,e,r),r.ulCodePageRange1=i.readUint(t,e),e+=4,r.ulCodePageRange2=i.readUint(t,e),e+=4},n["OS/2"].version2=function(t,e,r){var i=n._bin;return e=n["OS/2"].version1(t,e,r),r.sxHeight=i.readShort(t,e),e+=2,r.sCapHeight=i.readShort(t,e),e+=2,r.usDefault=i.readUshort(t,e),e+=2,r.usBreak=i.readUshort(t,e),e+=2,r.usMaxContext=i.readUshort(t,e),e+=2},n["OS/2"].version5=function(t,e,r){var i=n._bin;return e=n["OS/2"].version2(t,e,r),r.usLowerOpticalPointSize=i.readUshort(t,e),e+=2,r.usUpperOpticalPointSize=i.readUshort(t,e),e+=2},n.post={},n.post.parse=function(t,e,r){var i=n._bin,o={};return o.version=i.readFixed(t,e),e+=4,o.italicAngle=i.readFixed(t,e),e+=4,o.underlinePosition=i.readShort(t,e),e+=2,o.underlineThickness=i.readShort(t,e),e+=2,o},n==null&&(n={}),n.U==null&&(n.U={}),n.U.codeToGlyph=function(t,e){var r=t.cmap,i=-1;if(r.p0e4!=null?i=r.p0e4:r.p3e1!=null?i=r.p3e1:r.p1e0!=null?i=r.p1e0:r.p0e3!=null&&(i=r.p0e3),i==-1)throw"no familiar platform and encoding!";var o=r.tables[i];if(o.format==0)return e>=o.map.length?0:o.map[e];if(o.format==4){for(var a=-1,l=0;l<o.endCount.length;l++)if(e<=o.endCount[l]){a=l;break}return a==-1||o.startCount[a]>e?0:65535&(o.idRangeOffset[a]!=0?o.glyphIdArray[e-o.startCount[a]+(o.idRangeOffset[a]>>1)-(o.idRangeOffset.length-a)]:e+o.idDelta[a])}if(o.format==12){if(e>o.groups[o.groups.length-1][1])return 0;for(l=0;l<o.groups.length;l++){var c=o.groups[l];if(c[0]<=e&&e<=c[1])return c[2]+(e-c[0])}return 0}throw"unknown cmap table format "+o.format},n.U.glyphToPath=function(t,e){var r={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[e]){var i=t.SVG.entries[e];return i==null?r:(typeof i=="string"&&(i=n.SVG.toPath(i),t.SVG.entries[e]=i),i)}if(t.CFF){var o={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},a=t.CFF,l=t.CFF.Private;if(a.ROS){for(var c=0;a.FDSelect[c+2]<=e;)c+=2;l=a.FDArray[a.FDSelect[c+1]].Private}n.U._drawCFF(t.CFF.CharStrings[e],o,a,l,r)}else t.glyf&&n.U._drawGlyf(e,t,r);return r},n.U._drawGlyf=function(t,e,r){var i=e.glyf[t];i==null&&(i=e.glyf[t]=n.glyf._parseGlyf(e,t)),i!=null&&(i.noc>-1?n.U._simpleGlyph(i,r):n.U._compoGlyph(i,e,r))},n.U._simpleGlyph=function(t,e){for(var r=0;r<t.noc;r++){for(var i=r==0?0:t.endPts[r-1]+1,o=t.endPts[r],a=i;a<=o;a++){var l=a==i?o:a-1,c=a==o?i:a+1,d=1&t.flags[a],h=1&t.flags[l],v=1&t.flags[c],m=t.xs[a],g=t.ys[a];if(a==i)if(d){if(!h){n.U.P.moveTo(e,m,g);continue}n.U.P.moveTo(e,t.xs[l],t.ys[l])}else h?n.U.P.moveTo(e,t.xs[l],t.ys[l]):n.U.P.moveTo(e,(t.xs[l]+m)/2,(t.ys[l]+g)/2);d?h&&n.U.P.lineTo(e,m,g):v?n.U.P.qcurveTo(e,m,g,t.xs[c],t.ys[c]):n.U.P.qcurveTo(e,m,g,(m+t.xs[c])/2,(g+t.ys[c])/2)}n.U.P.closePath(e)}},n.U._compoGlyph=function(t,e,r){for(var i=0;i<t.parts.length;i++){var o={cmds:[],crds:[]},a=t.parts[i];n.U._drawGlyf(a.glyphIndex,e,o);for(var l=a.m,c=0;c<o.crds.length;c+=2){var d=o.crds[c],h=o.crds[c+1];r.crds.push(d*l.a+h*l.b+l.tx),r.crds.push(d*l.c+h*l.d+l.ty)}for(c=0;c<o.cmds.length;c++)r.cmds.push(o.cmds[c])}},n.U._getGlyphClass=function(t,e){var r=n._lctf.getInterval(e,t);return r==-1?0:e[r+2]},n.U._applySubs=function(t,e,r,i){for(var o=t.length-e-1,a=0;a<r.tabs.length;a++)if(r.tabs[a]!=null){var l,c=r.tabs[a];if(!c.coverage||(l=n._lctf.coverageIndex(c.coverage,t[e]))!=-1){if(r.ltype==1)t[e],c.fmt==1?t[e]=t[e]+c.delta:t[e]=c.newg[l];else if(r.ltype==4)for(var d=c.vals[l],h=0;h<d.length;h++){var v=d[h],m=v.chain.length;if(!(m>o)){for(var g=!0,I=0,k=0;k<m;k++){for(;t[e+I+(1+k)]==-1;)I++;v.chain[k]!=t[e+I+(1+k)]&&(g=!1)}if(g){for(t[e]=v.nglyph,k=0;k<m+I;k++)t[e+k+1]=-1;break}}}else if(r.ltype==5&&c.fmt==2)for(var w=n._lctf.getInterval(c.cDef,t[e]),y=c.cDef[w+2],x=c.scset[y],O=0;O<x.length;O++){var U=x[O],M=U.input;if(!(M.length>o)){for(g=!0,k=0;k<M.length;k++){var V=n._lctf.getInterval(c.cDef,t[e+1+k]);if(w==-1&&c.cDef[V+2]!=M[k]){g=!1;break}}if(g){var G=U.substLookupRecords;for(h=0;h<G.length;h+=2)G[h],G[h+1]}}}else if(r.ltype==6&&c.fmt==3){if(!n.U._glsCovered(t,c.backCvg,e-c.backCvg.length)||!n.U._glsCovered(t,c.inptCvg,e)||!n.U._glsCovered(t,c.ahedCvg,e+c.inptCvg.length))continue;var ee=c.lookupRec;for(O=0;O<ee.length;O+=2){w=ee[O];var _=i[ee[O+1]];n.U._applySubs(t,e+w,_,i)}}}}},n.U._glsCovered=function(t,e,r){for(var i=0;i<e.length;i++)if(n._lctf.coverageIndex(e[i],t[r+i])==-1)return!1;return!0},n.U.glyphsToPath=function(t,e,r){for(var i={cmds:[],crds:[]},o=0,a=0;a<e.length;a++){var l=e[a];if(l!=-1){for(var c=a<e.length-1&&e[a+1]!=-1?e[a+1]:0,d=n.U.glyphToPath(t,l),h=0;h<d.crds.length;h+=2)i.crds.push(d.crds[h]+o),i.crds.push(d.crds[h+1]);for(r&&i.cmds.push(r),h=0;h<d.cmds.length;h++)i.cmds.push(d.cmds[h]);r&&i.cmds.push("X"),o+=t.hmtx.aWidth[l],a<e.length-1&&(o+=n.U.getPairAdjustment(t,l,c))}}return i},n.U.P={},n.U.P.moveTo=function(t,e,r){t.cmds.push("M"),t.crds.push(e,r)},n.U.P.lineTo=function(t,e,r){t.cmds.push("L"),t.crds.push(e,r)},n.U.P.curveTo=function(t,e,r,i,o,a,l){t.cmds.push("C"),t.crds.push(e,r,i,o,a,l)},n.U.P.qcurveTo=function(t,e,r,i,o){t.cmds.push("Q"),t.crds.push(e,r,i,o)},n.U.P.closePath=function(t){t.cmds.push("Z")},n.U._drawCFF=function(t,e,r,i,o){for(var a=e.stack,l=e.nStems,c=e.haveWidth,d=e.width,h=e.open,v=0,m=e.x,g=e.y,I=0,k=0,w=0,y=0,x=0,O=0,U=0,M=0,V=0,G=0,ee={val:0,size:0};v<t.length;){n.CFF.getCharString(t,v,ee);var _=ee.val;if(v+=ee.size,_=="o1"||_=="o18")a.length%2!=0&&!c&&(d=a.shift()+i.nominalWidthX),l+=a.length>>1,a.length=0,c=!0;else if(_=="o3"||_=="o23")a.length%2!=0&&!c&&(d=a.shift()+i.nominalWidthX),l+=a.length>>1,a.length=0,c=!0;else if(_=="o4")a.length>1&&!c&&(d=a.shift()+i.nominalWidthX,c=!0),h&&n.U.P.closePath(o),g+=a.pop(),n.U.P.moveTo(o,m,g),h=!0;else if(_=="o5")for(;a.length>0;)m+=a.shift(),g+=a.shift(),n.U.P.lineTo(o,m,g);else if(_=="o6"||_=="o7")for(var B=a.length,C=_=="o6",X=0;X<B;X++){var j=a.shift();C?m+=j:g+=j,C=!C,n.U.P.lineTo(o,m,g)}else if(_=="o8"||_=="o24"){B=a.length;for(var ae=0;ae+6<=B;)I=m+a.shift(),k=g+a.shift(),w=I+a.shift(),y=k+a.shift(),m=w+a.shift(),g=y+a.shift(),n.U.P.curveTo(o,I,k,w,y,m,g),ae+=6;_=="o24"&&(m+=a.shift(),g+=a.shift(),n.U.P.lineTo(o,m,g))}else{if(_=="o11")break;if(_=="o1234"||_=="o1235"||_=="o1236"||_=="o1237")_=="o1234"&&(k=g,w=(I=m+a.shift())+a.shift(),G=y=k+a.shift(),O=y,M=g,m=(U=(x=(V=w+a.shift())+a.shift())+a.shift())+a.shift(),n.U.P.curveTo(o,I,k,w,y,V,G),n.U.P.curveTo(o,x,O,U,M,m,g)),_=="o1235"&&(I=m+a.shift(),k=g+a.shift(),w=I+a.shift(),y=k+a.shift(),V=w+a.shift(),G=y+a.shift(),x=V+a.shift(),O=G+a.shift(),U=x+a.shift(),M=O+a.shift(),m=U+a.shift(),g=M+a.shift(),a.shift(),n.U.P.curveTo(o,I,k,w,y,V,G),n.U.P.curveTo(o,x,O,U,M,m,g)),_=="o1236"&&(I=m+a.shift(),k=g+a.shift(),w=I+a.shift(),G=y=k+a.shift(),O=y,U=(x=(V=w+a.shift())+a.shift())+a.shift(),M=O+a.shift(),m=U+a.shift(),n.U.P.curveTo(o,I,k,w,y,V,G),n.U.P.curveTo(o,x,O,U,M,m,g)),_=="o1237"&&(I=m+a.shift(),k=g+a.shift(),w=I+a.shift(),y=k+a.shift(),V=w+a.shift(),G=y+a.shift(),x=V+a.shift(),O=G+a.shift(),U=x+a.shift(),M=O+a.shift(),Math.abs(U-m)>Math.abs(M-g)?m=U+a.shift():g=M+a.shift(),n.U.P.curveTo(o,I,k,w,y,V,G),n.U.P.curveTo(o,x,O,U,M,m,g));else if(_=="o14"){if(a.length>0&&!c&&(d=a.shift()+r.nominalWidthX,c=!0),a.length==4){var re=a.shift(),b=a.shift(),R=a.shift(),p=a.shift(),T=n.CFF.glyphBySE(r,R),A=n.CFF.glyphBySE(r,p);n.U._drawCFF(r.CharStrings[T],e,r,i,o),e.x=re,e.y=b,n.U._drawCFF(r.CharStrings[A],e,r,i,o)}h&&(n.U.P.closePath(o),h=!1)}else if(_=="o19"||_=="o20")a.length%2!=0&&!c&&(d=a.shift()+i.nominalWidthX),l+=a.length>>1,a.length=0,c=!0,v+=l+7>>3;else if(_=="o21")a.length>2&&!c&&(d=a.shift()+i.nominalWidthX,c=!0),g+=a.pop(),m+=a.pop(),h&&n.U.P.closePath(o),n.U.P.moveTo(o,m,g),h=!0;else if(_=="o22")a.length>1&&!c&&(d=a.shift()+i.nominalWidthX,c=!0),m+=a.pop(),h&&n.U.P.closePath(o),n.U.P.moveTo(o,m,g),h=!0;else if(_=="o25"){for(;a.length>6;)m+=a.shift(),g+=a.shift(),n.U.P.lineTo(o,m,g);I=m+a.shift(),k=g+a.shift(),w=I+a.shift(),y=k+a.shift(),m=w+a.shift(),g=y+a.shift(),n.U.P.curveTo(o,I,k,w,y,m,g)}else if(_=="o26")for(a.length%2&&(m+=a.shift());a.length>0;)I=m,k=g+a.shift(),m=w=I+a.shift(),g=(y=k+a.shift())+a.shift(),n.U.P.curveTo(o,I,k,w,y,m,g);else if(_=="o27")for(a.length%2&&(g+=a.shift());a.length>0;)k=g,w=(I=m+a.shift())+a.shift(),y=k+a.shift(),m=w+a.shift(),g=y,n.U.P.curveTo(o,I,k,w,y,m,g);else if(_=="o10"||_=="o29"){var E=_=="o10"?i:r;if(a.length==0)console.debug("error: empty stack");else{var S=a.pop(),N=E.Subrs[S+E.Bias];e.x=m,e.y=g,e.nStems=l,e.haveWidth=c,e.width=d,e.open=h,n.U._drawCFF(N,e,r,i,o),m=e.x,g=e.y,l=e.nStems,c=e.haveWidth,d=e.width,h=e.open}}else if(_=="o30"||_=="o31"){var P=a.length,z=(ae=0,_=="o31");for(ae+=P-(B=-3&P);ae<B;)z?(k=g,w=(I=m+a.shift())+a.shift(),g=(y=k+a.shift())+a.shift(),B-ae==5?(m=w+a.shift(),ae++):m=w,z=!1):(I=m,k=g+a.shift(),w=I+a.shift(),y=k+a.shift(),m=w+a.shift(),B-ae==5?(g=y+a.shift(),ae++):g=y,z=!0),n.U.P.curveTo(o,I,k,w,y,m,g),ae+=4}else{if((_+"").charAt(0)=="o")throw console.debug("Unknown operation: "+_,t),_;a.push(_)}}}e.x=m,e.y=g,e.nStems=l,e.haveWidth=c,e.width=d,e.open=h};var f=n,u={Typr:f};return s.Typr=f,s.default=u,Object.defineProperty(s,"__esModule",{value:!0}),s}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Fs(){return function(s){var n=Uint8Array,f=Uint16Array,u=Uint32Array,t=new n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),r=new n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),i=function(_,B){for(var C=new f(31),X=0;X<31;++X)C[X]=B+=1<<_[X-1];var j=new u(C[30]);for(X=1;X<30;++X)for(var ae=C[X];ae<C[X+1];++ae)j[ae]=ae-C[X]<<5|X;return[C,j]},o=i(t,2),a=o[0],l=o[1];a[28]=258,l[258]=28;for(var c=i(e,0)[0],d=new f(32768),h=0;h<32768;++h){var v=(43690&h)>>>1|(21845&h)<<1;v=(61680&(v=(52428&v)>>>2|(13107&v)<<2))>>>4|(3855&v)<<4,d[h]=((65280&v)>>>8|(255&v)<<8)>>>1}var m=function(_,B,C){for(var X=_.length,j=0,ae=new f(B);j<X;++j)++ae[_[j]-1];var re,b=new f(B);for(j=0;j<B;++j)b[j]=b[j-1]+ae[j-1]<<1;{re=new f(1<<B);var R=15-B;for(j=0;j<X;++j)if(_[j])for(var p=j<<4|_[j],T=B-_[j],A=b[_[j]-1]++<<T,E=A|(1<<T)-1;A<=E;++A)re[d[A]>>>R]=p}return re},g=new n(288);for(h=0;h<144;++h)g[h]=8;for(h=144;h<256;++h)g[h]=9;for(h=256;h<280;++h)g[h]=7;for(h=280;h<288;++h)g[h]=8;var I=new n(32);for(h=0;h<32;++h)I[h]=5;var k=m(g,9),w=m(I,5),y=function(_){for(var B=_[0],C=1;C<_.length;++C)_[C]>B&&(B=_[C]);return B},x=function(_,B,C){var X=B/8|0;return(_[X]|_[X+1]<<8)>>(7&B)&C},O=function(_,B){var C=B/8|0;return(_[C]|_[C+1]<<8|_[C+2]<<16)>>(7&B)},U=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],M=function(_,B,C){var X=new Error(B||U[_]);if(X.code=_,Error.captureStackTrace&&Error.captureStackTrace(X,M),!C)throw X;return X},V=function(_,B,C){var X=_.length;if(!X||C&&!C.l&&X<5)return B||new n(0);var j=!B||C,ae=!C||C.i;C||(C={}),B||(B=new n(3*X));var re,b=function(fe){var pe=B.length;if(fe>pe){var _e=new n(Math.max(2*pe,fe));_e.set(B),B=_e}},R=C.f||0,p=C.p||0,T=C.b||0,A=C.l,E=C.d,S=C.m,N=C.n,P=8*X;do{if(!A){C.f=R=x(_,p,1);var z=x(_,p+1,3);if(p+=3,!z){var q=_[(te=((re=p)/8|0)+(7&re&&1)+4)-4]|_[te-3]<<8,F=te+q;if(F>X){ae&&M(0);break}j&&b(T+q),B.set(_.subarray(te,F),T),C.b=T+=q,C.p=p=8*F;continue}if(z==1)A=k,E=w,S=9,N=5;else if(z==2){var D=x(_,p,31)+257,L=x(_,p+10,15)+4,Z=D+x(_,p+5,31)+1;p+=14;for(var K=new n(Z),Y=new n(19),J=0;J<L;++J)Y[r[J]]=x(_,p+3*J,7);p+=3*L;var Q=y(Y),H=(1<<Q)-1,oe=m(Y,Q);for(J=0;J<Z;){var te,W=oe[x(_,p,H)];if(p+=15&W,(te=W>>>4)<16)K[J++]=te;else{var se=0,ne=0;for(te==16?(ne=3+x(_,p,3),p+=2,se=K[J-1]):te==17?(ne=3+x(_,p,7),p+=3):te==18&&(ne=11+x(_,p,127),p+=7);ne--;)K[J++]=se}}var ie=K.subarray(0,D),$=K.subarray(D);S=y(ie),N=y($),A=m(ie,S),E=m($,N)}else M(1);if(p>P){ae&&M(0);break}}j&&b(T+131072);for(var Se=(1<<S)-1,le=(1<<N)-1,ue=p;;ue=p){var ce=(se=A[O(_,p)&Se])>>>4;if((p+=15&se)>P){ae&&M(0);break}if(se||M(2),ce<256)B[T++]=ce;else{if(ce==256){ue=p,A=null;break}var me=ce-254;if(ce>264){var De=t[J=ce-257];me=x(_,p,(1<<De)-1)+a[J],p+=De}var Ae=E[O(_,p)&le],he=Ae>>>4;if(Ae||M(3),p+=15&Ae,$=c[he],he>3&&(De=e[he],$+=O(_,p)&(1<<De)-1,p+=De),p>P){ae&&M(0);break}j&&b(T+131072);for(var ge=T+me;T<ge;T+=4)B[T]=B[T-$],B[T+1]=B[T+1-$],B[T+2]=B[T+2-$],B[T+3]=B[T+3-$];T=ge}}C.l=A,C.p=ue,C.b=T,A&&(R=1,C.m=S,C.d=E,C.n=N)}while(!R);return T==B.length?B:function(fe,pe,_e){(_e==null||_e>fe.length)&&(_e=fe.length);var ze=new(fe instanceof f?f:fe instanceof u?u:n)(_e-pe);return ze.set(fe.subarray(pe,_e)),ze}(B,0,T)},G=new n(0),ee=typeof TextDecoder<"u"&&new TextDecoder;try{ee.decode(G,{stream:!0})}catch{}return s.convert_streams=function(_){var B=new DataView(_),C=0;function X(){var D=B.getUint16(C);return C+=2,D}function j(){var D=B.getUint32(C);return C+=4,D}function ae(D){q.setUint16(F,D),F+=2}function re(D){q.setUint32(F,D),F+=4}for(var b={signature:j(),flavor:j(),length:j(),numTables:X(),reserved:X(),totalSfntSize:j(),majorVersion:X(),minorVersion:X(),metaOffset:j(),metaLength:j(),metaOrigLength:j(),privOffset:j(),privLength:j()},R=0;Math.pow(2,R)<=b.numTables;)R++;R--;for(var p=16*Math.pow(2,R),T=16*b.numTables-p,A=12,E=[],S=0;S<b.numTables;S++)E.push({tag:j(),offset:j(),compLength:j(),origLength:j(),origChecksum:j()}),A+=16;var N,P=new Uint8Array(12+16*E.length+E.reduce(function(D,L){return D+L.origLength+4},0)),z=P.buffer,q=new DataView(z),F=0;return re(b.flavor),ae(b.numTables),ae(p),ae(R),ae(T),E.forEach(function(D){re(D.tag),re(D.origChecksum),re(A),re(D.origLength),D.outOffset=A,(A+=D.origLength)%4!=0&&(A+=4-A%4)}),E.forEach(function(D){var L,Z=_.slice(D.offset,D.offset+D.compLength);if(D.compLength!=D.origLength){var K=new Uint8Array(D.origLength);L=new Uint8Array(Z,2),V(L,K)}else K=new Uint8Array(Z);P.set(K,D.outOffset);var Y=0;(A=D.outOffset+D.origLength)%4!=0&&(Y=4-A%4),P.set(new Uint8Array(Y).buffer,D.outOffset+D.origLength),N=A+Y}),z.slice(0,N)},Object.defineProperty(s,"__esModule",{value:!0}),s}({}).convert_streams}function Ms(s,n){const f={M:2,L:2,Q:4,C:6,Z:0},u={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},t=1,e=2,r=4,i=8,o=16,a=32;let l;function c(U){if(!l){const M={R:e,L:t,D:r,C:o,U:a,T:i};l=new Map;for(let V in u){let G=0;u[V].split(",").forEach(ee=>{let[_,B]=ee.split("+");_=parseInt(_,36),B=B?parseInt(B,36):0,l.set(G+=_,M[V]);for(let C=B;C--;)l.set(++G,M[V])})}}return l.get(U)||a}const d=1,h=2,v=3,m=4,g=[null,"isol","init","fina","medi"];function I(U){const M=new Uint8Array(U.length);let V=a,G=d,ee=-1;for(let _=0;_<U.length;_++){const B=U.codePointAt(_);let C=c(B)|0,X=d;C&i||(V&(t|r|o)?C&(e|r|o)?(X=v,(G===d||G===v)&&M[ee]++):C&(t|a)&&(G===h||G===m)&&M[ee]--:V&(e|a)&&(G===h||G===m)&&M[ee]--,G=M[_]=X,V=C,ee=_,B>65535&&_++)}return M}function k(U,M){const V=[];for(let ee=0;ee<M.length;ee++){const _=M.codePointAt(ee);_>65535&&ee++,V.push(s.U.codeToGlyph(U,_))}const G=U.GSUB;if(G){const{lookupList:ee,featureList:_}=G;let B;const C=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,X=[];_.forEach(j=>{if(C.test(j.tag))for(let ae=0;ae<j.tab.length;ae++){if(X[j.tab[ae]])continue;X[j.tab[ae]]=!0;const re=ee[j.tab[ae]],b=/^(isol|init|fina|medi)$/.test(j.tag);b&&!B&&(B=I(M));for(let R=0;R<V.length;R++)(!B||!b||g[B[R]]===j.tag)&&s.U._applySubs(V,R,re,ee)}})}return V}function w(U,M){const V=new Int16Array(M.length*3);let G=0;for(;G<M.length;G++){const C=M[G];if(C===-1)continue;V[G*3+2]=U.hmtx.aWidth[C];const X=U.GPOS;if(X){const j=X.lookupList;for(let ae=0;ae<j.length;ae++){const re=j[ae];for(let b=0;b<re.tabs.length;b++){const R=re.tabs[b];if(re.ltype===1){if(s._lctf.coverageIndex(R.coverage,C)!==-1&&R.pos){B(R.pos,G);break}}else if(re.ltype===2){let p=null,T=ee();if(T!==-1){const A=s._lctf.coverageIndex(R.coverage,M[T]);if(A!==-1){if(R.fmt===1){const E=R.pairsets[A];for(let S=0;S<E.length;S++)E[S].gid2===C&&(p=E[S])}else if(R.fmt===2){const E=s.U._getGlyphClass(M[T],R.classDef1),S=s.U._getGlyphClass(C,R.classDef2);p=R.matrix[E][S]}if(p){p.val1&&B(p.val1,T),p.val2&&B(p.val2,G);break}}}}else if(re.ltype===4){const p=s._lctf.coverageIndex(R.markCoverage,C);if(p!==-1){const T=ee(_),A=T===-1?-1:s._lctf.coverageIndex(R.baseCoverage,M[T]);if(A!==-1){const E=R.markArray[p],S=R.baseArray[A][E.markClass];V[G*3]=S.x-E.x+V[T*3]-V[T*3+2],V[G*3+1]=S.y-E.y+V[T*3+1];break}}}else if(re.ltype===6){const p=s._lctf.coverageIndex(R.mark1Coverage,C);if(p!==-1){const T=ee();if(T!==-1){const A=M[T];if(y(U,A)===3){const E=s._lctf.coverageIndex(R.mark2Coverage,A);if(E!==-1){const S=R.mark1Array[p],N=R.mark2Array[E][S.markClass];V[G*3]=N.x-S.x+V[T*3]-V[T*3+2],V[G*3+1]=N.y-S.y+V[T*3+1];break}}}}}}}}else if(U.kern&&!U.cff){const j=ee();if(j!==-1){const ae=U.kern.glyph1.indexOf(M[j]);if(ae!==-1){const re=U.kern.rval[ae].glyph2.indexOf(C);re!==-1&&(V[j*3+2]+=U.kern.rval[ae].vals[re])}}}}return V;function ee(C){for(let X=G-1;X>=0;X--)if(M[X]!==-1&&(!C||C(M[X])))return X;return-1}function _(C){return y(U,C)===1}function B(C,X){for(let j=0;j<3;j++)V[X*3+j]+=C[j]||0}}function y(U,M){const V=U.GDEF&&U.GDEF.glyphClassDef;return V?s.U._getGlyphClass(M,V):0}function x(...U){for(let M=0;M<U.length;M++)if(typeof U[M]=="number")return U[M]}function O(U){const M=Object.create(null),V=U["OS/2"],G=U.hhea,ee=U.head.unitsPerEm,_=x(V&&V.sTypoAscender,G&&G.ascender,ee),B={unitsPerEm:ee,ascender:_,descender:x(V&&V.sTypoDescender,G&&G.descender,0),capHeight:x(V&&V.sCapHeight,_),xHeight:x(V&&V.sxHeight,_),lineGap:x(V&&V.sTypoLineGap,G&&G.lineGap),supportsCodePoint(C){return s.U.codeToGlyph(U,C)>0},forEachGlyph(C,X,j,ae){let re=0;const b=1/B.unitsPerEm*X,R=k(U,C);let p=0;const T=w(U,R);return R.forEach((A,E)=>{if(A!==-1){let S=M[A];if(!S){const{cmds:N,crds:P}=s.U.glyphToPath(U,A);let z="",q=0;for(let K=0,Y=N.length;K<Y;K++){const J=f[N[K]];z+=N[K];for(let Q=1;Q<=J;Q++)z+=(Q>1?",":"")+P[q++]}let F,D,L,Z;if(P.length){F=D=1/0,L=Z=-1/0;for(let K=0,Y=P.length;K<Y;K+=2){let J=P[K],Q=P[K+1];J<F&&(F=J),Q<D&&(D=Q),J>L&&(L=J),Q>Z&&(Z=Q)}}else F=L=D=Z=0;S=M[A]={index:A,advanceWidth:U.hmtx.aWidth[A],xMin:F,yMin:D,xMax:L,yMax:Z,path:z}}ae.call(null,S,re+T[E*3]*b,T[E*3+1]*b,p),re+=T[E*3+2]*b,j&&(re+=j*X)}p+=C.codePointAt(p)>65535?2:1}),re}};return B}return function(M){const V=new Uint8Array(M,0,4),G=s._bin.readASCII(V,0,4);if(G==="wOFF")M=n(M);else if(G==="wOF2")throw new Error("woff2 fonts not supported");return O(s.parse(M)[0])}}const Es=jt({name:"Typr Font Parser",dependencies:[As,Fs,Ms],init(s,n,f){const u=s(),t=n();return f(u,t)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Ls(){return function(s){var n=function(){this.buckets=new Map};n.prototype.add=function(w){var y=w>>5;this.buckets.set(y,(this.buckets.get(y)||0)|1<<(31&w))},n.prototype.has=function(w){var y=this.buckets.get(w>>5);return y!==void 0&&(y&1<<(31&w))!=0},n.prototype.serialize=function(){var w=[];return this.buckets.forEach(function(y,x){w.push((+x).toString(36)+":"+y.toString(36))}),w.join(",")},n.prototype.deserialize=function(w){var y=this;this.buckets.clear(),w.split(",").forEach(function(x){var O=x.split(":");y.buckets.set(parseInt(O[0],36),parseInt(O[1],36))})};var f=Math.pow(2,8),u=f-1,t=~u;function e(w){var y=function(O){return O&t}(w).toString(16),x=function(O){return(O&t)+f-1}(w).toString(16);return"codepoint-index/plane"+(w>>16)+"/"+y+"-"+x+".json"}function r(w,y){var x=w&u,O=y.codePointAt(x/6|0);return((O=(O||48)-48)&1<<x%6)!=0}function i(w,y){var x;(x=w,x.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(O){return O.split("-").map(function(U){return parseInt(U.trim(),16)})})).forEach(function(O){var U=O[0],M=O[1];M===void 0&&(M=U),y(U,M)})}function o(w,y){i(w,function(x,O){for(var U=x;U<=O;U++)y(U)})}var a={},l={},c=new WeakMap,d="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function h(w){var y=c.get(w);return y||(y=new n,o(w.ranges,function(x){return y.add(x)}),c.set(w,y)),y}var v,m=new Map;function g(w,y,x){return w[y]?y:w[x]?x:function(O){for(var U in O)return U}(w)}function I(w,y){var x=y;if(!w.includes(x)){x=1/0;for(var O=0;O<w.length;O++)Math.abs(w[O]-y)<Math.abs(x-y)&&(x=w[O])}return x}function k(w){return v||(v=new Set,o("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(y){v.add(y)})),v.has(w)}return s.CodePointSet=n,s.clearCache=function(){a={},l={}},s.getFontsForString=function(w,y){y===void 0&&(y={});var x,O=y.lang;O===void 0&&(O=new RegExp("\\p{Script=Hangul}","u").test(x=w)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(x)?"ja":"en");var U=y.category;U===void 0&&(U="sans-serif");var M=y.style;M===void 0&&(M="normal");var V=y.weight;V===void 0&&(V=400);var G=(y.dataUrl||d).replace(/\/$/g,""),ee=new Map,_=new Uint8Array(w.length),B={},C={},X=new Array(w.length),j=new Map,ae=!1;function re(p){var T=m.get(p);return T||(T=fetch(G+"/"+p).then(function(A){if(!A.ok)throw new Error(A.statusText);return A.json().then(function(E){if(!Array.isArray(E)||E[0]!==1)throw new Error("Incorrect schema version; need 1, got "+E[0]);return E[1]})}).catch(function(A){if(G!==d)return ae||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+G+'", trying default CDN. '+A.message),ae=!0),G=d,m.delete(p),re(p);throw A}),m.set(p,T)),T}for(var b=function(p){var T=w.codePointAt(p),A=e(T);X[p]=A,a[A]||j.has(A)||j.set(A,re(A).then(function(E){a[A]=E})),T>65535&&(p++,R=p)},R=0;R<w.length;R++)b(R);return Promise.all(j.values()).then(function(){j.clear();for(var p=function(A){var E=w.codePointAt(A),S=null,N=a[X[A]],P=void 0;for(var z in N){var q=C[z];if(q===void 0&&(q=C[z]=new RegExp(z).test(O||"en")),q){for(var F in P=z,N[z])if(r(E,N[z][F])){S=F;break}break}}if(!S){e:for(var D in N)if(D!==P){for(var L in N[D])if(r(E,N[D][L])){S=L;break e}}}S||(console.debug("No font coverage for U+"+E.toString(16)),S="latin"),X[A]=S,l[S]||j.has(S)||j.set(S,re("font-meta/"+S+".json").then(function(Z){l[S]=Z})),E>65535&&(A++,T=A)},T=0;T<w.length;T++)p(T);return Promise.all(j.values())}).then(function(){for(var p,T=null,A=0;A<w.length;A++){var E=w.codePointAt(A);if(T&&(k(E)||h(T).has(E)))_[A]=_[A-1];else{T=l[X[A]];var S=B[T.id];if(!S){var N=T.typeforms,P=g(N,U,"sans-serif"),z=g(N[P],M,"normal"),q=I((p=N[P])===null||p===void 0?void 0:p[z],V);S=B[T.id]=G+"/font-files/"+T.id+"/"+P+"."+z+"."+q+".woff"}var F=ee.get(S);F==null&&(F=ee.size,ee.set(S,F)),_[A]=F}E>65535&&(A++,_[A]=_[A-1])}return{fontUrls:Array.from(ee.keys()),chars:_}})},Object.defineProperty(s,"__esModule",{value:!0}),s}({})}function Rs(s,n){const f=Object.create(null),u=Object.create(null);function t(r,i){const o=a=>{console.error(`Failure loading font ${r}`,a)};try{const a=new XMLHttpRequest;a.open("get",r,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status>=400)o(new Error(a.statusText));else if(a.status>0)try{const l=s(a.response);l.src=r,i(l)}catch(l){o(l)}},a.onerror=o,a.send()}catch(a){o(a)}}function e(r,i){let o=f[r];o?i(o):u[r]?u[r].push(i):(u[r]=[i],t(r,a=>{a.src=r,f[r]=a,u[r].forEach(l=>l(a)),delete u[r]}))}return function(r,i,{lang:o,fonts:a=[],style:l="normal",weight:c="normal",unicodeFontsURL:d}={}){const h=new Uint8Array(r.length),v=[];r.length||k();const m=new Map,g=[];if(l!=="italic"&&(l="normal"),typeof c!="number"&&(c=c==="bold"?700:400),a&&!Array.isArray(a)&&(a=[a]),a=a.slice().filter(y=>!y.lang||y.lang.test(o)).reverse(),a.length){let U=0;(function M(V=0){for(let G=V,ee=r.length;G<ee;G++){const _=r.codePointAt(G);if(U===1&&v[h[G-1]].supportsCodePoint(_)||G>0&&/\s/.test(r[G]))h[G]=h[G-1],U===2&&(g[g.length-1][1]=G);else for(let B=h[G],C=a.length;B<=C;B++)if(B===C){const X=U===2?g[g.length-1]:g[g.length]=[G,G];X[1]=G,U=2}else{h[G]=B;const{src:X,unicodeRange:j}=a[B];if(!j||w(_,j)){const ae=f[X];if(!ae){e(X,()=>{M(G)});return}if(ae.supportsCodePoint(_)){let re=m.get(ae);typeof re!="number"&&(re=v.length,v.push(ae),m.set(ae,re)),h[G]=re,U=1;break}}}_>65535&&G+1<ee&&(h[G+1]=h[G],G++,U===2&&(g[g.length-1][1]=G))}I()})()}else g.push([0,r.length-1]),I();function I(){if(g.length){const y=g.map(x=>r.substring(x[0],x[1]+1)).join(`
`);n.getFontsForString(y,{lang:o||void 0,style:l,weight:c,dataUrl:d}).then(({fontUrls:x,chars:O})=>{const U=v.length;let M=0;g.forEach(G=>{for(let ee=0,_=G[1]-G[0];ee<=_;ee++)h[G[0]+ee]=O[M++]+U;M++});let V=0;x.forEach((G,ee)=>{e(G,_=>{v[ee+U]=_,++V===x.length&&k()})})})}else k()}function k(){i({chars:h,fonts:v})}function w(y,x){for(let O=0;O<x.length;O++){const[U,M=U]=x[O];if(U<=y&&y<=M)return!0}return!1}}}const Ps=jt({name:"FontResolver",dependencies:[Rs,Es,Ls],init(s,n,f){return s(n,f())}});function Os(s,n){const u=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,t="[^\\S\\u00A0]",e=new RegExp(`${t}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function r({text:v,lang:m,fonts:g,style:I,weight:k,preResolvedFonts:w,unicodeFontsURL:y},x){const O=({chars:U,fonts:M})=>{let V,G;const ee=[];for(let _=0;_<U.length;_++)U[_]!==G?(G=U[_],ee.push(V={start:_,end:_,fontObj:M[U[_]]})):V.end=_;x(ee)};w?O(w):s(v,O,{lang:m,fonts:g,style:I,weight:k,unicodeFontsURL:y})}function i({text:v="",font:m,lang:g,sdfGlyphSize:I=64,fontSize:k=400,fontWeight:w=1,fontStyle:y="normal",letterSpacing:x=0,lineHeight:O="normal",maxWidth:U=1/0,direction:M,textAlign:V="left",textIndent:G=0,whiteSpace:ee="normal",overflowWrap:_="normal",anchorX:B=0,anchorY:C=0,metricsOnly:X=!1,unicodeFontsURL:j,preResolvedFonts:ae=null,includeCaretPositions:re=!1,chunkedBoundsSize:b=8192,colorRanges:R=null},p){const T=c(),A={fontLoad:0,typesetting:0};v.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),v=v.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),k=+k,x=+x,U=+U,O=O||"normal",G=+G,r({text:v,lang:g,style:y,weight:w,fonts:typeof m=="string"?[{src:m}]:m,unicodeFontsURL:j,preResolvedFonts:ae},E=>{A.fontLoad=c()-T;const S=isFinite(U);let N=null,P=null,z=null,q=null,F=null,D=null,L=null,Z=null,K=0,Y=0,J=ee!=="nowrap";const Q=new Map,H=c();let oe=G,te=0,W=new d;const se=[W];E.forEach(le=>{const{fontObj:ue}=le,{ascender:ce,descender:me,unitsPerEm:De,lineGap:Ae,capHeight:he,xHeight:ge}=ue;let fe=Q.get(ue);if(!fe){const ve=k/De,Ue=O==="normal"?(ce-me+Ae)*ve:O*k,rt=(Ue-(ce-me)*ve)/2,Ce=Math.min(Ue,(ce-me)*ve),Te=(ce+me)/2*ve+Ce/2;fe={index:Q.size,src:ue.src,fontObj:ue,fontSizeMult:ve,unitsPerEm:De,ascender:ce*ve,descender:me*ve,capHeight:he*ve,xHeight:ge*ve,lineHeight:Ue,baseline:-rt-ce*ve,caretTop:Te,caretBottom:Te-Ce},Q.set(ue,fe)}const{fontSizeMult:pe}=fe,_e=v.slice(le.start,le.end+1);let ze,Fe;ue.forEachGlyph(_e,k,x,(ve,Ue,rt,Ce)=>{Ue+=te,Ce+=le.start,ze=Ue,Fe=ve;const Te=v.charAt(Ce),Ie=ve.advanceWidth*pe,Me=W.count;let ye;if("isEmpty"in ve||(ve.isWhitespace=!!Te&&new RegExp(t).test(Te),ve.canBreakAfter=!!Te&&e.test(Te),ve.isEmpty=ve.xMin===ve.xMax||ve.yMin===ve.yMax||u.test(Te)),!ve.isWhitespace&&!ve.isEmpty&&Y++,J&&S&&!ve.isWhitespace&&Ue+Ie+oe>U&&Me){if(W.glyphAt(Me-1).glyphObj.canBreakAfter)ye=new d,oe=-Ue;else for(let we=Me;we--;)if(we===0&&_==="break-word"){ye=new d,oe=-Ue;break}else if(W.glyphAt(we).glyphObj.canBreakAfter){ye=W.splitAt(we+1);const Be=ye.glyphAt(0).x;oe-=Be;for(let Pe=ye.count;Pe--;)ye.glyphAt(Pe).x-=Be;break}ye&&(W.isSoftWrapped=!0,W=ye,se.push(W),K=U)}let Ee=W.glyphAt(W.count);Ee.glyphObj=ve,Ee.x=Ue+oe,Ee.y=rt,Ee.width=Ie,Ee.charIndex=Ce,Ee.fontData=fe,Te===`
`&&(W=new d,se.push(W),oe=-(Ue+Ie+x*k)+G)}),te=ze+Fe.advanceWidth*pe+x*k});let ne=0;se.forEach(le=>{let ue=!0;for(let ce=le.count;ce--;){const me=le.glyphAt(ce);ue&&!me.glyphObj.isWhitespace&&(le.width=me.x+me.width,le.width>K&&(K=le.width),ue=!1);let{lineHeight:De,capHeight:Ae,xHeight:he,baseline:ge}=me.fontData;De>le.lineHeight&&(le.lineHeight=De);const fe=ge-le.baseline;fe<0&&(le.baseline+=fe,le.cap+=fe,le.ex+=fe),le.cap=Math.max(le.cap,le.baseline+Ae),le.ex=Math.max(le.ex,le.baseline+he)}le.baseline-=ne,le.cap-=ne,le.ex-=ne,ne+=le.lineHeight});let ie=0,$=0;if(B&&(typeof B=="number"?ie=-B:typeof B=="string"&&(ie=-K*(B==="left"?0:B==="center"?.5:B==="right"?1:a(B)))),C&&(typeof C=="number"?$=-C:typeof C=="string"&&($=C==="top"?0:C==="top-baseline"?-se[0].baseline:C==="top-cap"?-se[0].cap:C==="top-ex"?-se[0].ex:C==="middle"?ne/2:C==="bottom"?ne:C==="bottom-baseline"?-se[se.length-1].baseline:a(C)*ne)),!X){const le=n.getEmbeddingLevels(v,M);N=new Uint16Array(Y),P=new Uint8Array(Y),z=new Float32Array(Y*2),q={},L=[1/0,1/0,-1/0,-1/0],Z=[],re&&(D=new Float32Array(v.length*4)),R&&(F=new Uint8Array(Y*3));let ue=0,ce=-1,me=-1,De,Ae;if(se.forEach((he,ge)=>{let{count:fe,width:pe}=he;if(fe>0){let _e=0;for(let Ce=fe;Ce--&&he.glyphAt(Ce).glyphObj.isWhitespace;)_e++;let ze=0,Fe=0;if(V==="center")ze=(K-pe)/2;else if(V==="right")ze=K-pe;else if(V==="justify"&&he.isSoftWrapped){let Ce=0;for(let Te=fe-_e;Te--;)he.glyphAt(Te).glyphObj.isWhitespace&&Ce++;Fe=(K-pe)/Ce}if(Fe||ze){let Ce=0;for(let Te=0;Te<fe;Te++){let Ie=he.glyphAt(Te);const Me=Ie.glyphObj;Ie.x+=ze+Ce,Fe!==0&&Me.isWhitespace&&Te<fe-_e&&(Ce+=Fe,Ie.width+=Fe)}}const ve=n.getReorderSegments(v,le,he.glyphAt(0).charIndex,he.glyphAt(he.count-1).charIndex);for(let Ce=0;Ce<ve.length;Ce++){const[Te,Ie]=ve[Ce];let Me=1/0,ye=-1/0;for(let Ee=0;Ee<fe;Ee++)if(he.glyphAt(Ee).charIndex>=Te){let we=Ee,Be=Ee;for(;Be<fe;Be++){let Pe=he.glyphAt(Be);if(Pe.charIndex>Ie)break;Be<fe-_e&&(Me=Math.min(Me,Pe.x),ye=Math.max(ye,Pe.x+Pe.width))}for(let Pe=we;Pe<Be;Pe++){const Ge=he.glyphAt(Pe);Ge.x=ye-(Ge.x+Ge.width-Me)}break}}let Ue;const rt=Ce=>Ue=Ce;for(let Ce=0;Ce<fe;Ce++){const Te=he.glyphAt(Ce);Ue=Te.glyphObj;const Ie=Ue.index,Me=le.levels[Te.charIndex]&1;if(Me){const ye=n.getMirroredCharacter(v[Te.charIndex]);ye&&Te.fontData.fontObj.forEachGlyph(ye,0,0,rt)}if(re){const{charIndex:ye,fontData:Ee}=Te,we=Te.x+ie,Be=Te.x+Te.width+ie;D[ye*4]=Me?Be:we,D[ye*4+1]=Me?we:Be,D[ye*4+2]=he.baseline+Ee.caretBottom+$,D[ye*4+3]=he.baseline+Ee.caretTop+$;const Pe=ye-ce;Pe>1&&l(D,ce,Pe),ce=ye}if(R){const{charIndex:ye}=Te;for(;ye>me;)me++,R.hasOwnProperty(me)&&(Ae=R[me])}if(!Ue.isWhitespace&&!Ue.isEmpty){const ye=ue++,{fontSizeMult:Ee,src:we,index:Be}=Te.fontData,Pe=q[we]||(q[we]={});Pe[Ie]||(Pe[Ie]={path:Ue.path,pathBounds:[Ue.xMin,Ue.yMin,Ue.xMax,Ue.yMax]});const Ge=Te.x+ie,ot=Te.y+he.baseline+$;z[ye*2]=Ge,z[ye*2+1]=ot;const dt=Ge+Ue.xMin*Ee,pt=ot+Ue.yMin*Ee,bt=Ge+Ue.xMax*Ee,ht=ot+Ue.yMax*Ee;dt<L[0]&&(L[0]=dt),pt<L[1]&&(L[1]=pt),bt>L[2]&&(L[2]=bt),ht>L[3]&&(L[3]=ht),ye%b===0&&(De={start:ye,end:ye,rect:[1/0,1/0,-1/0,-1/0]},Z.push(De)),De.end++;const Ke=De.rect;if(dt<Ke[0]&&(Ke[0]=dt),pt<Ke[1]&&(Ke[1]=pt),bt>Ke[2]&&(Ke[2]=bt),ht>Ke[3]&&(Ke[3]=ht),N[ye]=Ie,P[ye]=Be,R){const Tt=ye*3;F[Tt]=Ae>>16&255,F[Tt+1]=Ae>>8&255,F[Tt+2]=Ae&255}}}}}),D){const he=v.length-ce;he>1&&l(D,ce,he)}}const Se=[];Q.forEach(({index:le,src:ue,unitsPerEm:ce,ascender:me,descender:De,lineHeight:Ae,capHeight:he,xHeight:ge})=>{Se[le]={src:ue,unitsPerEm:ce,ascender:me,descender:De,lineHeight:Ae,capHeight:he,xHeight:ge}}),A.typesetting=c()-H,p({glyphIds:N,glyphFontIndices:P,glyphPositions:z,glyphData:q,fontData:Se,caretPositions:D,glyphColors:F,chunkedBounds:Z,fontSize:k,topBaseline:$+se[0].baseline,blockBounds:[ie,$-ne,ie+K,$],visibleBounds:L,timings:A})})}function o(v,m){i({...v,metricsOnly:!0},g=>{const[I,k,w,y]=g.blockBounds;m({width:w-I,height:y-k})})}function a(v){let m=v.match(/^([\d.]+)%$/),g=m?parseFloat(m[1]):NaN;return isNaN(g)?0:g/100}function l(v,m,g){const I=v[m*4],k=v[m*4+1],w=v[m*4+2],y=v[m*4+3],x=(k-I)/g;for(let O=0;O<g;O++){const U=(m+O)*4;v[U]=I+x*O,v[U+1]=I+x*(O+1),v[U+2]=w,v[U+3]=y}}function c(){return(self.performance||Date).now()}function d(){this.data=[]}const h=["glyphObj","x","y","width","charIndex","fontData"];return d.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/h.length)},glyphAt(v){let m=d.flyweight;return m.data=this.data,m.index=v,m},splitAt(v){let m=new d;return m.data=this.data.splice(v*h.length),m}},d.flyweight=h.reduce((v,m,g,I)=>(Object.defineProperty(v,m,{get(){return this.data[this.index*h.length+g]},set(k){this.data[this.index*h.length+g]=k}}),v),{data:null,index:0}),{typeset:i,measure:o}}const kt=()=>(self.performance||Date).now(),jn=ca();let Lo;function Is(s,n,f,u,t,e,r,i,o,a,l=!0){return l?Gs(s,n,f,u,t,e,r,i,o,a).then(null,c=>(Lo||(console.warn("WebGL SDF generation failed, falling back to JS",c),Lo=!0),Po(s,n,f,u,t,e,r,i,o,a))):Po(s,n,f,u,t,e,r,i,o,a)}const On=[],Bs=5;let Ar=0;function ha(){const s=kt();for(;On.length&&kt()-s<Bs;)On.shift()();Ar=On.length?setTimeout(ha,0):0}const Gs=(...s)=>new Promise((n,f)=>{On.push(()=>{const u=kt();try{jn.webgl.generateIntoCanvas(...s),n({timing:kt()-u})}catch(t){f(t)}}),Ar||(Ar=setTimeout(ha,0))}),Ns=4,Ws=2e3,Ro={};let zs=0;function Po(s,n,f,u,t,e,r,i,o,a){const l="TroikaTextSDFGenerator_JS_"+zs++%Ns;let c=Ro[l];return c||(c=Ro[l]={workerModule:jt({name:l,workerId:l,dependencies:[ca,kt],init(d,h){const v=d().javascript.generate;return function(...m){const g=h();return{textureData:v(...m),timing:h()-g}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),c.requests++,clearTimeout(c.idleTimer),c.workerModule(s,n,f,u,t,e).then(({textureData:d,timing:h})=>{const v=kt(),m=new Uint8Array(d.length*4);for(let g=0;g<d.length;g++)m[g*4+a]=d[g];return jn.webglUtils.renderImageData(r,m,i,o,s,n,1<<3-a),h+=kt()-v,--c.requests===0&&(c.idleTimer=setTimeout(()=>{ys(l)},Ws)),{timing:h}})}function Vs(s){s._warm||(jn.webgl.isSupported(s),s._warm=!0)}const js=jn.webglUtils.resizeWebGLCanvasWithoutClearing,Ot={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048,useWorker:!0},Xs=new Wn;function Lt(){return(self.performance||Date).now()}const Oo=Object.create(null);function Hs(s,n){s=Ks({},s);const f=Lt(),{defaultFontURL:u}=Ot,t=[];if(u&&t.push({label:"default",src:Io(u)}),s.font&&t.push({label:"user",src:Io(s.font)}),s.font=t,s.text=""+s.text,s.sdfGlyphSize=s.sdfGlyphSize||Ot.sdfGlyphSize,s.unicodeFontsURL=s.unicodeFontsURL||Ot.unicodeFontsURL,s.colorRanges!=null){let h={};for(let v in s.colorRanges)if(s.colorRanges.hasOwnProperty(v)){let m=s.colorRanges[v];typeof m!="number"&&(m=Xs.set(m).getHex()),h[v]=m}s.colorRanges=h}Object.freeze(s);const{textureWidth:e,sdfExponent:r}=Ot,{sdfGlyphSize:i}=s,o=e/i*4;let a=Oo[i];if(!a){const h=document.createElement("canvas");h.width=e,h.height=i*256/o,a=Oo[i]={glyphCount:0,sdfGlyphSize:i,sdfCanvas:h,sdfTexture:new Va(h,void 0,void 0,void 0,uo,uo),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,Ys(a)}const{sdfTexture:l,sdfCanvas:c}=a;ma(s).then(h=>{const{glyphIds:v,glyphFontIndices:m,fontData:g,glyphPositions:I,fontSize:k,timings:w}=h,y=[],x=new Float32Array(v.length*4);let O=0,U=0;const M=Lt(),V=g.map(C=>{let X=a.glyphsByFont.get(C.src);return X||a.glyphsByFont.set(C.src,X=new Map),X});v.forEach((C,X)=>{const j=m[X],{src:ae,unitsPerEm:re}=g[j];let b=V[j].get(C);if(!b){const{path:E,pathBounds:S}=h.glyphData[ae][C],N=Math.max(S[2]-S[0],S[3]-S[1])/i*(Ot.sdfMargin*i+.5),P=a.glyphCount++,z=[S[0]-N,S[1]-N,S[2]+N,S[3]+N];V[j].set(C,b={path:E,atlasIndex:P,sdfViewBox:z}),y.push(b)}const{sdfViewBox:R}=b,p=I[U++],T=I[U++],A=k/re;x[O++]=p+R[0]*A,x[O++]=T+R[1]*A,x[O++]=p+R[2]*A,x[O++]=T+R[3]*A,v[X]=b.atlasIndex}),w.quads=(w.quads||0)+(Lt()-M);const G=Lt();w.sdf={};const ee=c.height,_=Math.ceil(a.glyphCount/o),B=Math.pow(2,Math.ceil(Math.log2(_*i)));B>ee&&(console.info(`Increasing SDF texture size ${ee}->${B}`),js(c,e,B),l.dispose()),Promise.all(y.map(C=>pa(C,a,s.gpuAccelerateSDF).then(({timing:X})=>{w.sdf[C.atlasIndex]=X}))).then(()=>{y.length&&!a.contextLost&&(va(a),l.needsUpdate=!0),w.sdfTotal=Lt()-G,w.total=Lt()-f,n(Object.freeze({parameters:s,sdfTexture:l,sdfGlyphSize:i,sdfExponent:r,glyphBounds:x,glyphAtlasIndices:v,glyphColors:h.glyphColors,caretPositions:h.caretPositions,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))})}),Promise.resolve().then(()=>{a.contextLost||Vs(c)})}function pa({path:s,atlasIndex:n,sdfViewBox:f},{sdfGlyphSize:u,sdfCanvas:t,contextLost:e},r){if(e)return Promise.resolve({timing:-1});const{textureWidth:i,sdfExponent:o}=Ot,a=Math.max(f[2]-f[0],f[3]-f[1]),l=Math.floor(n/4),c=l%(i/u)*u,d=Math.floor(l/(i/u))*u,h=n%4;return Is(u,u,s,f,a,o,t,c,d,h,r)}function Ys(s){const n=s.sdfCanvas;n.addEventListener("webglcontextlost",f=>{console.log("Context Lost",f),f.preventDefault(),s.contextLost=!0}),n.addEventListener("webglcontextrestored",f=>{console.log("Context Restored",f),s.contextLost=!1;const u=[];s.glyphsByFont.forEach(t=>{t.forEach(e=>{u.push(pa(e,s,!0))})}),Promise.all(u).then(()=>{va(s),s.sdfTexture.needsUpdate=!0})})}function Ks(s,n){for(let f in n)n.hasOwnProperty(f)&&(s[f]=n[f]);return s}let An;function Io(s){return An||(An=typeof document>"u"?{}:document.createElement("a")),An.href=s,An.href}function va(s){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:n,sdfTexture:f}=s,{width:u,height:t}=n,e=s.sdfCanvas.getContext("webgl");let r=f.image.data;(!r||r.length!==u*t*4)&&(r=new Uint8Array(u*t*4),f.image={width:u,height:t,data:r},f.flipY=!1,f.isDataTexture=!0),e.readPixels(0,0,u,t,e.RGBA,e.UNSIGNED_BYTE,r)}}const Js=jt({name:"Typesetter",dependencies:[Os,Ps,Ts],init(s,n,f){return s(n,f())}}),ma=jt({name:"Typesetter",dependencies:[Js],init(s){return function(n){return new Promise(f=>{s.typeset(n,f)})}},getTransferables(s){const n=[];for(let f in s)s[f]&&s[f].buffer&&n.push(s[f].buffer);return n}});ma.onMainThread;const Bo={};function Zs(s){let n=Bo[s];return n||(n=Bo[s]=new Er(1,1,s,s).translate(.5,.5,0)),n}const qs="aTroikaGlyphBounds",Go="aTroikaGlyphIndex",Qs="aTroikaGlyphColor";class $s extends ja{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Xa,this.boundingBox=new Xo}computeBoundingSphere(){}computeBoundingBox(){}set detail(n){if(n!==this._detail){this._detail=n,(typeof n!="number"||n<1)&&(n=1);let f=Zs(n);["position","normal","uv"].forEach(u=>{this.attributes[u]=f.attributes[u].clone()}),this.setIndex(f.getIndex().clone())}}get detail(){return this._detail}set curveRadius(n){n!==this._curveRadius&&(this._curveRadius=n,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(n,f,u,t,e){this.updateAttributeData(qs,n,4),this.updateAttributeData(Go,f,1),this.updateAttributeData(Qs,e,3),this._blockBounds=u,this._chunkedBounds=t,this.instanceCount=f.length,this._updateBounds()}_updateBounds(){const n=this._blockBounds;if(n){const{curveRadius:f,boundingBox:u}=this;if(f){const{PI:t,floor:e,min:r,max:i,sin:o,cos:a}=Math,l=t/2,c=t*2,d=Math.abs(f),h=n[0]/d,v=n[2]/d,m=e((h+l)/c)!==e((v+l)/c)?-d:r(o(h)*d,o(v)*d),g=e((h-l)/c)!==e((v-l)/c)?d:i(o(h)*d,o(v)*d),I=e((h+t)/c)!==e((v+t)/c)?d*2:i(d-a(h)*d,d-a(v)*d);u.min.set(m,n[1],f<0?-I:0),u.max.set(g,n[3],f<0?0:I)}else u.min.set(n[0],n[1],0),u.max.set(n[2],n[3],0);u.getBoundingSphere(this.boundingSphere)}}applyClipRect(n){let f=this.getAttribute(Go).count,u=this._chunkedBounds;if(u)for(let t=u.length;t--;){f=u[t].end;let e=u[t].rect;if(e[1]<n.w&&e[3]>n.y&&e[0]<n.z&&e[2]>n.x)break}this.instanceCount=f}updateAttributeData(n,f,u){const t=this.getAttribute(n);f?t&&t.array.length===f.length?(t.array.set(f),t.needsUpdate=!0):(this.setAttribute(n,new Ha(f,u)),delete this._maxInstanceCount,this.dispose()):t&&this.deleteAttribute(n)}}const el=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,tl=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,nl=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,rl=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function ol(s){const n=Dr(s,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new In},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new fo(0,0,0,0)},uTroikaClipRect:{value:new fo(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new In},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Wn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Ya},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:el,vertexTransform:tl,fragmentDefs:nl,fragmentColorTransform:rl,customRewriter({vertexShader:f,fragmentShader:u}){let t=/\buniform\s+vec3\s+diffuse\b/;return t.test(u)&&(u=u.replace(t,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),t.test(f)||(f=f.replace(da,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:f,fragmentShader:u}}});return n.transparent=!0,n.forceSinglePass=!0,Object.defineProperties(n,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),n}const Br=new Ka({color:16777215,side:Ja,transparent:!0}),No=8421504,Wo=new Za,Fn=new Mr,_r=new Mr,rn=[],al=new Mr,yr="+x+y";function zo(s){return Array.isArray(s)?s[0]:s}let ga=()=>{const s=new Fr(new Er(1,1),Br);return ga=()=>s,s},_a=()=>{const s=new Fr(new Er(1,1,32,1),Br);return _a=()=>s,s};const il={type:"syncstart"},sl={type:"synccomplete"},ya=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],ll=ya.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class ba extends Fr{constructor(){const n=new $s;super(n,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=No,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=yr,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(n){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(n):(this._isSyncing=!0,this.dispatchEvent(il),Hs({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},f=>{this._isSyncing=!1,this._textRenderInfo=f,this.geometry.updateGlyphs(f.glyphBounds,f.glyphAtlasIndices,f.blockBounds,f.chunkedBounds,f.glyphColors);const u=this._queuedSyncs;u&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{u.forEach(t=>t&&t())})),this.dispatchEvent(sl),n&&n()})))}onBeforeRender(n,f,u,t,e,r){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(n){return ol(n)}get material(){let n=this._derivedMaterial;const f=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Br.clone());if((!n||!n.isDerivedFrom(f))&&(n=this._derivedMaterial=this.createDerivedMaterial(f),f.addEventListener("dispose",function u(){f.removeEventListener("dispose",u),n.dispose()})),this.hasOutline()){let u=n._outlineMtl;return u||(u=n._outlineMtl=Object.create(n,{id:{value:n.id+.1}}),u.isTextOutlineMaterial=!0,u.depthWrite=!1,u.map=null,n.addEventListener("dispose",function t(){n.removeEventListener("dispose",t),u.dispose()})),[u,n]}else return n}set material(n){n&&n.isTroikaTextMaterial?(this._derivedMaterial=n,this._baseMaterial=n.baseMaterial):this._baseMaterial=n}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(n){this.geometry.detail=n}get curveRadius(){return this.geometry.curveRadius}set curveRadius(n){this.geometry.curveRadius=n}get customDepthMaterial(){return zo(this.material).getDepthMaterial()}set customDepthMaterial(n){}get customDistanceMaterial(){return zo(this.material).getDistanceMaterial()}set customDistanceMaterial(n){}_prepareForRender(n){const f=n.isTextOutlineMaterial,u=n.uniforms,t=this.textRenderInfo;if(t){const{sdfTexture:i,blockBounds:o}=t;u.uTroikaSDFTexture.value=i,u.uTroikaSDFTextureSize.value.set(i.image.width,i.image.height),u.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,u.uTroikaSDFExponent.value=t.sdfExponent,u.uTroikaTotalBounds.value.fromArray(o),u.uTroikaUseGlyphColors.value=!f&&!!t.glyphColors;let a=0,l=0,c=0,d,h,v,m=0,g=0;if(f){let{outlineWidth:k,outlineOffsetX:w,outlineOffsetY:y,outlineBlur:x,outlineOpacity:O}=this;a=this._parsePercent(k)||0,l=Math.max(0,this._parsePercent(x)||0),d=O,m=this._parsePercent(w)||0,g=this._parsePercent(y)||0}else c=Math.max(0,this._parsePercent(this.strokeWidth)||0),c&&(v=this.strokeColor,u.uTroikaStrokeColor.value.set(v??No),h=this.strokeOpacity,h==null&&(h=1)),d=this.fillOpacity;u.uTroikaEdgeOffset.value=a,u.uTroikaPositionOffset.value.set(m,g),u.uTroikaBlurRadius.value=l,u.uTroikaStrokeWidth.value=c,u.uTroikaStrokeOpacity.value=h,u.uTroikaFillOpacity.value=d??1,u.uTroikaCurveRadius.value=this.curveRadius||0;let I=this.clipRect;if(I&&Array.isArray(I)&&I.length===4)u.uTroikaClipRect.value.fromArray(I);else{const k=(this.fontSize||.1)*100;u.uTroikaClipRect.value.set(o[0]-k,o[1]-k,o[2]+k,o[3]+k)}this.geometry.applyClipRect(u.uTroikaClipRect.value)}u.uTroikaSDFDebug.value=!!this.debugSDF,n.polygonOffset=!!this.depthOffset,n.polygonOffsetFactor=n.polygonOffsetUnits=this.depthOffset||0;const e=f?this.outlineColor||0:this.color;if(e==null)delete n.color;else{const i=n.hasOwnProperty("color")?n.color:n.color=new Wn;(e!==i._input||typeof e=="object")&&i.set(i._input=e)}let r=this.orientation||yr;if(r!==n._orientation){let i=u.uTroikaOrient.value;r=r.replace(/[^-+xyz]/g,"");let o=r!==yr&&r.match(/^([-+])([xyz])([-+])([xyz])$/);if(o){let[,a,l,c,d]=o;Fn.set(0,0,0)[l]=a==="-"?1:-1,_r.set(0,0,0)[d]=c==="-"?-1:1,Wo.lookAt(al,Fn.cross(_r),_r),i.setFromMatrix4(Wo)}else i.identity();n._orientation=r}}_parsePercent(n){if(typeof n=="string"){let f=n.match(/^(-?[\d.]+)%$/),u=f?parseFloat(f[1]):NaN;n=(isNaN(u)?0:u/100)*this.fontSize}return n}localPositionToTextCoords(n,f=new In){f.copy(n);const u=this.curveRadius;return u&&(f.x=Math.atan2(n.x,Math.abs(u)-Math.abs(n.z))*Math.abs(u)),f}worldPositionToTextCoords(n,f=new In){return Fn.copy(n),this.localPositionToTextCoords(this.worldToLocal(Fn),f)}raycast(n,f){const{textRenderInfo:u,curveRadius:t}=this;if(u){const e=u.blockBounds,r=t?_a():ga(),i=r.geometry,{position:o,uv:a}=i.attributes;for(let l=0;l<a.count;l++){let c=e[0]+a.getX(l)*(e[2]-e[0]);const d=e[1]+a.getY(l)*(e[3]-e[1]);let h=0;t&&(h=t-Math.cos(c/t)*t,c=Math.sin(c/t)*t),o.setXYZ(l,c,d,h)}i.boundingSphere=this.geometry.boundingSphere,i.boundingBox=this.geometry.boundingBox,r.matrixWorld=this.matrixWorld,r.material.side=this.material.side,rn.length=0,r.raycast(n,rn);for(let l=0;l<rn.length;l++)rn[l].object=this,f.push(rn[l])}}copy(n){const f=this.geometry;return super.copy(n),this.geometry=f,ll.forEach(u=>{this[u]=n[u]}),this}clone(){return new this.constructor().copy(this)}}ya.forEach(s=>{const n="_private_"+s;Object.defineProperty(ba.prototype,s,{get(){return this[n]},set(f){f!==this[n]&&(this[n]=f,this._needsSync=!0)}})});new Xo;new Wn;const ul=2e3,fl={__name:"Home3D",emits:["bookShow"],setup(s,{emit:n}){const f=n;let u=null,t=null,e={shi:null,fen:null,miao:null},r=null,i=null,o=null,a=null,l=null,c=null,d=null,h=null,v=null,m,g,I,k,w,y,x=!1;const O=window.devicePixelRatio||1;let U=!1;function M(){g=document.getElementById("audio"),m=g.getContext("2d"),g.width=g.clientWidth*O,g.height=g.clientHeight*O,m.scale(O,O)}function V(){y=document.createElement("video"),y.src="/home//public/mp4/test.mp4",y.loop=!0,y.crossOrigin="anonymous",y.addEventListener("play",()=>{U=!0,x||G(),ee()}),y.addEventListener("pause",()=>{U=!1}),y.addEventListener("ended",()=>{R()})}function G(){const F=new AudioContext,D=F.createMediaElementSource(y);I=F.createAnalyser(),k=I.frequencyBinCount,I.fftSize=k/2,D.connect(I),I.connect(F.destination),w=new Uint8Array(k),x=!0}function ee(){if(!U)return;requestAnimationFrame(ee),m.clearRect(0,0,g.width,g.height),I.getByteFrequencyData(w),m.clearRect(0,0,g.width,g.height);const F=I.frequencyBinCount,D=g.width/F,L=Math.floor(F/2);for(let Z=0;Z<L;Z++){const K=w[Z],Y=K*(g.height/256),J=K+50>255?255:K+50,Q=50,H=150;m.fillStyle=`rgb(${J},${Q},${H})`;let oe=Z*D,te=g.height-Y;m.fillRect(oe,te,D,Y);let W=g.width-(Z+1)*D,se=g.height-Y;m.fillRect(W,se,D,Y)}}function _(){const F=new Date,D=F.getFullYear(),L=F.getMonth()+1,Z=L<10?"0"+L:L,K=F.getDate(),Y=K<10?"0"+K:K;return{year:D,month:Z,day:Y}}function B(F,D=[0,0,0],L=1,Z="bold"){const K=new ba;return K.text=F,K.font="/home/public/fonts/digital7.ttf",K.fontSize=L,K.position.set(...D),K.rotation.y=Math.PI/2,K.color=0,K.fontWeight=Z,K.anchorX="center",K.anchorY="middle",K.sync(),K}const C=(F,D)=>{const L=new F.CubeTextureLoader().setPath("/home//public/images/").load(["nx.png","px.png","py.png","ny.png","nz.png","pz.png"]);D.background=L;const Z=new Date().getHours();if(Z>=18||Z<6){D.background=new F.Color(265780);let Y=[{nubmer:1850,color:16777215,size:1.5,scalar:1,multiple:500}];for(let J=0;J<Y.length;J++){const Q=ti(Y[J]);Q.rotation.x=Math.random()*6,Q.rotation.y=Math.random()*6,Q.rotation.z=Math.random()*6,Q.matrixAutoUpdate=!1,Q.updateMatrix(),Q.position.set(0,0,0),D.add(Q)}}},X=(F,D,L,Z)=>{cr.install({THREE:F}),u=new cr(L,Z.domElement),u.enableTransition=!0,u.transitionTime=1,u.mouseButtons.wheel=cr.ACTION.NONE,u.update(),u.saveState(),u.minPolarAngle=Math.PI*1.4/4,u.maxPolarAngle=Math.PI*1.5/4,u.minAzimuthAngle=Math.PI/6,u.maxAzimuthAngle=Math.PI*2.5/6,D.addEventListener("mouseDown",function(K){u.enabled=!1}),D.addEventListener("mouseUp",function(K){u.enabled=!0})},j=(F,D)=>{const L=new F.AmbientLight(203843,.6);D.add(L);const Z=new F.DirectionalLight(16777215,.3);Z.position.set(-99.4535,52.788402638514,-25.3826),Z.castShadow=!0,D.add(Z),r=new F.PointLight(16774827,80,100),r.position.set(27.105,2.1298,-29.157),r.castShadow=!0,D.add(r),i=new F.PointLight(16777215,1,200),i.position.set(11.376385097904176,26.471699160045343,6.353171916870222),i.castShadow=!0,D.add(i);const K=new F.CylinderGeometry(1.56,1.56,4,32);o=new F.Mesh(K,new F.MeshStandardMaterial({color:1118481,transparent:!0,opacity:.46,emissive:16711680,emissiveIntensity:100,metalness:0,roughness:.5})),o.position.set(-29.102585931853945,8.358703425055227,-16.330828911180188),o.castShadow=!0,D.add(o)},ae=async({THREE:F,scene:D,transControls:L,camera:Z,renderer:K})=>{X(F,L,Z,K),C(F,D),j(F,D);const Y=new F.Group,J=lt(D.children,"home");J.position.set(0,-15,0);const Q=lt(J.children,"主体");Q.castShadow=!0,Q.receiveShadow=!0,a=lt(J.children,"xiaodeng"),a.material.emissive=new F.Color(1118481),a.material.envMapIntensity=0,a.castShadow=!0,a.receiveShadow=!0;const H=lt(J.children,"闹钟"),oe=lt(H.children,"shi"),te=lt(H.children,"fen"),W=lt(H.children,"miao");e={shi:oe,fen:te,miao:W},e.shi.rotation.y=0,e.fen.rotation.y=0,e.miao.rotation.y=0;const se=lt(J.children,"电脑桌");se.castShadow=!0,se.receiveShadow=!0;const{year:ne,month:ie,day:$}=_(),Se=B(`${ne}`,[-24.21810526958002,6.28957649,17.8168586],1);D.add(Se);const le=B("Year",[-24.21810526958002,5.06957649,18.2068586],.6,"regular");D.add(le);const ue=B(`${ie}`,[-24.21810526958002,6.28957649,15.8168586],1);D.add(ue);const ce=B("Month",[-24.21810526958002,5.06957649,15.8968586],.6,"regular");D.add(ce);const me=B(`${$}`,[-24.21810526958002,6.28957649,14.2168586],1);D.add(me);const De=B("Day",[-24.21810526958002,5.06957649,14.0468586],.6,"regular");D.add(De);const Ae=lt(D.children,"xianshiqi");if(Ae.castShadow=!0,y.src){const we=new F.VideoTexture(y);we.flipY=!1;const Be=new F.MeshBasicMaterial({map:we});Ae.material=Be,Ae.castShadow=!0}l=lt(J.children,"柱体014");const he={y:0},ge={y:Math.PI*2};h=new ri(he).to(ge,3e3).easing(oi.Quadratic.InOut).onUpdate(()=>{l.rotation.y=he.y}).delay(3e3).start();const fe=[{name:"xc_01",size:[4.2,4.2],position:[25.147446346740253,20.1227880586422,-32.918080391178876],src:"/public/images/001.jpg"},{name:"xc_02",size:[4.2,4.2],position:[31.06927073239676,20.1227880586422,-32.918080391178876],src:"/public/images/002.jpg"},{name:"xc_03",size:[4.2,4.2],position:[37.0123651221323,20.1227880586422,-32.918080391178876],src:"/public/images/004.jpg"},{name:"xc_04",size:[10.2,4.2],position:[28.247028395689476,13.964410131334555,-32.9180803911788],src:"/public/images/003.jpg"},{name:"xc_05",size:[4.2,4.2],position:[37.0123651221323,14.035935533501332,-32.918080391178],src:"/public/images/005.jpg"},{name:"xc_06",size:[4.2,4.2],position:[25.17463710170653,8.343632646416731,-32.9180803911],src:"/public/images/006.jpg"},{name:"xc_07",size:[10.2,4.2],position:[34.05277102672005,8.210956138239148,-32.918080391178876],src:"/public/images/007.jpg"}],pe=new F.TextureLoader;for(let we=0;we<fe.length;we++){const Be=fe[we];pe.load("/home/"+Be.src,Pe=>{const Ge=ei(fe[we]);Ge.name=fe[we].name,Ge.material=new F.MeshLambertMaterial({map:Pe}),Y.add(Ge)})}const _e=new F.PlaneGeometry(16,25),ze=new F.PlaneGeometry(60,60),Fe=new F.MeshBasicMaterial({color:65280,transparent:!0,opacity:0,side:F.DoubleSide}),ve=new F.Mesh(_e,Fe);ve.rotation.y=Math.PI/2,ve.position.set(-26.75,7.5,29.5),ve.name="shujibox";const Ue=new F.Mesh(ze,Fe);Ue.rotation.x=Math.PI/2,Ue.position.set(10.246792078608115,-10.735367866515414,9.388791775822062),Ue.name="dimian",Y.add(Ue),Y.add(ve),D.add(Y),u.rotate(72*F.MathUtils.DEG2RAD,0,!0),u.setTarget(-.2176510350531844,.06773081571016058,.014509065832072607,!0),console.error(Ae);let rt=[];c=we=>{rt=[we.clientX,we.clientY]},d=async we=>{const[Be,Pe]=rt;if(Math.abs(Be-we.clientX)>2||Math.abs(Pe-we.clientY)>2)return;let Ge=await ni({el:"#canvas",camera:Z,group:Y,event:we});if(Ge!=null&&Ge.object&&(t&&(t=null),t=Ge.object,console.log(t.name),t.name=="shujibox"&&p(),t.name.indexOf("xc")>-1&&T(t.index),t.name=="dimian")){const ot=Ge.point;u.setLookAt(ot.x,15,ot.z,-19,15,-20,!0)}},document.body.addEventListener("mousedown",c),document.body.addEventListener("mouseup",d),document.body.addEventListener("keydown",b);const{keyEvent:Ce,clearKeys:Te}=await $a();v=Te;const Ie=Ce(wn.W,16.666),Me=Ce(wn.A,16.666),ye=Ce(wn.S,16.666),Ee=Ce(wn.D,16.666);Me.addEventListener("holding",function(we){u.truck(-.01,0,!1)}),Ee.addEventListener("holding",function(we){u.truck(.01,0,!1)}),Ie.addEventListener("holding",function(we){u.forward(.01,!1)}),ye.addEventListener("holding",function(we){u.forward(-.01,!1)})};let re=!0;const b=F=>{F.key=="Control"&&(re=!re),F.code=="Space"&&(U?(y.pause(),ko("#audio",{bottom:"-80px"})):(y.play(),ko("#audio",{bottom:"0"})),F.preventDefault)},R=F=>{const D=new KeyboardEvent("keydown",{key:" ",code:"Space",keyCode:32,bubbles:!0,cancelable:!0});document.body.dispatchEvent(D)},p=()=>{f("bookShow")},T=F=>{co.show("/home//public/dfsj/db/gzlh.png")},A=()=>{const F=new Date,D=F.getHours()%12||12,L=F.getMinutes(),Z=F.getSeconds();return[D,L,Z]},E=()=>{const{shi:F,fen:D,miao:L}=e;if(!F||!D||!L)return;e.shi.rotation.y=0,e.fen.rotation.y=0,e.miao.rotation.y=0;const[Z,K,Y]=A(),J={shi:Z*(2*Math.PI/12)+Math.PI/2,fen:-K*(2*Math.PI/60)+Math.PI/2,miao:Y*(2*Math.PI/60)+Math.PI/2};F.rotation.y=J.shi,D.rotation.y=J.fen,L.rotation.y=J.miao};let S=Date.now();const N=(F,D)=>{const L=Date.now();if(L-S>=ul){const Z=new D.Color(Math.random()*16777215);F.material.emissive=Z,S=L}F.material.emissiveIntensity=Math.sin(Date.now()*.001*Math.PI)*.5+.5},P=({THREE:F,scene:D,camera:L,renderer:Z,clock:K,stats:Y})=>{const J=K.getDelta();u.update(J),Y.update(),E(),re?(r.visible=!0,i.intensity=2e3,a.material.emissive=new F.Color(16777215),a.material.envMapIntensity=1):(r.visible=!1,i.intensity=20,a.material.emissive=new F.Color(1118481),a.material.envMapIntensity=0),U?N(o,F):o.material.emissive=new F.Color(0),h.update(),Z.render(D,L)},{loading:z,pregress:q}=qa({el:"#canvas",background:"#111",modelPath:["house.glb"],modelName:["home"],modelScale:[2.5,2.5,2.5],cameraPosition:[-20,-0,42],control:!1,helper:!1,light:!1,transformControls:!0,showStats:!0,statsPosition:[0,0],creatMesh:ae,animation:P});return Vo(()=>{co.mount(),M(),V()}),Ra(()=>{re=!1,v(),document.body.removeEventListener("mousedown",c),document.body.removeEventListener("mouseup",d),document.body.removeEventListener("keydown",b),h&&(h.stop(),ai(h),h=null),v=null}),(F,D)=>(yt(),Pa(Qa,{loading:lo(z),pregress:lo(q)},{default:Oa(()=>D[0]||(D[0]=[Ye("canvas",{id:"canvas"},null,-1),Ye("canvas",{id:"audio"},null,-1)])),_:1},8,["loading","pregress"]))}},cl=Nn(fl,[["__scopeId","data-v-09445730"]]),dl={__name:"Home",setup(s){const n=jo(),f=br([]),u=()=>{f.value=Ia.menus.filter(i=>i.path!=="/"),n.setFlagStatus(!0)};Vo(()=>{u()});const t=br(!1),e=()=>{t.value=!0},r=()=>{t.value=!1};return(i,o)=>(yt(),Ut(Tr,null,[Sr(cl,{onBookShow:e}),Sr(_i,{show:t.value,menus:f.value,onBookHide:r},null,8,["show","menus"]),o[0]||(o[0]=Ye("div",{class:"tip-right"},[Ye("p",null,"1.点击“书本”查看网站知识库"),Ye("p",null,"2.点击“显示器”播放MV"),Ye("p",null,"3.点击“相册”查看案例"),Ye("p",null,"4.按Ctrl键-开关灯|空格键控制视频播放")],-1))],64))}},xl=Nn(dl,[["__scopeId","data-v-416750be"]]);export{xl as default};
