import{_ as Nn,r as yr,q as Ca,N as ka,o as yt,j as Ut,a as Xe,F as br,l as io,n as Da,t as Aa,E as Fa,h as Ma,v as Ea,G as Tr,i as Vo,g as Ra,c as La,w as Oa,u as so,p as Ia}from"./index-CBcyRm_t.js";import{u as zo}from"./allscreen-CUO7nlcE.js";import{U as Pa,k as Ba,R as Ga,ah as Na,ai as Wa,aj as jo,a as Wn,c as Ar,h as Pn,ak as Va,al as lo,am as za,an as ja,ao as Xa,y as uo,ap as Ha,M as Ya,D as Ja,f as Ka,V as Fr,Y as Mr,u as Za,L as qa}from"./Loading-WzBiX3uU.js";import{C as xn}from"./camera-controls.module-CggtOxtI.js";import{k as st,o as Qa,i as $a}from"./creatMesh-DHCg5GWV.js";import{u as ei}from"./useRay-BXLpuDR_.js";import{Z as fo}from"./zoomtastic.umd-DXSdxC-m.js";import{T as ti,E as ni,r as ri}from"./tween.esm-Dp1EtNfj.js";import"./loading-C-YUrJ_O.js";import"./_commonjsHelpers-Cpj98o6Y.js";const oi={class:"accordion solution"},ai=["onClick"],ii={class:"left-top"},si=["innerHTML"],li={class:"right"},ui={class:"box"},fi=["title","onClick"],ci={__name:"Accordion",props:{items:{type:Array,default:()=>[]}},setup(s){const n=yr(0),u=Ca(),f=ka(),t=zo(),e=l=>l.replace(/([a-zA-Z]+)/g,'<span style="font-size:20px">$1</span>'),r=l=>e(l),i=async(l,c)=>{f.showLoading(),await u.push(l),o(c)},o=async l=>{t.setFlagStatus(!1),await Fa();const c=document.getElementById("menu");if(c){const d=c.getElementsByClassName("menu-item");d[l]&&(c.scrollTop=d[l].offsetTop)}f.hideLoading()},a=l=>{n.value=l};return(l,c)=>(yt(),Ut("div",oi,[Xe("ul",null,[(yt(!0),Ut(br,null,io(s.items,(d,h)=>(yt(),Ut("li",{key:h,class:Da(["accordion-item",{on:n.value===h}]),onClick:v=>a(h)},[c[0]||(c[0]=Xe("div",{class:"left"},null,-1)),Xe("div",ii,[Xe("div",{innerHTML:r(d.title)},null,8,si)]),Xe("div",li,[Xe("dl",null,[Xe("div",ui,[(yt(!0),Ut(br,null,io(d.children,(v,p)=>(yt(),Ut("dd",{key:p,title:v.name,onClick:_=>i(v.path,p)},Aa(v.name),9,fi))),128))])])])],10,ai))),128))])]))}},di=Nn(ci,[["__scopeId","data-v-c363bd40"]]),hi={class:"book-boom"},pi={class:"know-rec box"},vi={__name:"KnowHome",props:{show:{type:Boolean,default:!1},menus:{type:Array,default:()=>[]}},emits:["bookHide"],setup(s,{emit:n}){const u=n,f=()=>{u("bookHide")};return(t,e)=>Ma((yt(),Ut("div",hi,[Xe("div",{class:"boom-layer",onClick:f}),Xe("div",pi,[Tr(di,{items:s.menus},null,8,["items"])])],512)),[[Ea,s.show]])}},mi=Nn(vi,[["__scopeId","data-v-264d42f9"]]);/**
 * anime.js - ESM
 * @version v4.0.0
 * @author Julian Garnier
 * @license MIT
 * @copyright (c) 2025 Julian Garnier
 * @see https://animejs.com
 */const ft=typeof window<"u",cr=ft?window:null,Wt=ft?document:null,Oe={OBJECT:0,ATTRIBUTE:1,CSS:2,TRANSFORM:3,CSS_VAR:4},ke={NUMBER:0,UNIT:1,COLOR:2,COMPLEX:3},nt={NONE:0,AUTO:1,FORCE:2},Qe={replace:0,none:1,blend:2},co=Symbol(),Er=Symbol(),Xo=Symbol(),Vn=Symbol(),gi=Symbol(),Me=1e-11,Ho=1e12,Vt=1e3,Sr=120,Ct="",fn=new Map;fn.set("x","translateX");fn.set("y","translateY");fn.set("z","translateZ");const Rr=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],Yo=Rr.reduce((s,n)=>({...s,[n]:n+"("}),{}),tt=()=>{},_i=/(^#([\da-f]{3}){1,2}$)|(^#([\da-f]{4}){1,2}$)/i,yi=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i,bi=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,Ti=/hsl\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*\)/i,Si=/hsla\(\s*(-?\d+|-?\d*.\d+)\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)%\s*,\s*(-?\d+|-?\d*.\d+)\s*\)/i,ho=/[-+]?\d*\.?\d+(?:e[-+]?\d)?/gi,wi=/^([-+]?\d*\.?\d+(?:e[-+]?\d+)?)([a-z]+|%)$/i,xi=/([a-z])([A-Z])/g,Ui=/(\w+)(\([^)]+\)+)/g,Jo={id:null,keyframes:null,playbackEase:null,playbackRate:1,frameRate:Sr,loop:0,reversed:!1,alternate:!1,autoplay:!0,duration:Vt,delay:0,loopDelay:0,ease:"out(2)",composition:Qe.replace,modifier:s=>s,onBegin:tt,onBeforeUpdate:tt,onUpdate:tt,onLoop:tt,onPause:tt,onComplete:tt,onRender:tt},We={defaults:Jo,root:Wt,scope:null,precision:4,timeScale:1,tickThreshold:200},Ko={version:"4.0.0",engine:null};ft&&(cr.AnimeJS||(cr.AnimeJS=[]),cr.AnimeJS.push(Ko));const Ci=s=>s.replace(xi,"$1-$2").toLowerCase(),Bt=(s,n)=>s.indexOf(n)===0,ln=Date.now,un=Array.isArray,dr=s=>s&&s.constructor===Object,ki=s=>typeof s=="number"&&!isNaN(s),zn=s=>typeof s=="string",Bn=s=>typeof s=="function",Fe=s=>typeof s>"u",hr=s=>Fe(s)||s===null,Zo=s=>ft&&s instanceof SVGElement,qo=s=>_i.test(s),Qo=s=>Bt(s,"rgb"),$o=s=>Bt(s,"hsl"),Di=s=>qo(s)||Qo(s)||$o(s),Mn=s=>!We.defaults.hasOwnProperty(s),Un=s=>zn(s)?parseFloat(s):s,Lt=Math.pow,Ai=Math.sqrt,Fi=Math.sin,Mi=Math.cos,Ei=Math.abs,Ri=Math.ceil,ea=Math.floor,Li=Math.asin,Lr=Math.PI,po=Math.round,je=(s,n,u)=>s<n?n:s>u?u:s,vo={},Le=(s,n)=>{if(n<0)return s;if(!n)return po(s);let u=vo[n];return u||(u=vo[n]=10**n),po(s*u)/u},St=(s,n,u)=>s+(n-s)*u,En=s=>s===1/0?Ho:s===-1/0?-1e12:s,Gt=s=>s<Me?Me:s,Je=s=>un(s)?[...s]:s,Oi=(s,n)=>{const u={...s};for(let f in n){const t=s[f];u[f]=Fe(t)?n[f]:t}return u},Ge=(s,n,u,f="_prev",t="_next")=>{let e=s._head,r=t;for(u&&(e=s._tail,r=f);e;){const i=e[r];n(e),e=i}},on=(s,n,u="_prev",f="_next")=>{const t=n[u],e=n[f];t?t[f]=e:s._head=e,e?e[u]=t:s._tail=t,n[u]=null,n[f]=null},Pt=(s,n,u,f="_prev",t="_next")=>{let e=s._tail;for(;e&&u&&u(e,n);)e=e[f];const r=e?e[t]:s._head;e?e[t]=n:s._head=n,r?r[f]=n:s._tail=n,n[f]=e,n[t]=r};class ta{constructor(n=0){this.deltaTime=0,this._currentTime=n,this._elapsedTime=n,this._startTime=n,this._lastTime=n,this._scheduledTime=0,this._frameDuration=Le(Vt/Sr,0),this._fps=Sr,this._speed=1,this._hasChildren=!1,this._head=null,this._tail=null}get fps(){return this._fps}set fps(n){const u=this._frameDuration,f=+n,t=f<Me?Me:f,e=Le(Vt/t,0);this._fps=t,this._frameDuration=e,this._scheduledTime+=e-u}get speed(){return this._speed}set speed(n){const u=+n;this._speed=u<Me?Me:u}requestTick(n){const u=this._scheduledTime,f=this._elapsedTime;if(this._elapsedTime+=n-f,f<u)return nt.NONE;const t=this._frameDuration,e=f-u;return this._scheduledTime+=e<t?t:e,nt.AUTO}computeDeltaTime(n){const u=n-this._lastTime;return this.deltaTime=u,this._lastTime=n,u}}const Rn=(s,n,u,f,t)=>{const e=s.parent,r=s.duration,i=s.completed,o=s.iterationDuration,a=s.iterationCount,l=s._currentIteration,c=s._loopDelay,d=s._reversed,h=s._alternate,v=s._hasChildren,p=s._delay,_=s._currentTime,B=p+o,D=n-p,b=je(_,-p,r),x=je(D,-p,r),S=D-_,O=x>0,U=x>=r,F=r<=Me,j=t===nt.FORCE;let P=0,ee=D,g=0;if(a>1){const ne=~~(x/(o+(U?0:c)));s._currentIteration=je(ne,0,a),U&&s._currentIteration--,P=s._currentIteration%2,ee=x%(o+c)||0}const G=d^(h&&P),C=s._ease;let H=U?G?0:r:G?o-ee:ee;C&&(H=o*C(H/o)||0);const X=(e?e.backwards:D<_)?!G:!!G;if(s._currentTime=D,s._iterationTime=H,s.backwards=X,O&&!s.began?(s.began=!0,!u&&!(e&&(X||!e.began))&&s.onBegin(s)):D<=0&&(s.began=!1),!u&&!v&&O&&s._currentIteration!==l&&s.onLoop(s),j||t===nt.AUTO&&(n>=p&&n<=B||n<=p&&b>p||n>=B&&b!==r)||H>=B&&b!==r||H<=p&&b>0||n<=b&&b===r&&i||U&&!i&&F){if(O&&(s.computeDeltaTime(b),u||s.onBeforeUpdate(s)),!v){const ne=j||(X?S*-1:S)>=We.tickThreshold,ae=s._offset+(e?e._offset:0)+p+H;let y=s._head,R,m,T,A,E=0;for(;y;){const w=y._composition,V=y._currentTime,L=y._changeDuration,z=y._absoluteStartTime+y._changeDuration,k=y._nextRep,I=y._prevRep,N=w!==Qe.none;if((ne||(V!==L||ae<=z+(k?k._delay:0))&&(V!==0||ae>=y._absoluteStartTime))&&(!N||!y._isOverridden&&(!y._isOverlapped||ae<=z)&&(!k||k._isOverridden||ae<=k._absoluteStartTime)&&(!I||I._isOverridden||ae>=I._absoluteStartTime+I._changeDuration+y._delay))){const M=y._currentTime=je(H-y._startTime,0,L),K=y._ease(M/y._updateDuration),q=y._modifier,Y=y._valueType,Z=y._tweenType,re=Z===Oe.OBJECT,J=Y===ke.NUMBER,oe=J&&re||K===0||K===1?-1:We.precision;let $,W;if(J)$=W=q(Le(St(y._fromNumber,y._toNumber,K),oe));else if(Y===ke.UNIT)W=q(Le(St(y._fromNumber,y._toNumber,K),oe)),$=`${W}${y._unit}`;else if(Y===ke.COLOR){const ue=y._fromNumbers,te=y._toNumbers,ie=Le(je(q(St(ue[0],te[0],K)),0,255),0),Q=Le(je(q(St(ue[1],te[1],K)),0,255),0),Te=Le(je(q(St(ue[2],te[2],K)),0,255),0),se=je(q(Le(St(ue[3],te[3],K),oe)),0,1);if($=`rgba(${ie},${Q},${Te},${se})`,N){const le=y._numbers;le[0]=ie,le[1]=Q,le[2]=Te,le[3]=se}}else if(Y===ke.COMPLEX){$=y._strings[0];for(let ue=0,te=y._toNumbers.length;ue<te;ue++){const ie=q(Le(St(y._fromNumbers[ue],y._toNumbers[ue],K),oe)),Q=y._strings[ue+1];$+=`${Q?ie+Q:ie}`,N&&(y._numbers[ue]=ie)}}if(N&&(y._number=W),!f&&w!==Qe.blend){const ue=y.property;R=y.target,re?R[ue]=$:Z===Oe.ATTRIBUTE?R.setAttribute(ue,$):(m=R.style,Z===Oe.TRANSFORM?(R!==T&&(T=R,A=R[Vn]),A[ue]=$,E=1):Z===Oe.CSS?m[ue]=$:Z===Oe.CSS_VAR&&m.setProperty(ue,$)),O&&(g=1)}else y._value=$}if(E&&y._renderTransforms){let M=Ct;for(let K in A)M+=`${Yo[K]}${A[K]}) `;m.transform=M,E=0}y=y._next}!u&&g&&s.onRender(s)}!u&&O&&s.onUpdate(s)}return e&&F?!u&&(e.began&&!X&&D>=r&&!i||X&&D<=Me&&i)&&(s.onComplete(s),s.completed=!X):O&&U?a===1/0?s._startTime+=s.duration:s._currentIteration>=a-1&&(s.paused=!0,!i&&!v&&(s.completed=!0,!u&&!(e&&(X||!e.began))&&(s.onComplete(s),s._resolve(s)))):s.completed=!1,g},Ot=(s,n,u,f,t)=>{const e=s._currentIteration;if(Rn(s,n,u,f,t),s._hasChildren){const r=s,i=r.backwards,o=f?n:r._iterationTime,a=ln();let l=0,c=!0;if(!f&&r._currentIteration!==e){const d=r.iterationDuration;Ge(r,h=>{if(!i)!h.completed&&!h.backwards&&h._currentTime<h.iterationDuration&&Rn(h,d,u,1,nt.FORCE),h.began=!1,h.completed=!1;else{const v=h.duration,p=h._offset+h._delay,_=p+v;!u&&v<=Me&&(!p||_===d)&&h.onComplete(h)}}),u||r.onLoop(r)}Ge(r,d=>{const h=Le((o-d._offset)*d._speed,12),v=d._fps<r._fps?d.requestTick(a):t;l+=Rn(d,h,u,f,v),!d.completed&&c&&(c=!1)},i),!u&&l&&r.onRender(r),c&&r._currentTime>=r.duration&&(r.paused=!0,r.completed||(r.completed=!0,u||(r.onComplete(r),r._resolve(r))))}},Nt={animation:null,update:tt},Ii=s=>{let n=Nt.animation;return n||(n={duration:Me,computeDeltaTime:tt,_offset:0,_delay:0,_head:null,_tail:null},Nt.animation=n,Nt.update=()=>{s.forEach(u=>{for(let f in u){const t=u[f],e=t._head;if(e){const r=e._valueType,i=r===ke.COMPLEX||r===ke.COLOR?Je(e._fromNumbers):null;let o=e._fromNumber,a=t._tail;for(;a&&a!==e;){if(i)for(let l=0,c=a._numbers.length;l<c;l++)i[l]+=a._numbers[l];else o+=a._number;a=a._prevAdd}e._toNumber=o,e._toNumbers=i}}}),Rn(n,1,1,0,nt.FORCE)}),n},na=ft?requestAnimationFrame:setImmediate,Pi=ft?cancelAnimationFrame:clearImmediate;class Bi extends ta{constructor(n){super(n),this.useDefaultMainLoop=!0,this.pauseOnDocumentHidden=!0,this.defaults=Jo,this.paused=!!(ft&&Wt.hidden),this.reqId=null}update(){const n=this._currentTime=ln();if(this.requestTick(n)){this.computeDeltaTime(n);const u=this._speed,f=this._fps;let t=this._head;for(;t;){const e=t._next;t.paused?(on(this,t),this._hasChildren=!!this._tail,t._running=!1,t.completed&&!t._cancelled&&t.cancel()):Ot(t,(n-t._startTime)*t._speed*u,0,0,t._fps<f?t.requestTick(n):nt.AUTO),t=e}Nt.update()}}wake(){return this.useDefaultMainLoop&&!this.reqId&&!this.paused&&(this.reqId=na(ra)),this}pause(){return this.paused=!0,Gi()}resume(){if(this.paused)return this.paused=!1,Ge(this,n=>n.resetTime()),this.wake()}get speed(){return this._speed*(We.timeScale===1?1:Vt)}set speed(n){this._speed=n*We.timeScale,Ge(this,u=>u.speed=u._speed)}get timeUnit(){return We.timeScale===1?"ms":"s"}set timeUnit(n){const f=n==="s",t=f?.001:1;if(We.timeScale!==t){We.timeScale=t,We.tickThreshold=200*t;const e=f?.001:Vt;this.defaults.duration*=e,this._speed*=e}}get precision(){return We.precision}set precision(n){We.precision=n}}const ze=(()=>{const s=new Bi(ln());return ft&&(Ko.engine=s,Wt.addEventListener("visibilitychange",()=>{s.pauseOnDocumentHidden&&(Wt.hidden?s.pause():s.resume())})),s})(),ra=()=>{ze._head?(ze.reqId=na(ra),ze.update()):ze.reqId=0},Gi=()=>(Pi(ze.reqId),ze.reqId=0,ze),Ni=(s,n,u)=>{const f=s.style.transform;let t;if(f){const e=s[Vn];let r;for(;r=Ui.exec(f);){const i=r[1],o=r[2].slice(1,-1);e[i]=o,i===n&&(t=o,u&&(u[n]=o))}}return f&&!Fe(t)?t:Bt(n,"scale")?"1":Bt(n,"rotate")||Bt(n,"skew")?"0deg":"0px"};function mo(s){const n=zn(s)?We.root.querySelectorAll(s):s;if(n instanceof NodeList||n instanceof HTMLCollection)return n}function Wi(s){if(hr(s))return[];if(un(s)){const u=s.flat(1/0),f=[];for(let t=0,e=u.length;t<e;t++){const r=u[t];if(!hr(r)){const i=mo(r);if(i)for(let o=0,a=i.length;o<a;o++){const l=i[o];if(!hr(l)){let c=!1;for(let d=0,h=f.length;d<h;d++)if(f[d]===l){c=!0;break}c||f.push(l)}}else{let o=!1;for(let a=0,l=f.length;a<l;a++)if(f[a]===r){o=!0;break}o||f.push(r)}}}return f}if(!ft)return[s];const n=mo(s);return n?Array.from(n):[s]}function Vi(s){const n=Wi(s),u=n.length;if(u)for(let f=0;f<u;f++){const t=n[f];if(!t[co]){t[co]=!0;const e=Zo(t);(t.nodeType||e)&&(t[Er]=!0,t[Xo]=e,t[Vn]={})}}return n}const zi=["opacity","rotate","overflow","color"],ji=(s,n)=>{if(zi.includes(n))return!1;if(s.getAttribute(n)||n in s){if(n==="scale"){const u=s.parentNode;return u&&u.tagName==="filter"}return!0}},Xi=s=>{const n=yi.exec(s)||bi.exec(s),u=Fe(n[4])?1:+n[4];return[+n[1],+n[2],+n[3],u]},Hi=s=>{const n=s.length,u=n===4||n===5;return[+("0x"+s[1]+s[u?1:2]),+("0x"+s[u?2:3]+s[u?2:4]),+("0x"+s[u?3:5]+s[u?3:6]),n===5||n===9?+(+("0x"+s[u?4:7]+s[u?4:8])/255).toFixed(3):1]},pr=(s,n,u)=>(u<0&&(u+=1),u>1&&(u-=1),u<1/6?s+(n-s)*6*u:u<1/2?n:u<2/3?s+(n-s)*(2/3-u)*6:s),Yi=s=>{const n=Ti.exec(s)||Si.exec(s),u=+n[1]/360,f=+n[2]/100,t=+n[3]/100,e=Fe(n[4])?1:+n[4];let r,i,o;if(f===0)r=i=o=t;else{const a=t<.5?t*(1+f):t+f-t*f,l=2*t-a;r=Le(pr(l,a,u+1/3)*255,0),i=Le(pr(l,a,u)*255,0),o=Le(pr(l,a,u-1/3)*255,0)}return[r,i,o,e]},Ji=s=>Qo(s)?Xi(s):qo(s)?Hi(s):$o(s)?Yi(s):[0,0,0,1],Ke=(s,n)=>Fe(s)?n:s,gt=(s,n,u,f,t)=>{if(Bn(s)){const e=()=>{const r=s(n,u,f);return isNaN(+r)?r||0:+r};return t&&(t.func=e),e()}else return s},oa=(s,n)=>s[Er]?s[Xo]&&ji(s,n)?Oe.ATTRIBUTE:Rr.includes(n)||fn.get(n)?Oe.TRANSFORM:Bt(n,"--")?Oe.CSS_VAR:n in s.style?Oe.CSS:n in s?Oe.OBJECT:Oe.ATTRIBUTE:Oe.OBJECT,go=(s,n,u)=>{const f=s.style[n];f&&u&&(u[n]=f);const t=f||getComputedStyle(s[gi]||s).getPropertyValue(n);return t==="auto"?"0":t},tn=(s,n,u,f)=>{const t=Fe(u)?oa(s,n):u;return t===Oe.OBJECT?s[n]||0:t===Oe.ATTRIBUTE?s.getAttribute(n):t===Oe.TRANSFORM?Ni(s,n,f):t===Oe.CSS_VAR?go(s,n,f).trimStart():go(s,n,f)},_o=(s,n,u)=>u==="-"?s-n:u==="+"?s+n:s*n,Or=()=>({t:ke.NUMBER,n:0,u:null,o:null,d:null,s:null}),lt=(s,n)=>{if(n.t=ke.NUMBER,n.n=0,n.u=null,n.o=null,n.d=null,n.s=null,!s)return n;const u=+s;if(isNaN(u)){let f=s;f[1]==="="&&(n.o=f[0],f=f.slice(2));const t=f.includes(" ")?!1:wi.exec(f);if(t)return n.t=ke.UNIT,n.n=+t[1],n.u=t[2],n;if(n.o)return n.n=+f,n;if(Di(f))return n.t=ke.COLOR,n.d=Ji(f),n;{const e=f.match(ho);return n.t=ke.COMPLEX,n.d=e?e.map(Number):[],n.s=f.split(ho)||[],n}}else return n.n=u,n},yo=(s,n)=>(n.t=s._valueType,n.n=s._toNumber,n.u=s._unit,n.o=null,n.d=Je(s._toNumbers),n.s=Je(s._strings),n),wt=Or(),Gn={_rep:new WeakMap,_add:new Map},Ir=(s,n,u="_rep")=>{const f=Gn[u];let t=f.get(s);return t||(t={},f.set(s,t)),t[n]?t[n]:t[n]={_head:null,_tail:null}},Ki=(s,n)=>s._isOverridden||s._absoluteStartTime>n._absoluteStartTime,Ln=s=>{s._isOverlapped=1,s._isOverridden=1,s._changeDuration=Me,s._currentTime=Me},aa=(s,n)=>{const u=s._composition;if(u===Qe.replace){const f=s._absoluteStartTime;Pt(n,s,Ki,"_prevRep","_nextRep");const t=s._prevRep;if(t){const e=t.parent,r=t._absoluteStartTime+t._changeDuration;if(s.parent.id!==e.id&&e.iterationCount>1&&r+(e.duration-e.iterationDuration)>f){Ln(t);let a=t._prevRep;for(;a&&a.parent.id===e.id;)Ln(a),a=a._prevRep}const i=f-s._delay;if(r>i){const a=t._startTime,l=r-(a+t._updateDuration);t._changeDuration=i-l-a,t._currentTime=t._changeDuration,t._isOverlapped=1,t._changeDuration<Me&&Ln(t)}let o=!0;if(Ge(e,a=>{a._isOverlapped||(o=!1)}),o){const a=e.parent;if(a){let l=!0;Ge(a,c=>{c!==e&&Ge(c,d=>{d._isOverlapped||(l=!1)})}),l&&a.cancel()}else e.cancel()}}}else if(u===Qe.blend){const f=Ir(s.target,s.property,"_add"),t=Ii(Gn._add);let e=f._head;e||(e={...s},e._composition=Qe.replace,e._updateDuration=Me,e._startTime=0,e._numbers=Je(s._fromNumbers),e._number=0,e._next=null,e._prev=null,Pt(f,e),Pt(t,e));const r=s._toNumber;if(s._fromNumber=e._fromNumber-r,s._toNumber=0,s._numbers=Je(s._fromNumbers),s._number=0,e._fromNumber=r,s._toNumbers){const i=Je(s._toNumbers);i&&i.forEach((o,a)=>{s._fromNumbers[a]=e._fromNumbers[a]-o,s._toNumbers[a]=0}),e._fromNumbers=i}Pt(f,s,null,"_prevAdd","_nextAdd")}return s},Zi=s=>{const n=s._composition;if(n!==Qe.none){const u=s.target,f=s.property,r=Gn._rep.get(u)[f];if(on(r,s,"_prevRep","_nextRep"),n===Qe.blend){const i=Gn._add,o=i.get(u);if(!o)return;const a=o[f],l=Nt.animation;on(a,s,"_prevAdd","_nextAdd");const c=a._head;if(c&&c===a._tail){on(a,c,"_prevAdd","_nextAdd"),on(l,c);let d=!0;for(let h in o)if(o[h]._head){d=!1;break}d&&i.delete(u)}}}return s},bo=s=>(s.paused=!0,s.began=!1,s.completed=!1,s),wr=s=>(s._cancelled&&(s._hasChildren?Ge(s,wr):Ge(s,n=>{n._composition!==Qe.none&&aa(n,Ir(n.target,n.property))}),s._cancelled=0),s);let qi=0;class Qi extends ta{constructor(n={},u=null,f=0){super(0);const{id:t,delay:e,duration:r,reversed:i,alternate:o,loop:a,loopDelay:l,autoplay:c,frameRate:d,playbackRate:h,onComplete:v,onLoop:p,onPause:_,onBegin:B,onBeforeUpdate:D,onUpdate:b}=n,x=u?0:ze._elapsedTime,S=u?u.defaults:We.defaults,O=Bn(e)||Fe(e)?S.delay:+e,U=Bn(r)||Fe(r)?1/0:+r,F=Ke(a,S.loop),j=Ke(l,S.loopDelay),P=F===!0||F===1/0||F<0?1/0:F+1;let ee=0;if(u)ee=f;else{let g=ln();ze.paused&&(ze.requestTick(g),g=ze._elapsedTime),ee=g-ze._startTime}this.id=Fe(t)?++qi:t,this.parent=u,this.duration=En((U+j)*P-j)||Me,this.backwards=!1,this.paused=!0,this.began=!1,this.completed=!1,this.onBegin=B||S.onBegin,this.onBeforeUpdate=D||S.onBeforeUpdate,this.onUpdate=b||S.onUpdate,this.onLoop=p||S.onLoop,this.onPause=_||S.onPause,this.onComplete=v||S.onComplete,this.iterationDuration=U,this.iterationCount=P,this._autoplay=u?!1:Ke(c,S.autoplay),this._offset=ee,this._delay=O,this._loopDelay=j,this._iterationTime=0,this._currentIteration=0,this._resolve=tt,this._running=!1,this._reversed=+Ke(i,S.reversed),this._reverse=this._reversed,this._cancelled=0,this._alternate=Ke(o,S.alternate),this._prev=null,this._next=null,this._elapsedTime=x,this._startTime=x,this._lastTime=x,this._fps=Ke(d,S.frameRate),this._speed=Ke(h,S.playbackRate)}get cancelled(){return!!this._cancelled}set cancelled(n){n?this.cancel():this.reset(1).play()}get currentTime(){return je(Le(this._currentTime,We.precision),-this._delay,this.duration)}set currentTime(n){const u=this.paused;this.pause().seek(+n),u||this.resume()}get iterationCurrentTime(){return Le(this._iterationTime,We.precision)}set iterationCurrentTime(n){this.currentTime=this.iterationDuration*this._currentIteration+n}get progress(){return je(Le(this._currentTime/this.duration,5),0,1)}set progress(n){this.currentTime=this.duration*n}get iterationProgress(){return je(Le(this._iterationTime/this.iterationDuration,5),0,1)}set iterationProgress(n){const u=this.iterationDuration;this.currentTime=u*this._currentIteration+u*n}get currentIteration(){return this._currentIteration}set currentIteration(n){this.currentTime=this.iterationDuration*je(+n,0,this.iterationCount-1)}get reversed(){return!!this._reversed}set reversed(n){n?this.reverse():this.play()}get speed(){return super.speed}set speed(n){super.speed=n,this.resetTime()}reset(n=0){return wr(this),this._reversed&&!this._reverse&&(this.reversed=!1),this._iterationTime=this.iterationDuration,Ot(this,0,1,n,nt.FORCE),bo(this),this._hasChildren&&Ge(this,bo),this}init(n=0){this.fps=this._fps,this.speed=this._speed,!n&&this._hasChildren&&Ot(this,this.duration,1,n,nt.FORCE),this.reset(n);const u=this._autoplay;return u===!0?this.resume():u&&!Fe(u.linked)&&u.link(this),this}resetTime(){const n=1/(this._speed*ze._speed);return this._startTime=ln()-(this._currentTime+this._delay)*n,this}pause(){return this.paused?this:(this.paused=!0,this.onPause(this),this)}resume(){return this.paused?(this.paused=!1,this.duration<=Me&&!this._hasChildren?Ot(this,Me,0,0,nt.FORCE):(this._running||(Pt(ze,this),ze._hasChildren=!0,this._running=!0),this.resetTime(),this._startTime-=12,ze.wake()),this):this}restart(){return this.reset(0).resume()}seek(n,u=0,f=0){wr(this),this.completed=!1;const t=this.paused;return this.paused=!0,Ot(this,n+this._delay,~~u,~~f,nt.AUTO),t?this:this.resume()}alternate(){const n=this._reversed,u=this.iterationCount,f=this.iterationDuration,t=u===1/0?ea(Ho/f):u;return this._reversed=+(this._alternate&&!(t%2)?n:!n),u===1/0?this.iterationProgress=this._reversed?1-this.iterationProgress:this.iterationProgress:this.seek(f*t-this._currentTime),this.resetTime(),this}play(){return this._reversed&&this.alternate(),this.resume()}reverse(){return this._reversed||this.alternate(),this.resume()}cancel(){return this._hasChildren?Ge(this,n=>n.cancel(),!0):Ge(this,Zi),this._cancelled=1,this.pause()}stretch(n){const u=this.duration;if(u===Gt(n))return this;const f=n/u,t=n<=Me;return this.duration=t?Me:Gt(En(Le(u*f,12))),this.iterationDuration=t?Me:Gt(En(Le(this.iterationDuration*f,12))),this._offset*=f,this._delay*=f,this._loopDelay*=f,this}revert(){Ot(this,0,1,0,nt.AUTO);const n=this._autoplay;return n&&n.linked&&n.linked===this&&n.revert(),this.cancel()}complete(){return this.seek(this.duration).cancel()}then(n=tt){const u=this.then,f=()=>{this.then=null,n(this),this.then=u,this._resolve=tt};return new Promise(t=>(this._resolve=()=>t(f()),this.completed&&this._resolve(),this))}}const zt=s=>s,ia=(s,n,u)=>(((1-3*u+3*n)*s+(3*u-6*n))*s+3*n)*s,$i=(s,n,u)=>{let f=0,t=1,e,r,i=0;do r=f+(t-f)/2,e=ia(r,n,u)-s,e>0?t=r:f=r;while(Ei(e)>1e-7&&++i<100);return r},es=(s=.5,n=0,u=.5,f=1)=>s===n&&u===f?zt:t=>t===0||t===1?t:ia($i(t,s,u),n,f),ts=(s=10,n)=>{const u=n?Ri:ea;return f=>u(je(f,0,1)*s)*(1/s)},sa=(...s)=>{const n=s.length;if(!n)return zt;const u=n-1,f=s[0],t=s[u],e=[0],r=[Un(f)];for(let i=1;i<u;i++){const o=s[i],a=zn(o)?o.trim().split(" "):[o],l=a[0],c=a[1];e.push(Fe(c)?i/u:Un(c)/100),r.push(Un(l))}return r.push(Un(t)),e.push(1),function(o){for(let a=1,l=e.length;a<l;a++){const c=e[a];if(o<=c){const d=e[a-1],h=r[a-1];return h+(r[a]-h)*(o-d)/(c-d)}}return r[r.length-1]}},ns=(s=10,n=1)=>{const u=[0],f=s-1;for(let t=1;t<f;t++){const e=u[t-1],r=t/f,i=(t+1)/f,o=r+(i-r)*Math.random(),a=r*(1-n)+o*n;u.push(je(a,e,1))}return u.push(1),sa(...u)},rs=Lr/2,To=Lr*2,nn=(s=1.68)=>n=>Lt(n,+s),So={[Ct]:nn,Quad:nn(2),Cubic:nn(3),Quart:nn(4),Quint:nn(5),Sine:s=>1-Mi(s*rs),Circ:s=>1-Ai(1-s*s),Expo:s=>s?Lt(2,10*s-10):0,Bounce:s=>{let n,u=4;for(;s<((n=Lt(2,--u))-1)/11;);return 1/Lt(4,3-u)-7.5625*Lt((n*3-2)/22-s,2)},Back:(s=1.70158)=>n=>(+s+1)*n*n*n-+s*n*n,Elastic:(s=1,n=.3)=>{const u=je(+s,1,10),f=je(+n,Me,2),t=f/To*Li(1/u),e=To/f;return r=>r===0||r===1?r:-u*Lt(2,-10*(1-r))*Fi((1-r-t)*e)}},xr={in:s=>n=>s(n),out:s=>n=>1-s(1-n),inOut:s=>n=>n<.5?s(n*2)/2:1-s(n*-2+2)/2,outIn:s=>n=>n<.5?(1-s(1-n*2))/2:(s(n*2-1)+1)/2},os=(s,n,u)=>{if(u[s])return u[s];if(s.indexOf("(")<=-1){const t=xr[s]||s.includes("Back")||s.includes("Elastic")?n[s]():n[s];return t?u[s]=t:zt}else{const f=s.slice(0,-1).split("("),t=n[f[0]];return t?u[s]=t(...f[1].split(",")):zt}},as=(()=>{const s={linear:sa,irregular:ns,steps:ts,cubicBezier:es};for(let n in xr)for(let u in So){const f=So[u],t=xr[n];s[n+u]=u===Ct||u==="Back"||u==="Elastic"?(e,r)=>t(f(e,r)):t(f)}return s})(),is={linear:zt},wo=s=>Bn(s)?s:zn(s)?os(s,as,is):zt,xo={},ss=(s,n,u)=>{if(u===Oe.TRANSFORM){const f=fn.get(s);return f||s}else if(u===Oe.CSS||u===Oe.ATTRIBUTE&&Zo(n)&&s in n.style){const f=xo[s];if(f)return f;{const t=s&&Ci(s);return xo[s]=t,t}}else return s},vr={deg:1,rad:180/Lr,turn:360},Uo={},ls=(s,n,u,f=!1)=>{const t=n.u,e=n.n;if(n.t===ke.UNIT&&t===u)return n;const r=e+t+u,i=Uo[r];if(!Fe(i)&&!f)n.n=i;else{let o;if(t in vr)o=e*vr[t]/vr[u];else{const l=s.cloneNode(),c=s.parentNode,d=c&&c!==Wt?c:Wt.body;d.appendChild(l);const h=l.style;h.width=100+t;const v=l.offsetWidth||100;h.width=100+u;const p=l.offsetWidth||100,_=v/p;d.removeChild(l),o=_*e}n.n=o,Uo[r]=o}return n.t,ke.UNIT,n.u=u,n},la=s=>{if(s._hasChildren)Ge(s,la,!0);else{const n=s;n.pause(),Ge(n,u=>{const f=u.property,t=u.target;if(t[Er]){const e=t.style,r=n._inlineStyles[f];if(u._tweenType===Oe.TRANSFORM){const i=t[Vn];if(Fe(r)||r===Ct?delete i[f]:i[f]=r,u._renderTransforms)if(!Object.keys(i).length)e.removeProperty("transform");else{let o=Ct;for(let a in i)o+=Yo[a]+i[a]+") ";e.transform=o}}else Fe(r)||r===Ct?e.removeProperty(f):e[f]=r;n._tail===u&&n.targets.forEach(i=>{i.getAttribute&&i.getAttribute("style")===Ct&&i.removeAttribute("style")})}})}return s},ye=Or(),we=Or(),Cn={func:null},kn=[null],Et=[null,null],Dn={to:null};let us=0,_t,ut;const fs=(s,n)=>{const u={};if(un(s)){const f=[].concat(...s.map(t=>Object.keys(t))).filter(Mn);for(let t=0,e=f.length;t<e;t++){const r=f[t],i=s.map(o=>{const a={};for(let l in o){const c=o[l];Mn(l)?l===r&&(a.to=c):a[l]=c}return a});u[r]=i}}else{const f=Ke(n.duration,We.defaults.duration);Object.keys(s).map(e=>({o:parseFloat(e)/100,p:s[e]})).sort((e,r)=>e.o-r.o).forEach(e=>{const r=e.o,i=e.p;for(let o in i)if(Mn(o)){let a=u[o];a||(a=u[o]=[]);const l=r*f;let c=a.length,d=a[c-1];const h={to:i[o]};let v=0;for(let p=0;p<c;p++)v+=a[p].duration;c===1&&(h.from=d.to),i.ease&&(h.ease=i.ease),h.duration=l-(c?v:0),a.push(h)}return e});for(let e in u){const r=u[e];let i;for(let o=0,a=r.length;o<a;o++){const l=r[o],c=l.ease;l.ease=i||void 0,i=c}r[0].duration||r.shift()}}return u};class cs extends Qi{constructor(n,u,f,t,e=!1,r=0,i=0){super(u,f,t);const o=Vi(n),a=o.length,l=u.keyframes,c=l?Oi(fs(l,u),u):u,{delay:d,duration:h,ease:v,playbackEase:p,modifier:_,composition:B,onRender:D}=c,b=f?f.defaults:We.defaults,x=Ke(p,b.playbackEase),S=x?wo(x):null,O=!Fe(v)&&!Fe(v.ease),U=O?v.ease:Ke(v,S?"linear":b.ease),F=O?v.duration:Ke(h,b.duration),j=Ke(d,b.delay),P=_||b.modifier,ee=Fe(B)&&a>=Vt?Qe.none:Fe(B)?b.composition:B,g={},G=this._offset+(f?f._offset:0);let C=NaN,H=NaN,X=0,ne=0;for(let ae=0;ae<a;ae++){const y=o[ae],R=r||ae,m=i||a;let T=NaN,A=NaN;for(let E in c)if(Mn(E)){const w=oa(y,E),V=ss(E,y,w);let L=c[E];const z=un(L);if(e&&!z&&(Et[0]=L,Et[1]=L,L=Et),z){const q=L.length,Y=!dr(L[0]);q===2&&Y?(Dn.to=L,kn[0]=Dn,_t=kn):q>2&&Y?(_t=[],L.forEach((Z,re)=>{re?re===1?(Et[1]=Z,_t.push(Et)):_t.push(Z):Et[0]=Z})):_t=L}else kn[0]=L,_t=kn;let k=null,I=null,N=NaN,M=0,K=0;for(let q=_t.length;K<q;K++){const Y=_t[K];dr(Y)?ut=Y:(Dn.to=Y,ut=Dn),Cn.func=null;const Z=gt(ut.to,y,R,m,Cn);let re;dr(Z)&&!Fe(Z.to)?(ut=Z,re=Z.to):re=Z;const J=gt(ut.from,y,R,m),oe=ut.ease,$=!Fe(oe)&&!Fe(oe.ease),W=$?oe.ease:oe||U,ue=$?oe.duration:gt(Ke(ut.duration,q>1?gt(F,y,R,m)/q:F),y,R,m),te=gt(Ke(ut.delay,K?0:j),y,R,m),ie=gt(Ke(ut.composition,ee),y,R,m),Q=ki(ie)?ie:Qe[ie],Te=ut.modifier||P,se=!Fe(J),le=!Fe(re),de=un(re),ge=de||se&&le,Ce=I?M+te:te,Ae=G+Ce;!ne&&(se||de)&&(ne=1);let pe=I;if(Q!==Qe.none){k||(k=Ir(y,V));let ve=k._head;for(;ve&&!ve._isOverridden&&ve._absoluteStartTime<=Ae;)if(pe=ve,ve=ve._nextRep,ve&&ve._absoluteStartTime>=Ae)for(;ve;)Ln(ve),ve=ve._nextRep}if(ge?(lt(de?gt(re[0],y,R,m):J,ye),lt(de?gt(re[1],y,R,m,Cn):re,we),ye.t===ke.NUMBER&&(pe?pe._valueType===ke.UNIT&&(ye.t=ke.UNIT,ye.u=pe._unit):(lt(tn(y,V,w,g),wt),wt.t===ke.UNIT&&(ye.t=ke.UNIT,ye.u=wt.u)))):(le?lt(re,we):I?yo(I,we):lt(f&&pe&&pe.parent.parent===f?pe._value:tn(y,V,w,g),we),se?lt(J,ye):I?yo(I,ye):lt(f&&pe&&pe.parent.parent===f?pe._value:tn(y,V,w,g),ye)),ye.o&&(ye.n=_o(pe?pe._toNumber:lt(tn(y,V,w,g),wt).n,ye.n,ye.o)),we.o&&(we.n=_o(ye.n,we.n,we.o)),ye.t!==we.t){if(ye.t===ke.COMPLEX||we.t===ke.COMPLEX){const ve=ye.t===ke.COMPLEX?ye:we,_e=ye.t===ke.COMPLEX?we:ye;_e.t=ke.COMPLEX,_e.s=Je(ve.s),_e.d=ve.d.map(()=>_e.n)}else if(ye.t===ke.UNIT||we.t===ke.UNIT){const ve=ye.t===ke.UNIT?ye:we,_e=ye.t===ke.UNIT?we:ye;_e.t=ke.UNIT,_e.u=ve.u}else if(ye.t===ke.COLOR||we.t===ke.COLOR){const ve=ye.t===ke.COLOR?ye:we,_e=ye.t===ke.COLOR?we:ye;_e.t=ke.COLOR,_e.s=ve.s,_e.d=[0,0,0,1]}}if(ye.u!==we.u){let ve=we.u?ye:we;ve=ls(y,ve,we.u?we.u:ye.u,!1)}if(we.d&&ye.d&&we.d.length!==ye.d.length){const ve=ye.d.length>we.d.length?ye:we,_e=ve===ye?we:ye;_e.d=ve.d.map((Ie,De)=>Fe(_e.d[De])?0:_e.d[De]),_e.s=Je(ve.s)}const me=Le(+ue||Me,12),ce={parent:this,id:us++,property:V,target:y,_value:null,_func:Cn.func,_ease:wo(W),_fromNumbers:Je(ye.d),_toNumbers:Je(we.d),_strings:Je(we.s),_fromNumber:ye.n,_toNumber:we.n,_numbers:Je(ye.d),_number:ye.n,_unit:we.u,_modifier:Te,_currentTime:0,_startTime:Ce,_delay:+te,_updateDuration:me,_changeDuration:me,_absoluteStartTime:Ae,_tweenType:w,_valueType:we.t,_composition:Q,_isOverlapped:0,_isOverridden:0,_renderTransforms:0,_prevRep:null,_nextRep:null,_prevAdd:null,_nextAdd:null,_prev:null,_next:null};Q!==Qe.none&&aa(ce,k),isNaN(N)&&(N=ce._startTime),M=Le(Ce+me,12),I=ce,X++,Pt(this,ce)}(isNaN(H)||N<H)&&(H=N),(isNaN(C)||M>C)&&(C=M),w===Oe.TRANSFORM&&(T=X-K,A=X)}if(!isNaN(T)){let E=0;Ge(this,w=>{E>=T&&E<A&&(w._renderTransforms=1,w._composition===Qe.blend&&Ge(Nt.animation,V=>{V.id===w.id&&(V._renderTransforms=1)})),E++})}}a||console.warn("No target found. Make sure the element you're trying to animate is accessible before creating your animation."),H?(Ge(this,ae=>{ae._startTime-ae._delay||(ae._delay-=H),ae._startTime-=H}),C-=H):H=0,C||(C=Me,this.iterationCount=0),this.targets=o,this.duration=C===Me?Me:En((C+this._loopDelay)*this.iterationCount-this._loopDelay)||Me,this.onRender=D||b.onRender,this._ease=S,this._delay=H,this.iterationDuration=C,this._inlineStyles=g,!this._autoplay&&ne&&this.onRender(this)}stretch(n){const u=this.duration;if(u===Gt(n))return this;const f=n/u;return Ge(this,t=>{t._updateDuration=Gt(Le(t._updateDuration*f,12)),t._changeDuration=Gt(Le(t._changeDuration*f,12)),t._currentTime*=f,t._startTime*=f,t._absoluteStartTime*=f}),super.stretch(n)}refresh(){return Ge(this,n=>{const u=tn(n.target,n.property,n._tweenType);lt(u,wt),n._fromNumbers=Je(wt.d),n._fromNumber=wt.n,n._func&&(lt(n._func(),we),n._toNumbers=Je(we.d),n._strings=Je(we.s),n._toNumber=we.n)}),this}revert(){return super.revert(),la(this)}then(n){return super.then(n)}}const Co=(s,n)=>new cs(s,n,null,0,!1).init(),ds=["x","y","z"];[...ds,...Rr.filter(s=>["X","Y","Z"].some(n=>s.endsWith(n)))];ft&&(Fe(CSS)||Object.hasOwnProperty.call(CSS,"registerProperty"));function hs(){var s=Object.create(null);function n(t,e){var r=t.id,i=t.name,o=t.dependencies;o===void 0&&(o=[]);var a=t.init;a===void 0&&(a=function(){});var l=t.getTransferables;if(l===void 0&&(l=null),!s[r])try{o=o.map(function(d){return d&&d.isWorkerModule&&(n(d,function(h){if(h instanceof Error)throw h}),d=s[d.id].value),d}),a=f("<"+i+">.init",a),l&&(l=f("<"+i+">.getTransferables",l));var c=null;typeof a=="function"?c=a.apply(void 0,o):console.error("worker module init function failed to rehydrate"),s[r]={id:r,value:c,getTransferables:l},e(c)}catch(d){d&&d.noLog||console.error(d),e(d)}}function u(t,e){var r,i=t.id,o=t.args;(!s[i]||typeof s[i].value!="function")&&e(new Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var a=(r=s[i]).value.apply(r,o);a&&typeof a.then=="function"?a.then(l,function(c){return e(c instanceof Error?c:new Error(""+c))}):l(a)}catch(c){e(c)}function l(c){try{var d=s[i].getTransferables&&s[i].getTransferables(c);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),e(c,d)}catch(h){console.error(h),e(h)}}}function f(t,e){var r=void 0;self.troikaDefine=function(o){return r=o};var i=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(i)}catch(o){console.error(o)}return URL.revokeObjectURL(i),delete self.troikaDefine,r}self.addEventListener("message",function(t){var e=t.data,r=e.messageId,i=e.action,o=e.data;try{i==="registerModule"&&n(o,function(a){a instanceof Error?postMessage({messageId:r,success:!1,error:a.message}):postMessage({messageId:r,success:!0,result:{isCallable:typeof a=="function"}})}),i==="callModule"&&u(o,function(a,l){a instanceof Error?postMessage({messageId:r,success:!1,error:a.message}):postMessage({messageId:r,success:!0,result:a},l||void 0)})}catch(a){postMessage({messageId:r,success:!1,error:a.stack})}})}function ps(s){var n=function(){for(var u=[],f=arguments.length;f--;)u[f]=arguments[f];return n._getInitResult().then(function(t){if(typeof t=="function")return t.apply(void 0,u);throw new Error("Worker module function was called but `init` did not return a callable function")})};return n._getInitResult=function(){var u=s.dependencies,f=s.init;u=Array.isArray(u)?u.map(function(e){return e&&(e=e.onMainThread||e,e._getInitResult&&(e=e._getInitResult())),e}):[];var t=Promise.all(u).then(function(e){return f.apply(null,e)});return n._getInitResult=function(){return t},t},n}var ua=function(){var s=!1;if(typeof window<"u"&&typeof window.document<"u")try{var n=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));n.terminate(),s=!0}catch(u){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+u.message+"]")}return ua=function(){return s},s},vs=0,ms=0,mr=!1,an=Object.create(null),sn=Object.create(null),Ur=Object.create(null);function jt(s){if((!s||typeof s.init!="function")&&!mr)throw new Error("requires `options.init` function");var n=s.dependencies,u=s.init,f=s.getTransferables,t=s.workerId,e=ps(s);t==null&&(t="#default");var r="workerModule"+ ++vs,i=s.name||r,o=null;n=n&&n.map(function(l){return typeof l=="function"&&!l.workerModuleData&&(mr=!0,l=jt({workerId:t,name:"<"+i+"> function dependency: "+l.name,init:`function(){return (
`+On(l)+`
)}`}),mr=!1),l&&l.workerModuleData&&(l=l.workerModuleData),l});function a(){for(var l=[],c=arguments.length;c--;)l[c]=arguments[c];if(!ua())return e.apply(void 0,l);if(!o){o=ko(t,"registerModule",a.workerModuleData);var d=function(){o=null,sn[t].delete(d)};(sn[t]||(sn[t]=new Set)).add(d)}return o.then(function(h){var v=h.isCallable;if(v)return ko(t,"callModule",{id:r,args:l});throw new Error("Worker module function was called but `init` did not return a callable function")})}return a.workerModuleData={isWorkerModule:!0,id:r,name:i,dependencies:n,init:On(u),getTransferables:f&&On(f)},a.onMainThread=e,a}function gs(s){sn[s]&&sn[s].forEach(function(n){n()}),an[s]&&(an[s].terminate(),delete an[s])}function On(s){var n=s.toString();return!/^function/.test(n)&&/^\w+\s*\(/.test(n)&&(n="function "+n),n}function _s(s){var n=an[s];if(!n){var u=On(hs);n=an[s]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+s.replace(/\*/g,"")+` **/

;(`+u+")()"],{type:"application/javascript"}))),n.onmessage=function(f){var t=f.data,e=t.messageId,r=Ur[e];if(!r)throw new Error("WorkerModule response with empty or unknown messageId");delete Ur[e],r(t)}}return n}function ko(s,n,u){return new Promise(function(f,t){var e=++ms;Ur[e]=function(r){r.success?f(r.result):t(new Error("Error in worker "+n+" call: "+r.error))},_s(s).postMessage({messageId:e,action:n,data:u})})}function fa(){var s=function(n){function u(y,R,m,T,A,E,w,V){var L=1-w;V.x=L*L*y+2*L*w*m+w*w*A,V.y=L*L*R+2*L*w*T+w*w*E}function f(y,R,m,T,A,E,w,V,L,z){var k=1-L;z.x=k*k*k*y+3*k*k*L*m+3*k*L*L*A+L*L*L*w,z.y=k*k*k*R+3*k*k*L*T+3*k*L*L*E+L*L*L*V}function t(y,R){for(var m=/([MLQCZ])([^MLQCZ]*)/g,T,A,E,w,V;T=m.exec(y);){var L=T[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(z){return parseFloat(z)});switch(T[1]){case"M":w=A=L[0],V=E=L[1];break;case"L":(L[0]!==w||L[1]!==V)&&R("L",w,V,w=L[0],V=L[1]);break;case"Q":{R("Q",w,V,w=L[2],V=L[3],L[0],L[1]);break}case"C":{R("C",w,V,w=L[4],V=L[5],L[0],L[1],L[2],L[3]);break}case"Z":(w!==A||V!==E)&&R("L",w,V,A,E);break}}}function e(y,R,m){m===void 0&&(m=16);var T={x:0,y:0};t(y,function(A,E,w,V,L,z,k,I,N){switch(A){case"L":R(E,w,V,L);break;case"Q":{for(var M=E,K=w,q=1;q<m;q++)u(E,w,z,k,V,L,q/(m-1),T),R(M,K,T.x,T.y),M=T.x,K=T.y;break}case"C":{for(var Y=E,Z=w,re=1;re<m;re++)f(E,w,z,k,I,N,V,L,re/(m-1),T),R(Y,Z,T.x,T.y),Y=T.x,Z=T.y;break}}})}var r="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",i="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",o=new WeakMap,a={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function l(y,R){var m=y.getContext?y.getContext("webgl",a):y,T=o.get(m);if(!T){let k=function(Y){var Z=E[Y];if(!Z&&(Z=E[Y]=m.getExtension(Y),!Z))throw new Error(Y+" not supported");return Z},I=function(Y,Z){var re=m.createShader(Z);return m.shaderSource(re,Y),m.compileShader(re),re},N=function(Y,Z,re,J){if(!w[Y]){var oe={},$={},W=m.createProgram();m.attachShader(W,I(Z,m.VERTEX_SHADER)),m.attachShader(W,I(re,m.FRAGMENT_SHADER)),m.linkProgram(W),w[Y]={program:W,transaction:function(te){m.useProgram(W),te({setUniform:function(Q,Te){for(var se=[],le=arguments.length-2;le-- >0;)se[le]=arguments[le+2];var de=$[Te]||($[Te]=m.getUniformLocation(W,Te));m["uniform"+Q].apply(m,[de].concat(se))},setAttribute:function(Q,Te,se,le,de){var ge=oe[Q];ge||(ge=oe[Q]={buf:m.createBuffer(),loc:m.getAttribLocation(W,Q),data:null}),m.bindBuffer(m.ARRAY_BUFFER,ge.buf),m.vertexAttribPointer(ge.loc,Te,m.FLOAT,!1,0,0),m.enableVertexAttribArray(ge.loc),A?m.vertexAttribDivisor(ge.loc,le):k("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ge.loc,le),de!==ge.data&&(m.bufferData(m.ARRAY_BUFFER,de,se),ge.data=de)}})}}}w[Y].transaction(J)},M=function(Y,Z){L++;try{m.activeTexture(m.TEXTURE0+L);var re=V[Y];re||(re=V[Y]=m.createTexture(),m.bindTexture(m.TEXTURE_2D,re),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST)),m.bindTexture(m.TEXTURE_2D,re),Z(re,L)}finally{L--}},K=function(Y,Z,re){var J=m.createFramebuffer();z.push(J),m.bindFramebuffer(m.FRAMEBUFFER,J),m.activeTexture(m.TEXTURE0+Z),m.bindTexture(m.TEXTURE_2D,Y),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,Y,0);try{re(J)}finally{m.deleteFramebuffer(J),m.bindFramebuffer(m.FRAMEBUFFER,z[--z.length-1]||null)}},q=function(){E={},w={},V={},L=-1,z.length=0};var A=typeof WebGL2RenderingContext<"u"&&m instanceof WebGL2RenderingContext,E={},w={},V={},L=-1,z=[];m.canvas.addEventListener("webglcontextlost",function(Y){q(),Y.preventDefault()},!1),o.set(m,T={gl:m,isWebGL2:A,getExtension:k,withProgram:N,withTexture:M,withTextureFramebuffer:K,handleContextLoss:q})}R(T)}function c(y,R,m,T,A,E,w,V){w===void 0&&(w=15),V===void 0&&(V=null),l(y,function(L){var z=L.gl,k=L.withProgram,I=L.withTexture;I("copy",function(N,M){z.texImage2D(z.TEXTURE_2D,0,z.RGBA,A,E,0,z.RGBA,z.UNSIGNED_BYTE,R),k("copy",r,i,function(K){var q=K.setUniform,Y=K.setAttribute;Y("aUV",2,z.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),q("1i","image",M),z.bindFramebuffer(z.FRAMEBUFFER,V||null),z.disable(z.BLEND),z.colorMask(w&8,w&4,w&2,w&1),z.viewport(m,T,A,E),z.scissor(m,T,A,E),z.drawArrays(z.TRIANGLES,0,3)})})})}function d(y,R,m){var T=y.width,A=y.height;l(y,function(E){var w=E.gl,V=new Uint8Array(T*A*4);w.readPixels(0,0,T,A,w.RGBA,w.UNSIGNED_BYTE,V),y.width=R,y.height=m,c(w,V,0,0,T,A)})}var h=Object.freeze({__proto__:null,withWebGLContext:l,renderImageData:c,resizeWebGLCanvasWithoutClearing:d});function v(y,R,m,T,A,E){E===void 0&&(E=1);var w=new Uint8Array(y*R),V=T[2]-T[0],L=T[3]-T[1],z=[];e(m,function(Y,Z,re,J){z.push({x1:Y,y1:Z,x2:re,y2:J,minX:Math.min(Y,re),minY:Math.min(Z,J),maxX:Math.max(Y,re),maxY:Math.max(Z,J)})}),z.sort(function(Y,Z){return Y.maxX-Z.maxX});for(var k=0;k<y;k++)for(var I=0;I<R;I++){var N=K(T[0]+V*(k+.5)/y,T[1]+L*(I+.5)/R),M=Math.pow(1-Math.abs(N)/A,E)/2;N<0&&(M=1-M),M=Math.max(0,Math.min(255,Math.round(M*255))),w[I*y+k]=M}return w;function K(Y,Z){for(var re=1/0,J=1/0,oe=z.length;oe--;){var $=z[oe];if($.maxX+J<=Y)break;if(Y+J>$.minX&&Z-J<$.maxY&&Z+J>$.minY){var W=B(Y,Z,$.x1,$.y1,$.x2,$.y2);W<re&&(re=W,J=Math.sqrt(re))}}return q(Y,Z)&&(J=-J),J}function q(Y,Z){for(var re=0,J=z.length;J--;){var oe=z[J];if(oe.maxX<=Y)break;var $=oe.y1>Z!=oe.y2>Z&&Y<(oe.x2-oe.x1)*(Z-oe.y1)/(oe.y2-oe.y1)+oe.x1;$&&(re+=oe.y1<oe.y2?1:-1)}return re!==0}}function p(y,R,m,T,A,E,w,V,L,z){E===void 0&&(E=1),V===void 0&&(V=0),L===void 0&&(L=0),z===void 0&&(z=0),_(y,R,m,T,A,E,w,null,V,L,z)}function _(y,R,m,T,A,E,w,V,L,z,k){E===void 0&&(E=1),L===void 0&&(L=0),z===void 0&&(z=0),k===void 0&&(k=0);for(var I=v(y,R,m,T,A,E),N=new Uint8Array(I.length*4),M=0;M<I.length;M++)N[M*4+k]=I[M];c(w,N,L,z,y,R,1<<3-k,V)}function B(y,R,m,T,A,E){var w=A-m,V=E-T,L=w*w+V*V,z=L?Math.max(0,Math.min(1,((y-m)*w+(R-T)*V)/L)):0,k=y-(m+z*w),I=R-(T+z*V);return k*k+I*I}var D=Object.freeze({__proto__:null,generate:v,generateIntoCanvas:p,generateIntoFramebuffer:_}),b="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",x="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",S="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",O=new Float32Array([0,0,2,0,0,2]),U=null,F=!1,j={},P=new WeakMap;function ee(y){if(!F&&!H(y))throw new Error("WebGL generation not supported")}function g(y,R,m,T,A,E,w){if(E===void 0&&(E=1),w===void 0&&(w=null),!w&&(w=U,!w)){var V=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!V)throw new Error("OffscreenCanvas or DOM canvas not supported");w=U=V.getContext("webgl",{depth:!1})}ee(w);var L=new Uint8Array(y*R*4);l(w,function(N){var M=N.gl,K=N.withTexture,q=N.withTextureFramebuffer;K("readable",function(Y,Z){M.texImage2D(M.TEXTURE_2D,0,M.RGBA,y,R,0,M.RGBA,M.UNSIGNED_BYTE,null),q(Y,Z,function(re){C(y,R,m,T,A,E,M,re,0,0,0),M.readPixels(0,0,y,R,M.RGBA,M.UNSIGNED_BYTE,L)})})});for(var z=new Uint8Array(y*R),k=0,I=0;k<L.length;k+=4)z[I++]=L[k];return z}function G(y,R,m,T,A,E,w,V,L,z){E===void 0&&(E=1),V===void 0&&(V=0),L===void 0&&(L=0),z===void 0&&(z=0),C(y,R,m,T,A,E,w,null,V,L,z)}function C(y,R,m,T,A,E,w,V,L,z,k){E===void 0&&(E=1),L===void 0&&(L=0),z===void 0&&(z=0),k===void 0&&(k=0),ee(w);var I=[];e(m,function(N,M,K,q){I.push(N,M,K,q)}),I=new Float32Array(I),l(w,function(N){var M=N.gl,K=N.isWebGL2,q=N.getExtension,Y=N.withProgram,Z=N.withTexture,re=N.withTextureFramebuffer,J=N.handleContextLoss;if(Z("rawDistances",function(oe,$){(y!==oe._lastWidth||R!==oe._lastHeight)&&M.texImage2D(M.TEXTURE_2D,0,M.RGBA,oe._lastWidth=y,oe._lastHeight=R,0,M.RGBA,M.UNSIGNED_BYTE,null),Y("main",b,x,function(W){var ue=W.setAttribute,te=W.setUniform,ie=!K&&q("ANGLE_instanced_arrays"),Q=!K&&q("EXT_blend_minmax");ue("aUV",2,M.STATIC_DRAW,0,O),ue("aLineSegment",4,M.DYNAMIC_DRAW,1,I),te.apply(void 0,["4f","uGlyphBounds"].concat(T)),te("1f","uMaxDistance",A),te("1f","uExponent",E),re(oe,$,function(Te){M.enable(M.BLEND),M.colorMask(!0,!0,!0,!0),M.viewport(0,0,y,R),M.scissor(0,0,y,R),M.blendFunc(M.ONE,M.ONE),M.blendEquationSeparate(M.FUNC_ADD,K?M.MAX:Q.MAX_EXT),M.clear(M.COLOR_BUFFER_BIT),K?M.drawArraysInstanced(M.TRIANGLES,0,3,I.length/4):ie.drawArraysInstancedANGLE(M.TRIANGLES,0,3,I.length/4)})}),Y("post",r,S,function(W){W.setAttribute("aUV",2,M.STATIC_DRAW,0,O),W.setUniform("1i","tex",$),M.bindFramebuffer(M.FRAMEBUFFER,V),M.disable(M.BLEND),M.colorMask(k===0,k===1,k===2,k===3),M.viewport(L,z,y,R),M.scissor(L,z,y,R),M.drawArrays(M.TRIANGLES,0,3)})}),M.isContextLost())throw J(),new Error("webgl context lost")})}function H(y){var R=!y||y===U?j:y.canvas||y,m=P.get(R);if(m===void 0){F=!0;var T=null;try{var A=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],E=g(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,y);m=E&&A.length===E.length&&E.every(function(w,V){return w===A[V]}),m||(T="bad trial run results",console.info(A,E))}catch(w){m=!1,T=w.message}T&&console.warn("WebGL SDF generation not supported:",T),F=!1,P.set(R,m)}return m}var X=Object.freeze({__proto__:null,generate:g,generateIntoCanvas:G,generateIntoFramebuffer:C,isSupported:H});function ne(y,R,m,T,A,E){A===void 0&&(A=Math.max(T[2]-T[0],T[3]-T[1])/2),E===void 0&&(E=1);try{return g.apply(X,arguments)}catch(w){return console.info("WebGL SDF generation failed, falling back to JS",w),v.apply(D,arguments)}}function ae(y,R,m,T,A,E,w,V,L,z){A===void 0&&(A=Math.max(T[2]-T[0],T[3]-T[1])/2),E===void 0&&(E=1),V===void 0&&(V=0),L===void 0&&(L=0),z===void 0&&(z=0);try{return G.apply(X,arguments)}catch(k){return console.info("WebGL SDF generation failed, falling back to JS",k),p.apply(D,arguments)}}return n.forEachPathCommand=t,n.generate=ne,n.generateIntoCanvas=ae,n.javascript=D,n.pathToLineSegments=e,n.webgl=X,n.webglUtils=h,Object.defineProperty(n,"__esModule",{value:!0}),n}({});return s}function ys(){var s=function(n){var u={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},f={},t={};f.L=1,t[1]="L",Object.keys(u).forEach(function(J,oe){f[J]=1<<oe+1,t[f[J]]=J}),Object.freeze(f);var e=f.LRI|f.RLI|f.FSI,r=f.L|f.R|f.AL,i=f.B|f.S|f.WS|f.ON|f.FSI|f.LRI|f.RLI|f.PDI,o=f.BN|f.RLE|f.LRE|f.RLO|f.LRO|f.PDF,a=f.S|f.WS|f.B|e|f.PDI|o,l=null;function c(){if(!l){l=new Map;var J=function($){if(u.hasOwnProperty($)){var W=0;u[$].split(",").forEach(function(ue){var te=ue.split("+"),ie=te[0],Q=te[1];ie=parseInt(ie,36),Q=Q?parseInt(Q,36):0,l.set(W+=ie,f[$]);for(var Te=0;Te<Q;Te++)l.set(++W,f[$])})}};for(var oe in u)J(oe)}}function d(J){return c(),l.get(J.codePointAt(0))||f.L}function h(J){return t[d(J)]}var v={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function p(J,oe){var $=36,W=0,ue=new Map,te=oe&&new Map,ie;return J.split(",").forEach(function Q(Te){if(Te.indexOf("+")!==-1)for(var se=+Te;se--;)Q(ie);else{ie=Te;var le=Te.split(">"),de=le[0],ge=le[1];de=String.fromCodePoint(W+=parseInt(de,$)),ge=String.fromCodePoint(W+=parseInt(ge,$)),ue.set(de,ge),oe&&te.set(ge,de)}}),{map:ue,reverseMap:te}}var _,B,D;function b(){if(!_){var J=p(v.pairs,!0),oe=J.map,$=J.reverseMap;_=oe,B=$,D=p(v.canonical,!1).map}}function x(J){return b(),_.get(J)||null}function S(J){return b(),B.get(J)||null}function O(J){return b(),D.get(J)||null}var U=f.L,F=f.R,j=f.EN,P=f.ES,ee=f.ET,g=f.AN,G=f.CS,C=f.B,H=f.S,X=f.ON,ne=f.BN,ae=f.NSM,y=f.AL,R=f.LRO,m=f.RLO,T=f.LRE,A=f.RLE,E=f.PDF,w=f.LRI,V=f.RLI,L=f.FSI,z=f.PDI;function k(J,oe){for(var $=125,W=new Uint32Array(J.length),ue=0;ue<J.length;ue++)W[ue]=d(J[ue]);var te=new Map;function ie(Ze,at){var qe=W[Ze];W[Ze]=at,te.set(qe,te.get(qe)-1),qe&i&&te.set(i,te.get(i)-1),te.set(at,(te.get(at)||0)+1),at&i&&te.set(i,(te.get(i)||0)+1)}for(var Q=new Uint8Array(J.length),Te=new Map,se=[],le=null,de=0;de<J.length;de++)le||se.push(le={start:de,end:J.length-1,level:oe==="rtl"?1:oe==="ltr"?0:oo(de,!1)}),W[de]&C&&(le.end=de,le=null);for(var ge=A|T|m|R|e|z|E|C,Ce=function(Ze){return Ze+(Ze&1?1:2)},Ae=function(Ze){return Ze+(Ze&1?2:1)},pe=0;pe<se.length;pe++){le=se[pe];var me=[{_level:le.level,_override:0,_isolate:0}],ce=void 0,ve=0,_e=0,Ie=0;te.clear();for(var De=le.start;De<=le.end;De++){var fe=W[De];if(ce=me[me.length-1],te.set(fe,(te.get(fe)||0)+1),fe&i&&te.set(i,(te.get(i)||0)+1),fe&ge)if(fe&(A|T)){Q[De]=ce._level;var Ue=(fe===A?Ae:Ce)(ce._level);Ue<=$&&!ve&&!_e?me.push({_level:Ue,_override:0,_isolate:0}):ve||_e++}else if(fe&(m|R)){Q[De]=ce._level;var et=(fe===m?Ae:Ce)(ce._level);et<=$&&!ve&&!_e?me.push({_level:et,_override:fe&m?F:U,_isolate:0}):ve||_e++}else if(fe&e){fe&L&&(fe=oo(De+1,!0)===1?V:w),Q[De]=ce._level,ce._override&&ie(De,ce._override);var Se=(fe===V?Ae:Ce)(ce._level);Se<=$&&ve===0&&_e===0?(Ie++,me.push({_level:Se,_override:0,_isolate:1,_isolInitIndex:De})):ve++}else if(fe&z){if(ve>0)ve--;else if(Ie>0){for(_e=0;!me[me.length-1]._isolate;)me.pop();var xe=me[me.length-1]._isolInitIndex;xe!=null&&(Te.set(xe,De),Te.set(De,xe)),me.pop(),Ie--}ce=me[me.length-1],Q[De]=ce._level,ce._override&&ie(De,ce._override)}else fe&E?(ve===0&&(_e>0?_e--:!ce._isolate&&me.length>1&&(me.pop(),ce=me[me.length-1])),Q[De]=ce._level):fe&C&&(Q[De]=le.level);else Q[De]=ce._level,ce._override&&fe!==ne&&ie(De,ce._override)}for(var Pe=[],Ee=null,be=le.start;be<=le.end;be++){var Re=W[be];if(!(Re&o)){var He=Q[be],Ve=Re&e,Be=Re===z;Ee&&He===Ee._level?(Ee._end=be,Ee._endsWithIsolInit=Ve):Pe.push(Ee={_start:be,_end:be,_level:He,_startsWithPDI:Be,_endsWithIsolInit:Ve})}}for(var rt=[],ht=0;ht<Pe.length;ht++){var ct=Pe[ht];if(!ct._startsWithPDI||ct._startsWithPDI&&!Te.has(ct._start)){for(var pt=[Ee=ct],bt=void 0;Ee&&Ee._endsWithIsolInit&&(bt=Te.get(Ee._end))!=null;)for(var dt=ht+1;dt<Pe.length;dt++)if(Pe[dt]._start===bt){pt.push(Ee=Pe[dt]);break}for(var Ye=[],Tt=0;Tt<pt.length;Tt++)for(var Br=pt[Tt],Xn=Br._start;Xn<=Br._end;Xn++)Ye.push(Xn);for(var ba=Q[Ye[0]],Gr=le.level,cn=Ye[0]-1;cn>=0;cn--)if(!(W[cn]&o)){Gr=Q[cn];break}var Hn=Ye[Ye.length-1],Ta=Q[Hn],Nr=le.level;if(!(W[Hn]&e)){for(var dn=Hn+1;dn<=le.end;dn++)if(!(W[dn]&o)){Nr=Q[dn];break}}rt.push({_seqIndices:Ye,_sosType:Math.max(Gr,ba)%2?F:U,_eosType:Math.max(Nr,Ta)%2?F:U})}}for(var Yn=0;Yn<rt.length;Yn++){var Jn=rt[Yn],he=Jn._seqIndices,Xt=Jn._sosType,Sa=Jn._eosType,Dt=Q[he[0]]&1?F:U;if(te.get(ae))for(var hn=0;hn<he.length;hn++){var Wr=he[hn];if(W[Wr]&ae){for(var Kn=Xt,pn=hn-1;pn>=0;pn--)if(!(W[he[pn]]&o)){Kn=W[he[pn]];break}ie(Wr,Kn&(e|z)?X:Kn)}}if(te.get(j))for(var vn=0;vn<he.length;vn++){var Vr=he[vn];if(W[Vr]&j)for(var mn=vn-1;mn>=-1;mn--){var zr=mn===-1?Xt:W[he[mn]];if(zr&r){zr===y&&ie(Vr,g);break}}}if(te.get(y))for(var Zn=0;Zn<he.length;Zn++){var jr=he[Zn];W[jr]&y&&ie(jr,F)}if(te.get(P)||te.get(G))for(var Ht=1;Ht<he.length-1;Ht++){var qn=he[Ht];if(W[qn]&(P|G)){for(var At=0,Qn=0,$n=Ht-1;$n>=0&&(At=W[he[$n]],!!(At&o));$n--);for(var er=Ht+1;er<he.length&&(Qn=W[he[er]],!!(Qn&o));er++);At===Qn&&(W[qn]===P?At===j:At&(j|g))&&ie(qn,At)}}if(te.get(j))for(var it=0;it<he.length;it++){var wa=he[it];if(W[wa]&j){for(var gn=it-1;gn>=0&&W[he[gn]]&(ee|o);gn--)ie(he[gn],j);for(it++;it<he.length&&W[he[it]]&(ee|o|j);it++)W[he[it]]!==j&&ie(he[it],j)}}if(te.get(ee)||te.get(P)||te.get(G))for(var Yt=0;Yt<he.length;Yt++){var Xr=he[Yt];if(W[Xr]&(ee|P|G)){ie(Xr,X);for(var _n=Yt-1;_n>=0&&W[he[_n]]&o;_n--)ie(he[_n],X);for(var yn=Yt+1;yn<he.length&&W[he[yn]]&o;yn++)ie(he[yn],X)}}if(te.get(j))for(var tr=0,Hr=Xt;tr<he.length;tr++){var Yr=he[tr],nr=W[Yr];nr&j?Hr===U&&ie(Yr,U):nr&r&&(Hr=nr)}if(te.get(i)){var Jt=F|j|g,Jr=Jt|U,bn=[];{for(var Ft=[],Mt=0;Mt<he.length;Mt++)if(W[he[Mt]]&i){var Kt=J[he[Mt]],Kr=void 0;if(x(Kt)!==null)if(Ft.length<63)Ft.push({char:Kt,seqIndex:Mt});else break;else if((Kr=S(Kt))!==null)for(var Zt=Ft.length-1;Zt>=0;Zt--){var rr=Ft[Zt].char;if(rr===Kr||rr===S(O(Kt))||x(O(rr))===Kt){bn.push([Ft[Zt].seqIndex,Mt]),Ft.length=Zt;break}}}bn.sort(function(Ze,at){return Ze[0]-at[0]})}for(var or=0;or<bn.length;or++){for(var Zr=bn[or],Tn=Zr[0],ar=Zr[1],qr=!1,ot=0,ir=Tn+1;ir<ar;ir++){var Qr=he[ir];if(W[Qr]&Jr){qr=!0;var $r=W[Qr]&Jt?F:U;if($r===Dt){ot=$r;break}}}if(qr&&!ot){ot=Xt;for(var sr=Tn-1;sr>=0;sr--){var eo=he[sr];if(W[eo]&Jr){var to=W[eo]&Jt?F:U;to!==Dt?ot=to:ot=Dt;break}}}if(ot){if(W[he[Tn]]=W[he[ar]]=ot,ot!==Dt){for(var qt=Tn+1;qt<he.length;qt++)if(!(W[he[qt]]&o)){d(J[he[qt]])&ae&&(W[he[qt]]=ot);break}}if(ot!==Dt){for(var Qt=ar+1;Qt<he.length;Qt++)if(!(W[he[Qt]]&o)){d(J[he[Qt]])&ae&&(W[he[Qt]]=ot);break}}}}for(var vt=0;vt<he.length;vt++)if(W[he[vt]]&i){for(var no=vt,lr=vt,ur=Xt,$t=vt-1;$t>=0;$t--)if(W[he[$t]]&o)no=$t;else{ur=W[he[$t]]&Jt?F:U;break}for(var ro=Sa,en=vt+1;en<he.length;en++)if(W[he[en]]&(i|o))lr=en;else{ro=W[he[en]]&Jt?F:U;break}for(var fr=no;fr<=lr;fr++)W[he[fr]]=ur===ro?ur:Dt;vt=lr}}}for(var $e=le.start;$e<=le.end;$e++){var xa=Q[$e],Sn=W[$e];if(xa&1?Sn&(U|j|g)&&Q[$e]++:Sn&F?Q[$e]++:Sn&(g|j)&&(Q[$e]+=2),Sn&o&&(Q[$e]=$e===0?le.level:Q[$e-1]),$e===le.end||d(J[$e])&(H|C))for(var wn=$e;wn>=0&&d(J[wn])&a;wn--)Q[wn]=le.level}}return{levels:Q,paragraphs:se};function oo(Ze,at){for(var qe=Ze;qe<J.length;qe++){var mt=W[qe];if(mt&(F|y))return 1;if(mt&(C|U)||at&&mt===z)return 0;if(mt&e){var ao=Ua(qe);qe=ao===-1?J.length:ao}}return 0}function Ua(Ze){for(var at=1,qe=Ze+1;qe<J.length;qe++){var mt=W[qe];if(mt&C)break;if(mt&z){if(--at===0)return qe}else mt&e&&at++}return-1}}var I="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",N;function M(){if(!N){var J=p(I,!0),oe=J.map,$=J.reverseMap;$.forEach(function(W,ue){oe.set(ue,W)}),N=oe}}function K(J){return M(),N.get(J)||null}function q(J,oe,$,W){var ue=J.length;$=Math.max(0,$==null?0:+$),W=Math.min(ue-1,W==null?ue-1:+W);for(var te=new Map,ie=$;ie<=W;ie++)if(oe[ie]&1){var Q=K(J[ie]);Q!==null&&te.set(ie,Q)}return te}function Y(J,oe,$,W){var ue=J.length;$=Math.max(0,$==null?0:+$),W=Math.min(ue-1,W==null?ue-1:+W);var te=[];return oe.paragraphs.forEach(function(ie){var Q=Math.max($,ie.start),Te=Math.min(W,ie.end);if(Q<Te){for(var se=oe.levels.slice(Q,Te+1),le=Te;le>=Q&&d(J[le])&a;le--)se[le]=ie.level;for(var de=ie.level,ge=1/0,Ce=0;Ce<se.length;Ce++){var Ae=se[Ce];Ae>de&&(de=Ae),Ae<ge&&(ge=Ae|1)}for(var pe=de;pe>=ge;pe--)for(var me=0;me<se.length;me++)if(se[me]>=pe){for(var ce=me;me+1<se.length&&se[me+1]>=pe;)me++;me>ce&&te.push([ce+Q,me+Q])}}}),te}function Z(J,oe,$,W){var ue=re(J,oe,$,W),te=[].concat(J);return ue.forEach(function(ie,Q){te[Q]=(oe.levels[ie]&1?K(J[ie]):null)||J[ie]}),te.join("")}function re(J,oe,$,W){for(var ue=Y(J,oe,$,W),te=[],ie=0;ie<J.length;ie++)te[ie]=ie;return ue.forEach(function(Q){for(var Te=Q[0],se=Q[1],le=te.slice(Te,se+1),de=le.length;de--;)te[se-de]=le[de]}),te}return n.closingToOpeningBracket=S,n.getBidiCharType=d,n.getBidiCharTypeName=h,n.getCanonicalBracket=O,n.getEmbeddingLevels=k,n.getMirroredCharacter=K,n.getMirroredCharactersMap=q,n.getReorderSegments=Y,n.getReorderedIndices=re,n.getReorderedString=Z,n.openingToClosingBracket=x,Object.defineProperty(n,"__esModule",{value:!0}),n}({});return s}const ca=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Cr(s){const n=/^[ \t]*#include +<([\w\d./]+)>/gm;function u(f,t){let e=Wa[t];return e?Cr(e):f}return s.replace(n,u)}const Ne=[];for(let s=0;s<256;s++)Ne[s]=(s<16?"0":"")+s.toString(16);function bs(){const s=Math.random()*4294967295|0,n=Math.random()*4294967295|0,u=Math.random()*4294967295|0,f=Math.random()*4294967295|0;return(Ne[s&255]+Ne[s>>8&255]+Ne[s>>16&255]+Ne[s>>24&255]+"-"+Ne[n&255]+Ne[n>>8&255]+"-"+Ne[n>>16&15|64]+Ne[n>>24&255]+"-"+Ne[u&63|128]+Ne[u>>8&255]+"-"+Ne[u>>16&255]+Ne[u>>24&255]+Ne[f&255]+Ne[f>>8&255]+Ne[f>>16&255]+Ne[f>>24&255]).toUpperCase()}const xt=Object.assign||function(){let s=arguments[0];for(let n=1,u=arguments.length;n<u;n++){let f=arguments[n];if(f)for(let t in f)Object.prototype.hasOwnProperty.call(f,t)&&(s[t]=f[t])}return s},Ts=Date.now(),Do=new WeakMap,Ao=new Map;let Ss=1e10;function kr(s,n){const u=Cs(n);let f=Do.get(s);if(f||Do.set(s,f=Object.create(null)),f[u])return new f[u];const t=`_onBeforeCompile${u}`,e=function(a,l){s.onBeforeCompile.call(this,a,l);const c=this.customProgramCacheKey()+"|"+a.vertexShader+"|"+a.fragmentShader;let d=Ao[c];if(!d){const h=ws(this,a,n,u);d=Ao[c]=h}a.vertexShader=d.vertexShader,a.fragmentShader=d.fragmentShader,xt(a.uniforms,this.uniforms),n.timeUniform&&(a.uniforms[n.timeUniform]={get value(){return Date.now()-Ts}}),this[t]&&this[t](a)},r=function(){return i(n.chained?s:s.clone())},i=function(a){const l=Object.create(a,o);return Object.defineProperty(l,"baseMaterial",{value:s}),Object.defineProperty(l,"id",{value:Ss++}),l.uuid=bs(),l.uniforms=xt({},a.uniforms,n.uniforms),l.defines=xt({},a.defines,n.defines),l.defines[`TROIKA_DERIVED_MATERIAL_${u}`]="",l.extensions=xt({},a.extensions,n.extensions),l._listeners=void 0,l},o={constructor:{value:r},isDerivedMaterial:{value:!0},type:{get:()=>s.type,set:a=>{s.type=a}},isDerivedFrom:{writable:!0,configurable:!0,value:function(a){const l=this.baseMaterial;return a===l||l.isDerivedMaterial&&l.isDerivedFrom(a)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return s.customProgramCacheKey()+"|"+u}},onBeforeCompile:{get(){return e},set(a){this[t]=a}},copy:{writable:!0,configurable:!0,value:function(a){return s.copy.call(this,a),!s.isShaderMaterial&&!s.isDerivedMaterial&&(xt(this.extensions,a.extensions),xt(this.defines,a.defines),xt(this.uniforms,Pa.clone(a.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const a=new s.constructor;return i(a).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let a=this._depthMaterial;return a||(a=this._depthMaterial=kr(s.isDerivedMaterial?s.getDepthMaterial():new Ba({depthPacking:Ga}),n),a.defines.IS_DEPTH_MATERIAL="",a.uniforms=this.uniforms),a}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let a=this._distanceMaterial;return a||(a=this._distanceMaterial=kr(s.isDerivedMaterial?s.getDistanceMaterial():new Na,n),a.defines.IS_DISTANCE_MATERIAL="",a.uniforms=this.uniforms),a}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:a,_distanceMaterial:l}=this;a&&a.dispose(),l&&l.dispose(),s.dispose.call(this)}}};return f[u]=r,new r}function ws(s,{vertexShader:n,fragmentShader:u},f,t){let{vertexDefs:e,vertexMainIntro:r,vertexMainOutro:i,vertexTransform:o,fragmentDefs:a,fragmentMainIntro:l,fragmentMainOutro:c,fragmentColorTransform:d,customRewriter:h,timeUniform:v}=f;if(e=e||"",r=r||"",i=i||"",a=a||"",l=l||"",c=c||"",(o||h)&&(n=Cr(n)),(d||h)&&(u=u.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),u=Cr(u)),h){let p=h({vertexShader:n,fragmentShader:u});n=p.vertexShader,u=p.fragmentShader}if(d){let p=[];u=u.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,_=>(p.push(_),"")),c=`${d}
${p.join(`
`)}
${c}`}if(v){const p=`
uniform float ${v};
`;e=p+e,a=p+a}return o&&(n=`vec3 troika_position_${t};
vec3 troika_normal_${t};
vec2 troika_uv_${t};
${n}
`,e=`${e}
void troikaVertexTransform${t}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${o}
}
`,r=`
troika_position_${t} = vec3(position);
troika_normal_${t} = vec3(normal);
troika_uv_${t} = vec2(uv);
troikaVertexTransform${t}(troika_position_${t}, troika_normal_${t}, troika_uv_${t});
${r}
`,n=n.replace(/\b(position|normal|uv)\b/g,(p,_,B,D)=>/\battribute\s+vec[23]\s+$/.test(D.substr(0,B))?_:`troika_${_}_${t}`),s.map&&s.map.channel>0||(n=n.replace(/\bMAP_UV\b/g,`troika_uv_${t}`))),n=Fo(n,t,e,r,i),u=Fo(u,t,a,l,c),{vertexShader:n,fragmentShader:u}}function Fo(s,n,u,f,t){return(f||t||u)&&(s=s.replace(ca,`
${u}
void troikaOrigMain${n}() {`),s+=`
void main() {
  ${f}
  troikaOrigMain${n}();
  ${t}
}`),s}function xs(s,n){return s==="uniforms"?void 0:typeof n=="function"?n.toString():n}let Us=0;const Mo=new Map;function Cs(s){const n=JSON.stringify(s,xs);let u=Mo.get(n);return u==null&&Mo.set(n,u=++Us),u}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function ks(){return typeof window>"u"&&(self.window=self),function(s){var n={parse:function(t){var e=n._bin,r=new Uint8Array(t);if(e.readASCII(r,0,4)=="ttcf"){var i=4;e.readUshort(r,i),i+=2,e.readUshort(r,i),i+=2;var o=e.readUint(r,i);i+=4;for(var a=[],l=0;l<o;l++){var c=e.readUint(r,i);i+=4,a.push(n._readFont(r,c))}return a}return[n._readFont(r,0)]},_readFont:function(t,e){var r=n._bin,i=e;r.readFixed(t,e),e+=4;var o=r.readUshort(t,e);e+=2,r.readUshort(t,e),e+=2,r.readUshort(t,e),e+=2,r.readUshort(t,e),e+=2;for(var a=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],l={_data:t,_offset:i},c={},d=0;d<o;d++){var h=r.readASCII(t,e,4);e+=4,r.readUint(t,e),e+=4;var v=r.readUint(t,e);e+=4;var p=r.readUint(t,e);e+=4,c[h]={offset:v,length:p}}for(d=0;d<a.length;d++){var _=a[d];c[_]&&(l[_.trim()]=n[_.trim()].parse(t,c[_].offset,c[_].length,l))}return l},_tabOffset:function(t,e,r){for(var i=n._bin,o=i.readUshort(t,r+4),a=r+12,l=0;l<o;l++){var c=i.readASCII(t,a,4);a+=4,i.readUint(t,a),a+=4;var d=i.readUint(t,a);if(a+=4,i.readUint(t,a),a+=4,c==e)return d}return 0}};n._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return n._bin.readShort(t,e)/16384},readInt:function(t,e){return n._bin._view(t).getInt32(e)},readInt8:function(t,e){return n._bin._view(t).getInt8(e)},readShort:function(t,e){return n._bin._view(t).getInt16(e)},readUshort:function(t,e){return n._bin._view(t).getUint16(e)},readUshorts:function(t,e,r){for(var i=[],o=0;o<r;o++)i.push(n._bin.readUshort(t,e+2*o));return i},readUint:function(t,e){return n._bin._view(t).getUint32(e)},readUint64:function(t,e){return 4294967296*n._bin.readUint(t,e)+n._bin.readUint(t,e+4)},readASCII:function(t,e,r){for(var i="",o=0;o<r;o++)i+=String.fromCharCode(t[e+o]);return i},readUnicode:function(t,e,r){for(var i="",o=0;o<r;o++){var a=t[e++]<<8|t[e++];i+=String.fromCharCode(a)}return i},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,r){var i=n._bin._tdec;return i&&e==0&&r==t.length?i.decode(t):n._bin.readASCII(t,e,r)},readBytes:function(t,e,r){for(var i=[],o=0;o<r;o++)i.push(t[e+o]);return i},readASCIIArray:function(t,e,r){for(var i=[],o=0;o<r;o++)i.push(String.fromCharCode(t[e+o]));return i},_view:function(t){return t._dataView||(t._dataView=t.buffer?new DataView(t.buffer,t.byteOffset,t.byteLength):new DataView(new Uint8Array(t).buffer))}},n._lctf={},n._lctf.parse=function(t,e,r,i,o){var a=n._bin,l={},c=e;a.readFixed(t,e),e+=4;var d=a.readUshort(t,e);e+=2;var h=a.readUshort(t,e);e+=2;var v=a.readUshort(t,e);return e+=2,l.scriptList=n._lctf.readScriptList(t,c+d),l.featureList=n._lctf.readFeatureList(t,c+h),l.lookupList=n._lctf.readLookupList(t,c+v,o),l},n._lctf.readLookupList=function(t,e,r){var i=n._bin,o=e,a=[],l=i.readUshort(t,e);e+=2;for(var c=0;c<l;c++){var d=i.readUshort(t,e);e+=2;var h=n._lctf.readLookupTable(t,o+d,r);a.push(h)}return a},n._lctf.readLookupTable=function(t,e,r){var i=n._bin,o=e,a={tabs:[]};a.ltype=i.readUshort(t,e),e+=2,a.flag=i.readUshort(t,e),e+=2;var l=i.readUshort(t,e);e+=2;for(var c=a.ltype,d=0;d<l;d++){var h=i.readUshort(t,e);e+=2;var v=r(t,c,o+h,a);a.tabs.push(v)}return a},n._lctf.numOfOnes=function(t){for(var e=0,r=0;r<32;r++)t>>>r&1&&e++;return e},n._lctf.readClassDef=function(t,e){var r=n._bin,i=[],o=r.readUshort(t,e);if(e+=2,o==1){var a=r.readUshort(t,e);e+=2;var l=r.readUshort(t,e);e+=2;for(var c=0;c<l;c++)i.push(a+c),i.push(a+c),i.push(r.readUshort(t,e)),e+=2}if(o==2){var d=r.readUshort(t,e);for(e+=2,c=0;c<d;c++)i.push(r.readUshort(t,e)),e+=2,i.push(r.readUshort(t,e)),e+=2,i.push(r.readUshort(t,e)),e+=2}return i},n._lctf.getInterval=function(t,e){for(var r=0;r<t.length;r+=3){var i=t[r],o=t[r+1];if(t[r+2],i<=e&&e<=o)return r}return-1},n._lctf.readCoverage=function(t,e){var r=n._bin,i={};i.fmt=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);return e+=2,i.fmt==1&&(i.tab=r.readUshorts(t,e,o)),i.fmt==2&&(i.tab=r.readUshorts(t,e,3*o)),i},n._lctf.coverageIndex=function(t,e){var r=t.tab;if(t.fmt==1)return r.indexOf(e);if(t.fmt==2){var i=n._lctf.getInterval(r,e);if(i!=-1)return r[i+2]+(e-r[i])}return-1},n._lctf.readFeatureList=function(t,e){var r=n._bin,i=e,o=[],a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=r.readASCII(t,e,4);e+=4;var d=r.readUshort(t,e);e+=2;var h=n._lctf.readFeatureTable(t,i+d);h.tag=c.trim(),o.push(h)}return o},n._lctf.readFeatureTable=function(t,e){var r=n._bin,i=e,o={},a=r.readUshort(t,e);e+=2,a>0&&(o.featureParams=i+a);var l=r.readUshort(t,e);e+=2,o.tab=[];for(var c=0;c<l;c++)o.tab.push(r.readUshort(t,e+2*c));return o},n._lctf.readScriptList=function(t,e){var r=n._bin,i=e,o={},a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=r.readASCII(t,e,4);e+=4;var d=r.readUshort(t,e);e+=2,o[c.trim()]=n._lctf.readScriptTable(t,i+d)}return o},n._lctf.readScriptTable=function(t,e){var r=n._bin,i=e,o={},a=r.readUshort(t,e);e+=2,a>0&&(o.default=n._lctf.readLangSysTable(t,i+a));var l=r.readUshort(t,e);e+=2;for(var c=0;c<l;c++){var d=r.readASCII(t,e,4);e+=4;var h=r.readUshort(t,e);e+=2,o[d.trim()]=n._lctf.readLangSysTable(t,i+h)}return o},n._lctf.readLangSysTable=function(t,e){var r=n._bin,i={};r.readUshort(t,e),e+=2,i.reqFeature=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);return e+=2,i.features=r.readUshorts(t,e,o),i},n.CFF={},n.CFF.parse=function(t,e,r){var i=n._bin;(t=new Uint8Array(t.buffer,e,r))[e=0],t[++e],t[++e],t[++e],e++;var o=[];e=n.CFF.readIndex(t,e,o);for(var a=[],l=0;l<o.length-1;l++)a.push(i.readASCII(t,e+o[l],o[l+1]-o[l]));e+=o[o.length-1];var c=[];e=n.CFF.readIndex(t,e,c);var d=[];for(l=0;l<c.length-1;l++)d.push(n.CFF.readDict(t,e+c[l],e+c[l+1]));e+=c[c.length-1];var h=d[0],v=[];e=n.CFF.readIndex(t,e,v);var p=[];for(l=0;l<v.length-1;l++)p.push(i.readASCII(t,e+v[l],v[l+1]-v[l]));if(e+=v[v.length-1],n.CFF.readSubrs(t,e,h),h.CharStrings){e=h.CharStrings,v=[],e=n.CFF.readIndex(t,e,v);var _=[];for(l=0;l<v.length-1;l++)_.push(i.readBytes(t,e+v[l],v[l+1]-v[l]));h.CharStrings=_}if(h.ROS){e=h.FDArray;var B=[];for(e=n.CFF.readIndex(t,e,B),h.FDArray=[],l=0;l<B.length-1;l++){var D=n.CFF.readDict(t,e+B[l],e+B[l+1]);n.CFF._readFDict(t,D,p),h.FDArray.push(D)}e+=B[B.length-1],e=h.FDSelect,h.FDSelect=[];var b=t[e];if(e++,b!=3)throw b;var x=i.readUshort(t,e);for(e+=2,l=0;l<x+1;l++)h.FDSelect.push(i.readUshort(t,e),t[e+2]),e+=3}return h.Encoding&&(h.Encoding=n.CFF.readEncoding(t,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=n.CFF.readCharset(t,h.charset,h.CharStrings.length)),n.CFF._readFDict(t,h,p),h},n.CFF._readFDict=function(t,e,r){var i;for(var o in e.Private&&(i=e.Private[1],e.Private=n.CFF.readDict(t,i,i+e.Private[0]),e.Private.Subrs&&n.CFF.readSubrs(t,i+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(o)!=-1&&(e[o]=r[e[o]-426+35])},n.CFF.readSubrs=function(t,e,r){var i=n._bin,o=[];e=n.CFF.readIndex(t,e,o);var a,l=o.length;a=l<1240?107:l<33900?1131:32768,r.Bias=a,r.Subrs=[];for(var c=0;c<o.length-1;c++)r.Subrs.push(i.readBytes(t,e+o[c],o[c+1]-o[c]))},n.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],n.CFF.glyphByUnicode=function(t,e){for(var r=0;r<t.charset.length;r++)if(t.charset[r]==e)return r;return-1},n.CFF.glyphBySE=function(t,e){return e<0||e>255?-1:n.CFF.glyphByUnicode(t,n.CFF.tableSE[e])},n.CFF.readEncoding=function(t,e,r){n._bin;var i=[".notdef"],o=t[e];if(e++,o!=0)throw"error: unknown encoding format: "+o;var a=t[e];e++;for(var l=0;l<a;l++)i.push(t[e+l]);return i},n.CFF.readCharset=function(t,e,r){var i=n._bin,o=[".notdef"],a=t[e];if(e++,a==0)for(var l=0;l<r;l++){var c=i.readUshort(t,e);e+=2,o.push(c)}else{if(a!=1&&a!=2)throw"error: format: "+a;for(;o.length<r;){c=i.readUshort(t,e),e+=2;var d=0;for(a==1?(d=t[e],e++):(d=i.readUshort(t,e),e+=2),l=0;l<=d;l++)o.push(c),c++}}return o},n.CFF.readIndex=function(t,e,r){var i=n._bin,o=i.readUshort(t,e)+1,a=t[e+=2];if(e++,a==1)for(var l=0;l<o;l++)r.push(t[e+l]);else if(a==2)for(l=0;l<o;l++)r.push(i.readUshort(t,e+2*l));else if(a==3)for(l=0;l<o;l++)r.push(16777215&i.readUint(t,e+3*l-1));else if(o!=1)throw"unsupported offset size: "+a+", count: "+o;return(e+=o*a)-1},n.CFF.getCharString=function(t,e,r){var i=n._bin,o=t[e],a=t[e+1];t[e+2],t[e+3],t[e+4];var l=1,c=null,d=null;o<=20&&(c=o,l=1),o==12&&(c=100*o+a,l=2),21<=o&&o<=27&&(c=o,l=1),o==28&&(d=i.readShort(t,e+1),l=3),29<=o&&o<=31&&(c=o,l=1),32<=o&&o<=246&&(d=o-139,l=1),247<=o&&o<=250&&(d=256*(o-247)+a+108,l=2),251<=o&&o<=254&&(d=256*-(o-251)-a-108,l=2),o==255&&(d=i.readInt(t,e+1)/65535,l=5),r.val=d??"o"+c,r.size=l},n.CFF.readCharString=function(t,e,r){for(var i=e+r,o=n._bin,a=[];e<i;){var l=t[e],c=t[e+1];t[e+2],t[e+3],t[e+4];var d=1,h=null,v=null;l<=20&&(h=l,d=1),l==12&&(h=100*l+c,d=2),l!=19&&l!=20||(h=l,d=2),21<=l&&l<=27&&(h=l,d=1),l==28&&(v=o.readShort(t,e+1),d=3),29<=l&&l<=31&&(h=l,d=1),32<=l&&l<=246&&(v=l-139,d=1),247<=l&&l<=250&&(v=256*(l-247)+c+108,d=2),251<=l&&l<=254&&(v=256*-(l-251)-c-108,d=2),l==255&&(v=o.readInt(t,e+1)/65535,d=5),a.push(v??"o"+h),e+=d}return a},n.CFF.readDict=function(t,e,r){for(var i=n._bin,o={},a=[];e<r;){var l=t[e],c=t[e+1];t[e+2],t[e+3],t[e+4];var d=1,h=null,v=null;if(l==28&&(v=i.readShort(t,e+1),d=3),l==29&&(v=i.readInt(t,e+1),d=5),32<=l&&l<=246&&(v=l-139,d=1),247<=l&&l<=250&&(v=256*(l-247)+c+108,d=2),251<=l&&l<=254&&(v=256*-(l-251)-c-108,d=2),l==255)throw v=i.readInt(t,e+1)/65535,d=5,"unknown number";if(l==30){var p=[];for(d=1;;){var _=t[e+d];d++;var B=_>>4,D=15&_;if(B!=15&&p.push(B),D!=15&&p.push(D),D==15)break}for(var b="",x=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],S=0;S<p.length;S++)b+=x[p[S]];v=parseFloat(b)}l<=21&&(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][l],d=1,l==12&&(h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][c],d=2)),h!=null?(o[h]=a.length==1?a[0]:a,a=[]):a.push(v),e+=d}return o},n.cmap={},n.cmap.parse=function(t,e,r){t=new Uint8Array(t.buffer,e,r),e=0;var i=n._bin,o={};i.readUshort(t,e),e+=2;var a=i.readUshort(t,e);e+=2;var l=[];o.tables=[];for(var c=0;c<a;c++){var d=i.readUshort(t,e);e+=2;var h=i.readUshort(t,e);e+=2;var v=i.readUint(t,e);e+=4;var p="p"+d+"e"+h,_=l.indexOf(v);if(_==-1){var B;_=o.tables.length,l.push(v);var D=i.readUshort(t,v);D==0?B=n.cmap.parse0(t,v):D==4?B=n.cmap.parse4(t,v):D==6?B=n.cmap.parse6(t,v):D==12?B=n.cmap.parse12(t,v):console.debug("unknown format: "+D,d,h,v),o.tables.push(B)}if(o[p]!=null)throw"multiple tables for one platform+encoding";o[p]=_}return o},n.cmap.parse0=function(t,e){var r=n._bin,i={};i.format=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);e+=2,r.readUshort(t,e),e+=2,i.map=[];for(var a=0;a<o-6;a++)i.map.push(t[e+a]);return i},n.cmap.parse4=function(t,e){var r=n._bin,i=e,o={};o.format=r.readUshort(t,e),e+=2;var a=r.readUshort(t,e);e+=2,r.readUshort(t,e),e+=2;var l=r.readUshort(t,e);e+=2;var c=l/2;o.searchRange=r.readUshort(t,e),e+=2,o.entrySelector=r.readUshort(t,e),e+=2,o.rangeShift=r.readUshort(t,e),e+=2,o.endCount=r.readUshorts(t,e,c),e+=2*c,e+=2,o.startCount=r.readUshorts(t,e,c),e+=2*c,o.idDelta=[];for(var d=0;d<c;d++)o.idDelta.push(r.readShort(t,e)),e+=2;for(o.idRangeOffset=r.readUshorts(t,e,c),e+=2*c,o.glyphIdArray=[];e<i+a;)o.glyphIdArray.push(r.readUshort(t,e)),e+=2;return o},n.cmap.parse6=function(t,e){var r=n._bin,i={};i.format=r.readUshort(t,e),e+=2,r.readUshort(t,e),e+=2,r.readUshort(t,e),e+=2,i.firstCode=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);e+=2,i.glyphIdArray=[];for(var a=0;a<o;a++)i.glyphIdArray.push(r.readUshort(t,e)),e+=2;return i},n.cmap.parse12=function(t,e){var r=n._bin,i={};i.format=r.readUshort(t,e),e+=2,e+=2,r.readUint(t,e),e+=4,r.readUint(t,e),e+=4;var o=r.readUint(t,e);e+=4,i.groups=[];for(var a=0;a<o;a++){var l=e+12*a,c=r.readUint(t,l+0),d=r.readUint(t,l+4),h=r.readUint(t,l+8);i.groups.push([c,d,h])}return i},n.glyf={},n.glyf.parse=function(t,e,r,i){for(var o=[],a=0;a<i.maxp.numGlyphs;a++)o.push(null);return o},n.glyf._parseGlyf=function(t,e){var r=n._bin,i=t._data,o=n._tabOffset(i,"glyf",t._offset)+t.loca[e];if(t.loca[e]==t.loca[e+1])return null;var a={};if(a.noc=r.readShort(i,o),o+=2,a.xMin=r.readShort(i,o),o+=2,a.yMin=r.readShort(i,o),o+=2,a.xMax=r.readShort(i,o),o+=2,a.yMax=r.readShort(i,o),o+=2,a.xMin>=a.xMax||a.yMin>=a.yMax)return null;if(a.noc>0){a.endPts=[];for(var l=0;l<a.noc;l++)a.endPts.push(r.readUshort(i,o)),o+=2;var c=r.readUshort(i,o);if(o+=2,i.length-o<c)return null;a.instructions=r.readBytes(i,o,c),o+=c;var d=a.endPts[a.noc-1]+1;for(a.flags=[],l=0;l<d;l++){var h=i[o];if(o++,a.flags.push(h),(8&h)!=0){var v=i[o];o++;for(var p=0;p<v;p++)a.flags.push(h),l++}}for(a.xs=[],l=0;l<d;l++){var _=(2&a.flags[l])!=0,B=(16&a.flags[l])!=0;_?(a.xs.push(B?i[o]:-i[o]),o++):B?a.xs.push(0):(a.xs.push(r.readShort(i,o)),o+=2)}for(a.ys=[],l=0;l<d;l++)_=(4&a.flags[l])!=0,B=(32&a.flags[l])!=0,_?(a.ys.push(B?i[o]:-i[o]),o++):B?a.ys.push(0):(a.ys.push(r.readShort(i,o)),o+=2);var D=0,b=0;for(l=0;l<d;l++)D+=a.xs[l],b+=a.ys[l],a.xs[l]=D,a.ys[l]=b}else{var x;a.parts=[];do{x=r.readUshort(i,o),o+=2;var S={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(a.parts.push(S),S.glyphIndex=r.readUshort(i,o),o+=2,1&x){var O=r.readShort(i,o);o+=2;var U=r.readShort(i,o);o+=2}else O=r.readInt8(i,o),o++,U=r.readInt8(i,o),o++;2&x?(S.m.tx=O,S.m.ty=U):(S.p1=O,S.p2=U),8&x?(S.m.a=S.m.d=r.readF2dot14(i,o),o+=2):64&x?(S.m.a=r.readF2dot14(i,o),o+=2,S.m.d=r.readF2dot14(i,o),o+=2):128&x&&(S.m.a=r.readF2dot14(i,o),o+=2,S.m.b=r.readF2dot14(i,o),o+=2,S.m.c=r.readF2dot14(i,o),o+=2,S.m.d=r.readF2dot14(i,o),o+=2)}while(32&x);if(256&x){var F=r.readUshort(i,o);for(o+=2,a.instr=[],l=0;l<F;l++)a.instr.push(i[o]),o++}}return a},n.GDEF={},n.GDEF.parse=function(t,e,r,i){var o=e;e+=4;var a=n._bin.readUshort(t,e);return{glyphClassDef:a===0?null:n._lctf.readClassDef(t,o+a)}},n.GPOS={},n.GPOS.parse=function(t,e,r,i){return n._lctf.parse(t,e,r,i,n.GPOS.subt)},n.GPOS.subt=function(t,e,r,i){var o=n._bin,a=r,l={};if(l.fmt=o.readUshort(t,r),r+=2,e==1||e==2||e==3||e==7||e==8&&l.fmt<=2){var c=o.readUshort(t,r);r+=2,l.coverage=n._lctf.readCoverage(t,c+a)}if(e==1&&l.fmt==1){var d=o.readUshort(t,r);r+=2,d!=0&&(l.pos=n.GPOS.readValueRecord(t,r,d))}else if(e==2&&l.fmt>=1&&l.fmt<=2){d=o.readUshort(t,r),r+=2;var h=o.readUshort(t,r);r+=2;var v=n._lctf.numOfOnes(d),p=n._lctf.numOfOnes(h);if(l.fmt==1){l.pairsets=[];var _=o.readUshort(t,r);r+=2;for(var B=0;B<_;B++){var D=a+o.readUshort(t,r);r+=2;var b=o.readUshort(t,D);D+=2;for(var x=[],S=0;S<b;S++){var O=o.readUshort(t,D);D+=2,d!=0&&(g=n.GPOS.readValueRecord(t,D,d),D+=2*v),h!=0&&(G=n.GPOS.readValueRecord(t,D,h),D+=2*p),x.push({gid2:O,val1:g,val2:G})}l.pairsets.push(x)}}if(l.fmt==2){var U=o.readUshort(t,r);r+=2;var F=o.readUshort(t,r);r+=2;var j=o.readUshort(t,r);r+=2;var P=o.readUshort(t,r);for(r+=2,l.classDef1=n._lctf.readClassDef(t,a+U),l.classDef2=n._lctf.readClassDef(t,a+F),l.matrix=[],B=0;B<j;B++){var ee=[];for(S=0;S<P;S++){var g=null,G=null;d!=0&&(g=n.GPOS.readValueRecord(t,r,d),r+=2*v),h!=0&&(G=n.GPOS.readValueRecord(t,r,h),r+=2*p),ee.push({val1:g,val2:G})}l.matrix.push(ee)}}}else if(e==4&&l.fmt==1)l.markCoverage=n._lctf.readCoverage(t,o.readUshort(t,r)+a),l.baseCoverage=n._lctf.readCoverage(t,o.readUshort(t,r+2)+a),l.markClassCount=o.readUshort(t,r+4),l.markArray=n.GPOS.readMarkArray(t,o.readUshort(t,r+6)+a),l.baseArray=n.GPOS.readBaseArray(t,o.readUshort(t,r+8)+a,l.markClassCount);else if(e==6&&l.fmt==1)l.mark1Coverage=n._lctf.readCoverage(t,o.readUshort(t,r)+a),l.mark2Coverage=n._lctf.readCoverage(t,o.readUshort(t,r+2)+a),l.markClassCount=o.readUshort(t,r+4),l.mark1Array=n.GPOS.readMarkArray(t,o.readUshort(t,r+6)+a),l.mark2Array=n.GPOS.readBaseArray(t,o.readUshort(t,r+8)+a,l.markClassCount);else{if(e==9&&l.fmt==1){var C=o.readUshort(t,r);r+=2;var H=o.readUint(t,r);if(r+=4,i.ltype==9)i.ltype=C;else if(i.ltype!=C)throw"invalid extension substitution";return n.GPOS.subt(t,i.ltype,a+H)}console.debug("unsupported GPOS table LookupType",e,"format",l.fmt)}return l},n.GPOS.readValueRecord=function(t,e,r){var i=n._bin,o=[];return o.push(1&r?i.readShort(t,e):0),e+=1&r?2:0,o.push(2&r?i.readShort(t,e):0),e+=2&r?2:0,o.push(4&r?i.readShort(t,e):0),e+=4&r?2:0,o.push(8&r?i.readShort(t,e):0),e+=8&r?2:0,o},n.GPOS.readBaseArray=function(t,e,r){var i=n._bin,o=[],a=e,l=i.readUshort(t,e);e+=2;for(var c=0;c<l;c++){for(var d=[],h=0;h<r;h++)d.push(n.GPOS.readAnchorRecord(t,a+i.readUshort(t,e))),e+=2;o.push(d)}return o},n.GPOS.readMarkArray=function(t,e){var r=n._bin,i=[],o=e,a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=n.GPOS.readAnchorRecord(t,r.readUshort(t,e+2)+o);c.markClass=r.readUshort(t,e),i.push(c),e+=4}return i},n.GPOS.readAnchorRecord=function(t,e){var r=n._bin,i={};return i.fmt=r.readUshort(t,e),i.x=r.readShort(t,e+2),i.y=r.readShort(t,e+4),i},n.GSUB={},n.GSUB.parse=function(t,e,r,i){return n._lctf.parse(t,e,r,i,n.GSUB.subt)},n.GSUB.subt=function(t,e,r,i){var o=n._bin,a=r,l={};if(l.fmt=o.readUshort(t,r),r+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&l.fmt<=2||e==6&&l.fmt<=2){var c=o.readUshort(t,r);r+=2,l.coverage=n._lctf.readCoverage(t,a+c)}if(e==1&&l.fmt>=1&&l.fmt<=2){if(l.fmt==1)l.delta=o.readShort(t,r),r+=2;else if(l.fmt==2){var d=o.readUshort(t,r);r+=2,l.newg=o.readUshorts(t,r,d),r+=2*l.newg.length}}else if(e==2&&l.fmt==1){d=o.readUshort(t,r),r+=2,l.seqs=[];for(var h=0;h<d;h++){var v=o.readUshort(t,r)+a;r+=2;var p=o.readUshort(t,v);l.seqs.push(o.readUshorts(t,v+2,p))}}else if(e==4)for(l.vals=[],d=o.readUshort(t,r),r+=2,h=0;h<d;h++){var _=o.readUshort(t,r);r+=2,l.vals.push(n.GSUB.readLigatureSet(t,a+_))}else if(e==5&&l.fmt==2){if(l.fmt==2){var B=o.readUshort(t,r);r+=2,l.cDef=n._lctf.readClassDef(t,a+B),l.scset=[];var D=o.readUshort(t,r);for(r+=2,h=0;h<D;h++){var b=o.readUshort(t,r);r+=2,l.scset.push(b==0?null:n.GSUB.readSubClassSet(t,a+b))}}}else if(e==6&&l.fmt==3){if(l.fmt==3){for(h=0;h<3;h++){d=o.readUshort(t,r),r+=2;for(var x=[],S=0;S<d;S++)x.push(n._lctf.readCoverage(t,a+o.readUshort(t,r+2*S)));r+=2*d,h==0&&(l.backCvg=x),h==1&&(l.inptCvg=x),h==2&&(l.ahedCvg=x)}d=o.readUshort(t,r),r+=2,l.lookupRec=n.GSUB.readSubstLookupRecords(t,r,d)}}else{if(e==7&&l.fmt==1){var O=o.readUshort(t,r);r+=2;var U=o.readUint(t,r);if(r+=4,i.ltype==9)i.ltype=O;else if(i.ltype!=O)throw"invalid extension substitution";return n.GSUB.subt(t,i.ltype,a+U)}console.debug("unsupported GSUB table LookupType",e,"format",l.fmt)}return l},n.GSUB.readSubClassSet=function(t,e){var r=n._bin.readUshort,i=e,o=[],a=r(t,e);e+=2;for(var l=0;l<a;l++){var c=r(t,e);e+=2,o.push(n.GSUB.readSubClassRule(t,i+c))}return o},n.GSUB.readSubClassRule=function(t,e){var r=n._bin.readUshort,i={},o=r(t,e),a=r(t,e+=2);e+=2,i.input=[];for(var l=0;l<o-1;l++)i.input.push(r(t,e)),e+=2;return i.substLookupRecords=n.GSUB.readSubstLookupRecords(t,e,a),i},n.GSUB.readSubstLookupRecords=function(t,e,r){for(var i=n._bin.readUshort,o=[],a=0;a<r;a++)o.push(i(t,e),i(t,e+2)),e+=4;return o},n.GSUB.readChainSubClassSet=function(t,e){var r=n._bin,i=e,o=[],a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=r.readUshort(t,e);e+=2,o.push(n.GSUB.readChainSubClassRule(t,i+c))}return o},n.GSUB.readChainSubClassRule=function(t,e){for(var r=n._bin,i={},o=["backtrack","input","lookahead"],a=0;a<o.length;a++){var l=r.readUshort(t,e);e+=2,a==1&&l--,i[o[a]]=r.readUshorts(t,e,l),e+=2*i[o[a]].length}return l=r.readUshort(t,e),e+=2,i.subst=r.readUshorts(t,e,2*l),e+=2*i.subst.length,i},n.GSUB.readLigatureSet=function(t,e){var r=n._bin,i=e,o=[],a=r.readUshort(t,e);e+=2;for(var l=0;l<a;l++){var c=r.readUshort(t,e);e+=2,o.push(n.GSUB.readLigature(t,i+c))}return o},n.GSUB.readLigature=function(t,e){var r=n._bin,i={chain:[]};i.nglyph=r.readUshort(t,e),e+=2;var o=r.readUshort(t,e);e+=2;for(var a=0;a<o-1;a++)i.chain.push(r.readUshort(t,e)),e+=2;return i},n.head={},n.head.parse=function(t,e,r){var i=n._bin,o={};return i.readFixed(t,e),e+=4,o.fontRevision=i.readFixed(t,e),e+=4,i.readUint(t,e),e+=4,i.readUint(t,e),e+=4,o.flags=i.readUshort(t,e),e+=2,o.unitsPerEm=i.readUshort(t,e),e+=2,o.created=i.readUint64(t,e),e+=8,o.modified=i.readUint64(t,e),e+=8,o.xMin=i.readShort(t,e),e+=2,o.yMin=i.readShort(t,e),e+=2,o.xMax=i.readShort(t,e),e+=2,o.yMax=i.readShort(t,e),e+=2,o.macStyle=i.readUshort(t,e),e+=2,o.lowestRecPPEM=i.readUshort(t,e),e+=2,o.fontDirectionHint=i.readShort(t,e),e+=2,o.indexToLocFormat=i.readShort(t,e),e+=2,o.glyphDataFormat=i.readShort(t,e),e+=2,o},n.hhea={},n.hhea.parse=function(t,e,r){var i=n._bin,o={};return i.readFixed(t,e),e+=4,o.ascender=i.readShort(t,e),e+=2,o.descender=i.readShort(t,e),e+=2,o.lineGap=i.readShort(t,e),e+=2,o.advanceWidthMax=i.readUshort(t,e),e+=2,o.minLeftSideBearing=i.readShort(t,e),e+=2,o.minRightSideBearing=i.readShort(t,e),e+=2,o.xMaxExtent=i.readShort(t,e),e+=2,o.caretSlopeRise=i.readShort(t,e),e+=2,o.caretSlopeRun=i.readShort(t,e),e+=2,o.caretOffset=i.readShort(t,e),e+=2,e+=8,o.metricDataFormat=i.readShort(t,e),e+=2,o.numberOfHMetrics=i.readUshort(t,e),e+=2,o},n.hmtx={},n.hmtx.parse=function(t,e,r,i){for(var o=n._bin,a={aWidth:[],lsBearing:[]},l=0,c=0,d=0;d<i.maxp.numGlyphs;d++)d<i.hhea.numberOfHMetrics&&(l=o.readUshort(t,e),e+=2,c=o.readShort(t,e),e+=2),a.aWidth.push(l),a.lsBearing.push(c);return a},n.kern={},n.kern.parse=function(t,e,r,i){var o=n._bin,a=o.readUshort(t,e);if(e+=2,a==1)return n.kern.parseV1(t,e-2,r,i);var l=o.readUshort(t,e);e+=2;for(var c={glyph1:[],rval:[]},d=0;d<l;d++){e+=2,r=o.readUshort(t,e),e+=2;var h=o.readUshort(t,e);e+=2;var v=h>>>8;if((v&=15)!=0)throw"unknown kern table format: "+v;e=n.kern.readFormat0(t,e,c)}return c},n.kern.parseV1=function(t,e,r,i){var o=n._bin;o.readFixed(t,e),e+=4;var a=o.readUint(t,e);e+=4;for(var l={glyph1:[],rval:[]},c=0;c<a;c++){o.readUint(t,e),e+=4;var d=o.readUshort(t,e);e+=2,o.readUshort(t,e),e+=2;var h=d>>>8;if((h&=15)!=0)throw"unknown kern table format: "+h;e=n.kern.readFormat0(t,e,l)}return l},n.kern.readFormat0=function(t,e,r){var i=n._bin,o=-1,a=i.readUshort(t,e);e+=2,i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2;for(var l=0;l<a;l++){var c=i.readUshort(t,e);e+=2;var d=i.readUshort(t,e);e+=2;var h=i.readShort(t,e);e+=2,c!=o&&(r.glyph1.push(c),r.rval.push({glyph2:[],vals:[]}));var v=r.rval[r.rval.length-1];v.glyph2.push(d),v.vals.push(h),o=c}return e},n.loca={},n.loca.parse=function(t,e,r,i){var o=n._bin,a=[],l=i.head.indexToLocFormat,c=i.maxp.numGlyphs+1;if(l==0)for(var d=0;d<c;d++)a.push(o.readUshort(t,e+(d<<1))<<1);if(l==1)for(d=0;d<c;d++)a.push(o.readUint(t,e+(d<<2)));return a},n.maxp={},n.maxp.parse=function(t,e,r){var i=n._bin,o={},a=i.readUint(t,e);return e+=4,o.numGlyphs=i.readUshort(t,e),e+=2,a==65536&&(o.maxPoints=i.readUshort(t,e),e+=2,o.maxContours=i.readUshort(t,e),e+=2,o.maxCompositePoints=i.readUshort(t,e),e+=2,o.maxCompositeContours=i.readUshort(t,e),e+=2,o.maxZones=i.readUshort(t,e),e+=2,o.maxTwilightPoints=i.readUshort(t,e),e+=2,o.maxStorage=i.readUshort(t,e),e+=2,o.maxFunctionDefs=i.readUshort(t,e),e+=2,o.maxInstructionDefs=i.readUshort(t,e),e+=2,o.maxStackElements=i.readUshort(t,e),e+=2,o.maxSizeOfInstructions=i.readUshort(t,e),e+=2,o.maxComponentElements=i.readUshort(t,e),e+=2,o.maxComponentDepth=i.readUshort(t,e),e+=2),o},n.name={},n.name.parse=function(t,e,r){var i=n._bin,o={};i.readUshort(t,e),e+=2;var a=i.readUshort(t,e);e+=2,i.readUshort(t,e);for(var l,c=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=e+=2,h=0;h<a;h++){var v=i.readUshort(t,e);e+=2;var p=i.readUshort(t,e);e+=2;var _=i.readUshort(t,e);e+=2;var B=i.readUshort(t,e);e+=2;var D=i.readUshort(t,e);e+=2;var b=i.readUshort(t,e);e+=2;var x,S=c[B],O=d+12*a+b;if(v==0)x=i.readUnicode(t,O,D/2);else if(v==3&&p==0)x=i.readUnicode(t,O,D/2);else if(p==0)x=i.readASCII(t,O,D);else if(p==1)x=i.readUnicode(t,O,D/2);else if(p==3)x=i.readUnicode(t,O,D/2);else{if(v!=1)throw"unknown encoding "+p+", platformID: "+v;x=i.readASCII(t,O,D),console.debug("reading unknown MAC encoding "+p+" as ASCII")}var U="p"+v+","+_.toString(16);o[U]==null&&(o[U]={}),o[U][S!==void 0?S:B]=x,o[U]._lang=_}for(var F in o)if(o[F].postScriptName!=null&&o[F]._lang==1033)return o[F];for(var F in o)if(o[F].postScriptName!=null&&o[F]._lang==0)return o[F];for(var F in o)if(o[F].postScriptName!=null&&o[F]._lang==3084)return o[F];for(var F in o)if(o[F].postScriptName!=null)return o[F];for(var F in o){l=F;break}return console.debug("returning name table with languageID "+o[l]._lang),o[l]},n["OS/2"]={},n["OS/2"].parse=function(t,e,r){var i=n._bin.readUshort(t,e);e+=2;var o={};if(i==0)n["OS/2"].version0(t,e,o);else if(i==1)n["OS/2"].version1(t,e,o);else if(i==2||i==3||i==4)n["OS/2"].version2(t,e,o);else{if(i!=5)throw"unknown OS/2 table version: "+i;n["OS/2"].version5(t,e,o)}return o},n["OS/2"].version0=function(t,e,r){var i=n._bin;return r.xAvgCharWidth=i.readShort(t,e),e+=2,r.usWeightClass=i.readUshort(t,e),e+=2,r.usWidthClass=i.readUshort(t,e),e+=2,r.fsType=i.readUshort(t,e),e+=2,r.ySubscriptXSize=i.readShort(t,e),e+=2,r.ySubscriptYSize=i.readShort(t,e),e+=2,r.ySubscriptXOffset=i.readShort(t,e),e+=2,r.ySubscriptYOffset=i.readShort(t,e),e+=2,r.ySuperscriptXSize=i.readShort(t,e),e+=2,r.ySuperscriptYSize=i.readShort(t,e),e+=2,r.ySuperscriptXOffset=i.readShort(t,e),e+=2,r.ySuperscriptYOffset=i.readShort(t,e),e+=2,r.yStrikeoutSize=i.readShort(t,e),e+=2,r.yStrikeoutPosition=i.readShort(t,e),e+=2,r.sFamilyClass=i.readShort(t,e),e+=2,r.panose=i.readBytes(t,e,10),e+=10,r.ulUnicodeRange1=i.readUint(t,e),e+=4,r.ulUnicodeRange2=i.readUint(t,e),e+=4,r.ulUnicodeRange3=i.readUint(t,e),e+=4,r.ulUnicodeRange4=i.readUint(t,e),e+=4,r.achVendID=[i.readInt8(t,e),i.readInt8(t,e+1),i.readInt8(t,e+2),i.readInt8(t,e+3)],e+=4,r.fsSelection=i.readUshort(t,e),e+=2,r.usFirstCharIndex=i.readUshort(t,e),e+=2,r.usLastCharIndex=i.readUshort(t,e),e+=2,r.sTypoAscender=i.readShort(t,e),e+=2,r.sTypoDescender=i.readShort(t,e),e+=2,r.sTypoLineGap=i.readShort(t,e),e+=2,r.usWinAscent=i.readUshort(t,e),e+=2,r.usWinDescent=i.readUshort(t,e),e+=2},n["OS/2"].version1=function(t,e,r){var i=n._bin;return e=n["OS/2"].version0(t,e,r),r.ulCodePageRange1=i.readUint(t,e),e+=4,r.ulCodePageRange2=i.readUint(t,e),e+=4},n["OS/2"].version2=function(t,e,r){var i=n._bin;return e=n["OS/2"].version1(t,e,r),r.sxHeight=i.readShort(t,e),e+=2,r.sCapHeight=i.readShort(t,e),e+=2,r.usDefault=i.readUshort(t,e),e+=2,r.usBreak=i.readUshort(t,e),e+=2,r.usMaxContext=i.readUshort(t,e),e+=2},n["OS/2"].version5=function(t,e,r){var i=n._bin;return e=n["OS/2"].version2(t,e,r),r.usLowerOpticalPointSize=i.readUshort(t,e),e+=2,r.usUpperOpticalPointSize=i.readUshort(t,e),e+=2},n.post={},n.post.parse=function(t,e,r){var i=n._bin,o={};return o.version=i.readFixed(t,e),e+=4,o.italicAngle=i.readFixed(t,e),e+=4,o.underlinePosition=i.readShort(t,e),e+=2,o.underlineThickness=i.readShort(t,e),e+=2,o},n==null&&(n={}),n.U==null&&(n.U={}),n.U.codeToGlyph=function(t,e){var r=t.cmap,i=-1;if(r.p0e4!=null?i=r.p0e4:r.p3e1!=null?i=r.p3e1:r.p1e0!=null?i=r.p1e0:r.p0e3!=null&&(i=r.p0e3),i==-1)throw"no familiar platform and encoding!";var o=r.tables[i];if(o.format==0)return e>=o.map.length?0:o.map[e];if(o.format==4){for(var a=-1,l=0;l<o.endCount.length;l++)if(e<=o.endCount[l]){a=l;break}return a==-1||o.startCount[a]>e?0:65535&(o.idRangeOffset[a]!=0?o.glyphIdArray[e-o.startCount[a]+(o.idRangeOffset[a]>>1)-(o.idRangeOffset.length-a)]:e+o.idDelta[a])}if(o.format==12){if(e>o.groups[o.groups.length-1][1])return 0;for(l=0;l<o.groups.length;l++){var c=o.groups[l];if(c[0]<=e&&e<=c[1])return c[2]+(e-c[0])}return 0}throw"unknown cmap table format "+o.format},n.U.glyphToPath=function(t,e){var r={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[e]){var i=t.SVG.entries[e];return i==null?r:(typeof i=="string"&&(i=n.SVG.toPath(i),t.SVG.entries[e]=i),i)}if(t.CFF){var o={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},a=t.CFF,l=t.CFF.Private;if(a.ROS){for(var c=0;a.FDSelect[c+2]<=e;)c+=2;l=a.FDArray[a.FDSelect[c+1]].Private}n.U._drawCFF(t.CFF.CharStrings[e],o,a,l,r)}else t.glyf&&n.U._drawGlyf(e,t,r);return r},n.U._drawGlyf=function(t,e,r){var i=e.glyf[t];i==null&&(i=e.glyf[t]=n.glyf._parseGlyf(e,t)),i!=null&&(i.noc>-1?n.U._simpleGlyph(i,r):n.U._compoGlyph(i,e,r))},n.U._simpleGlyph=function(t,e){for(var r=0;r<t.noc;r++){for(var i=r==0?0:t.endPts[r-1]+1,o=t.endPts[r],a=i;a<=o;a++){var l=a==i?o:a-1,c=a==o?i:a+1,d=1&t.flags[a],h=1&t.flags[l],v=1&t.flags[c],p=t.xs[a],_=t.ys[a];if(a==i)if(d){if(!h){n.U.P.moveTo(e,p,_);continue}n.U.P.moveTo(e,t.xs[l],t.ys[l])}else h?n.U.P.moveTo(e,t.xs[l],t.ys[l]):n.U.P.moveTo(e,(t.xs[l]+p)/2,(t.ys[l]+_)/2);d?h&&n.U.P.lineTo(e,p,_):v?n.U.P.qcurveTo(e,p,_,t.xs[c],t.ys[c]):n.U.P.qcurveTo(e,p,_,(p+t.xs[c])/2,(_+t.ys[c])/2)}n.U.P.closePath(e)}},n.U._compoGlyph=function(t,e,r){for(var i=0;i<t.parts.length;i++){var o={cmds:[],crds:[]},a=t.parts[i];n.U._drawGlyf(a.glyphIndex,e,o);for(var l=a.m,c=0;c<o.crds.length;c+=2){var d=o.crds[c],h=o.crds[c+1];r.crds.push(d*l.a+h*l.b+l.tx),r.crds.push(d*l.c+h*l.d+l.ty)}for(c=0;c<o.cmds.length;c++)r.cmds.push(o.cmds[c])}},n.U._getGlyphClass=function(t,e){var r=n._lctf.getInterval(e,t);return r==-1?0:e[r+2]},n.U._applySubs=function(t,e,r,i){for(var o=t.length-e-1,a=0;a<r.tabs.length;a++)if(r.tabs[a]!=null){var l,c=r.tabs[a];if(!c.coverage||(l=n._lctf.coverageIndex(c.coverage,t[e]))!=-1){if(r.ltype==1)t[e],c.fmt==1?t[e]=t[e]+c.delta:t[e]=c.newg[l];else if(r.ltype==4)for(var d=c.vals[l],h=0;h<d.length;h++){var v=d[h],p=v.chain.length;if(!(p>o)){for(var _=!0,B=0,D=0;D<p;D++){for(;t[e+B+(1+D)]==-1;)B++;v.chain[D]!=t[e+B+(1+D)]&&(_=!1)}if(_){for(t[e]=v.nglyph,D=0;D<p+B;D++)t[e+D+1]=-1;break}}}else if(r.ltype==5&&c.fmt==2)for(var b=n._lctf.getInterval(c.cDef,t[e]),x=c.cDef[b+2],S=c.scset[x],O=0;O<S.length;O++){var U=S[O],F=U.input;if(!(F.length>o)){for(_=!0,D=0;D<F.length;D++){var j=n._lctf.getInterval(c.cDef,t[e+1+D]);if(b==-1&&c.cDef[j+2]!=F[D]){_=!1;break}}if(_){var P=U.substLookupRecords;for(h=0;h<P.length;h+=2)P[h],P[h+1]}}}else if(r.ltype==6&&c.fmt==3){if(!n.U._glsCovered(t,c.backCvg,e-c.backCvg.length)||!n.U._glsCovered(t,c.inptCvg,e)||!n.U._glsCovered(t,c.ahedCvg,e+c.inptCvg.length))continue;var ee=c.lookupRec;for(O=0;O<ee.length;O+=2){b=ee[O];var g=i[ee[O+1]];n.U._applySubs(t,e+b,g,i)}}}}},n.U._glsCovered=function(t,e,r){for(var i=0;i<e.length;i++)if(n._lctf.coverageIndex(e[i],t[r+i])==-1)return!1;return!0},n.U.glyphsToPath=function(t,e,r){for(var i={cmds:[],crds:[]},o=0,a=0;a<e.length;a++){var l=e[a];if(l!=-1){for(var c=a<e.length-1&&e[a+1]!=-1?e[a+1]:0,d=n.U.glyphToPath(t,l),h=0;h<d.crds.length;h+=2)i.crds.push(d.crds[h]+o),i.crds.push(d.crds[h+1]);for(r&&i.cmds.push(r),h=0;h<d.cmds.length;h++)i.cmds.push(d.cmds[h]);r&&i.cmds.push("X"),o+=t.hmtx.aWidth[l],a<e.length-1&&(o+=n.U.getPairAdjustment(t,l,c))}}return i},n.U.P={},n.U.P.moveTo=function(t,e,r){t.cmds.push("M"),t.crds.push(e,r)},n.U.P.lineTo=function(t,e,r){t.cmds.push("L"),t.crds.push(e,r)},n.U.P.curveTo=function(t,e,r,i,o,a,l){t.cmds.push("C"),t.crds.push(e,r,i,o,a,l)},n.U.P.qcurveTo=function(t,e,r,i,o){t.cmds.push("Q"),t.crds.push(e,r,i,o)},n.U.P.closePath=function(t){t.cmds.push("Z")},n.U._drawCFF=function(t,e,r,i,o){for(var a=e.stack,l=e.nStems,c=e.haveWidth,d=e.width,h=e.open,v=0,p=e.x,_=e.y,B=0,D=0,b=0,x=0,S=0,O=0,U=0,F=0,j=0,P=0,ee={val:0,size:0};v<t.length;){n.CFF.getCharString(t,v,ee);var g=ee.val;if(v+=ee.size,g=="o1"||g=="o18")a.length%2!=0&&!c&&(d=a.shift()+i.nominalWidthX),l+=a.length>>1,a.length=0,c=!0;else if(g=="o3"||g=="o23")a.length%2!=0&&!c&&(d=a.shift()+i.nominalWidthX),l+=a.length>>1,a.length=0,c=!0;else if(g=="o4")a.length>1&&!c&&(d=a.shift()+i.nominalWidthX,c=!0),h&&n.U.P.closePath(o),_+=a.pop(),n.U.P.moveTo(o,p,_),h=!0;else if(g=="o5")for(;a.length>0;)p+=a.shift(),_+=a.shift(),n.U.P.lineTo(o,p,_);else if(g=="o6"||g=="o7")for(var G=a.length,C=g=="o6",H=0;H<G;H++){var X=a.shift();C?p+=X:_+=X,C=!C,n.U.P.lineTo(o,p,_)}else if(g=="o8"||g=="o24"){G=a.length;for(var ne=0;ne+6<=G;)B=p+a.shift(),D=_+a.shift(),b=B+a.shift(),x=D+a.shift(),p=b+a.shift(),_=x+a.shift(),n.U.P.curveTo(o,B,D,b,x,p,_),ne+=6;g=="o24"&&(p+=a.shift(),_+=a.shift(),n.U.P.lineTo(o,p,_))}else{if(g=="o11")break;if(g=="o1234"||g=="o1235"||g=="o1236"||g=="o1237")g=="o1234"&&(D=_,b=(B=p+a.shift())+a.shift(),P=x=D+a.shift(),O=x,F=_,p=(U=(S=(j=b+a.shift())+a.shift())+a.shift())+a.shift(),n.U.P.curveTo(o,B,D,b,x,j,P),n.U.P.curveTo(o,S,O,U,F,p,_)),g=="o1235"&&(B=p+a.shift(),D=_+a.shift(),b=B+a.shift(),x=D+a.shift(),j=b+a.shift(),P=x+a.shift(),S=j+a.shift(),O=P+a.shift(),U=S+a.shift(),F=O+a.shift(),p=U+a.shift(),_=F+a.shift(),a.shift(),n.U.P.curveTo(o,B,D,b,x,j,P),n.U.P.curveTo(o,S,O,U,F,p,_)),g=="o1236"&&(B=p+a.shift(),D=_+a.shift(),b=B+a.shift(),P=x=D+a.shift(),O=x,U=(S=(j=b+a.shift())+a.shift())+a.shift(),F=O+a.shift(),p=U+a.shift(),n.U.P.curveTo(o,B,D,b,x,j,P),n.U.P.curveTo(o,S,O,U,F,p,_)),g=="o1237"&&(B=p+a.shift(),D=_+a.shift(),b=B+a.shift(),x=D+a.shift(),j=b+a.shift(),P=x+a.shift(),S=j+a.shift(),O=P+a.shift(),U=S+a.shift(),F=O+a.shift(),Math.abs(U-p)>Math.abs(F-_)?p=U+a.shift():_=F+a.shift(),n.U.P.curveTo(o,B,D,b,x,j,P),n.U.P.curveTo(o,S,O,U,F,p,_));else if(g=="o14"){if(a.length>0&&!c&&(d=a.shift()+r.nominalWidthX,c=!0),a.length==4){var ae=a.shift(),y=a.shift(),R=a.shift(),m=a.shift(),T=n.CFF.glyphBySE(r,R),A=n.CFF.glyphBySE(r,m);n.U._drawCFF(r.CharStrings[T],e,r,i,o),e.x=ae,e.y=y,n.U._drawCFF(r.CharStrings[A],e,r,i,o)}h&&(n.U.P.closePath(o),h=!1)}else if(g=="o19"||g=="o20")a.length%2!=0&&!c&&(d=a.shift()+i.nominalWidthX),l+=a.length>>1,a.length=0,c=!0,v+=l+7>>3;else if(g=="o21")a.length>2&&!c&&(d=a.shift()+i.nominalWidthX,c=!0),_+=a.pop(),p+=a.pop(),h&&n.U.P.closePath(o),n.U.P.moveTo(o,p,_),h=!0;else if(g=="o22")a.length>1&&!c&&(d=a.shift()+i.nominalWidthX,c=!0),p+=a.pop(),h&&n.U.P.closePath(o),n.U.P.moveTo(o,p,_),h=!0;else if(g=="o25"){for(;a.length>6;)p+=a.shift(),_+=a.shift(),n.U.P.lineTo(o,p,_);B=p+a.shift(),D=_+a.shift(),b=B+a.shift(),x=D+a.shift(),p=b+a.shift(),_=x+a.shift(),n.U.P.curveTo(o,B,D,b,x,p,_)}else if(g=="o26")for(a.length%2&&(p+=a.shift());a.length>0;)B=p,D=_+a.shift(),p=b=B+a.shift(),_=(x=D+a.shift())+a.shift(),n.U.P.curveTo(o,B,D,b,x,p,_);else if(g=="o27")for(a.length%2&&(_+=a.shift());a.length>0;)D=_,b=(B=p+a.shift())+a.shift(),x=D+a.shift(),p=b+a.shift(),_=x,n.U.P.curveTo(o,B,D,b,x,p,_);else if(g=="o10"||g=="o29"){var E=g=="o10"?i:r;if(a.length==0)console.debug("error: empty stack");else{var w=a.pop(),V=E.Subrs[w+E.Bias];e.x=p,e.y=_,e.nStems=l,e.haveWidth=c,e.width=d,e.open=h,n.U._drawCFF(V,e,r,i,o),p=e.x,_=e.y,l=e.nStems,c=e.haveWidth,d=e.width,h=e.open}}else if(g=="o30"||g=="o31"){var L=a.length,z=(ne=0,g=="o31");for(ne+=L-(G=-3&L);ne<G;)z?(D=_,b=(B=p+a.shift())+a.shift(),_=(x=D+a.shift())+a.shift(),G-ne==5?(p=b+a.shift(),ne++):p=b,z=!1):(B=p,D=_+a.shift(),b=B+a.shift(),x=D+a.shift(),p=b+a.shift(),G-ne==5?(_=x+a.shift(),ne++):_=x,z=!0),n.U.P.curveTo(o,B,D,b,x,p,_),ne+=4}else{if((g+"").charAt(0)=="o")throw console.debug("Unknown operation: "+g,t),g;a.push(g)}}}e.x=p,e.y=_,e.nStems=l,e.haveWidth=c,e.width=d,e.open=h};var u=n,f={Typr:u};return s.Typr=u,s.default=f,Object.defineProperty(s,"__esModule",{value:!0}),s}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Ds(){return function(s){var n=Uint8Array,u=Uint16Array,f=Uint32Array,t=new n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),r=new n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),i=function(g,G){for(var C=new u(31),H=0;H<31;++H)C[H]=G+=1<<g[H-1];var X=new f(C[30]);for(H=1;H<30;++H)for(var ne=C[H];ne<C[H+1];++ne)X[ne]=ne-C[H]<<5|H;return[C,X]},o=i(t,2),a=o[0],l=o[1];a[28]=258,l[258]=28;for(var c=i(e,0)[0],d=new u(32768),h=0;h<32768;++h){var v=(43690&h)>>>1|(21845&h)<<1;v=(61680&(v=(52428&v)>>>2|(13107&v)<<2))>>>4|(3855&v)<<4,d[h]=((65280&v)>>>8|(255&v)<<8)>>>1}var p=function(g,G,C){for(var H=g.length,X=0,ne=new u(G);X<H;++X)++ne[g[X]-1];var ae,y=new u(G);for(X=0;X<G;++X)y[X]=y[X-1]+ne[X-1]<<1;{ae=new u(1<<G);var R=15-G;for(X=0;X<H;++X)if(g[X])for(var m=X<<4|g[X],T=G-g[X],A=y[g[X]-1]++<<T,E=A|(1<<T)-1;A<=E;++A)ae[d[A]>>>R]=m}return ae},_=new n(288);for(h=0;h<144;++h)_[h]=8;for(h=144;h<256;++h)_[h]=9;for(h=256;h<280;++h)_[h]=7;for(h=280;h<288;++h)_[h]=8;var B=new n(32);for(h=0;h<32;++h)B[h]=5;var D=p(_,9),b=p(B,5),x=function(g){for(var G=g[0],C=1;C<g.length;++C)g[C]>G&&(G=g[C]);return G},S=function(g,G,C){var H=G/8|0;return(g[H]|g[H+1]<<8)>>(7&G)&C},O=function(g,G){var C=G/8|0;return(g[C]|g[C+1]<<8|g[C+2]<<16)>>(7&G)},U=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(g,G,C){var H=new Error(G||U[g]);if(H.code=g,Error.captureStackTrace&&Error.captureStackTrace(H,F),!C)throw H;return H},j=function(g,G,C){var H=g.length;if(!H||C&&!C.l&&H<5)return G||new n(0);var X=!G||C,ne=!C||C.i;C||(C={}),G||(G=new n(3*H));var ae,y=function(ce){var ve=G.length;if(ce>ve){var _e=new n(Math.max(2*ve,ce));_e.set(G),G=_e}},R=C.f||0,m=C.p||0,T=C.b||0,A=C.l,E=C.d,w=C.m,V=C.n,L=8*H;do{if(!A){C.f=R=S(g,m,1);var z=S(g,m+1,3);if(m+=3,!z){var k=g[($=((ae=m)/8|0)+(7&ae&&1)+4)-4]|g[$-3]<<8,I=$+k;if(I>H){ne&&F(0);break}X&&y(T+k),G.set(g.subarray($,I),T),C.b=T+=k,C.p=m=8*I;continue}if(z==1)A=D,E=b,w=9,V=5;else if(z==2){var N=S(g,m,31)+257,M=S(g,m+10,15)+4,K=N+S(g,m+5,31)+1;m+=14;for(var q=new n(K),Y=new n(19),Z=0;Z<M;++Z)Y[r[Z]]=S(g,m+3*Z,7);m+=3*M;var re=x(Y),J=(1<<re)-1,oe=p(Y,re);for(Z=0;Z<K;){var $,W=oe[S(g,m,J)];if(m+=15&W,($=W>>>4)<16)q[Z++]=$;else{var ue=0,te=0;for($==16?(te=3+S(g,m,3),m+=2,ue=q[Z-1]):$==17?(te=3+S(g,m,7),m+=3):$==18&&(te=11+S(g,m,127),m+=7);te--;)q[Z++]=ue}}var ie=q.subarray(0,N),Q=q.subarray(N);w=x(ie),V=x(Q),A=p(ie,w),E=p(Q,V)}else F(1);if(m>L){ne&&F(0);break}}X&&y(T+131072);for(var Te=(1<<w)-1,se=(1<<V)-1,le=m;;le=m){var de=(ue=A[O(g,m)&Te])>>>4;if((m+=15&ue)>L){ne&&F(0);break}if(ue||F(2),de<256)G[T++]=de;else{if(de==256){le=m,A=null;break}var ge=de-254;if(de>264){var Ce=t[Z=de-257];ge=S(g,m,(1<<Ce)-1)+a[Z],m+=Ce}var Ae=E[O(g,m)&se],pe=Ae>>>4;if(Ae||F(3),m+=15&Ae,Q=c[pe],pe>3&&(Ce=e[pe],Q+=O(g,m)&(1<<Ce)-1,m+=Ce),m>L){ne&&F(0);break}X&&y(T+131072);for(var me=T+ge;T<me;T+=4)G[T]=G[T-Q],G[T+1]=G[T+1-Q],G[T+2]=G[T+2-Q],G[T+3]=G[T+3-Q];T=me}}C.l=A,C.p=le,C.b=T,A&&(R=1,C.m=w,C.d=E,C.n=V)}while(!R);return T==G.length?G:function(ce,ve,_e){(_e==null||_e>ce.length)&&(_e=ce.length);var Ie=new(ce instanceof u?u:ce instanceof f?f:n)(_e-ve);return Ie.set(ce.subarray(ve,_e)),Ie}(G,0,T)},P=new n(0),ee=typeof TextDecoder<"u"&&new TextDecoder;try{ee.decode(P,{stream:!0})}catch{}return s.convert_streams=function(g){var G=new DataView(g),C=0;function H(){var N=G.getUint16(C);return C+=2,N}function X(){var N=G.getUint32(C);return C+=4,N}function ne(N){k.setUint16(I,N),I+=2}function ae(N){k.setUint32(I,N),I+=4}for(var y={signature:X(),flavor:X(),length:X(),numTables:H(),reserved:H(),totalSfntSize:X(),majorVersion:H(),minorVersion:H(),metaOffset:X(),metaLength:X(),metaOrigLength:X(),privOffset:X(),privLength:X()},R=0;Math.pow(2,R)<=y.numTables;)R++;R--;for(var m=16*Math.pow(2,R),T=16*y.numTables-m,A=12,E=[],w=0;w<y.numTables;w++)E.push({tag:X(),offset:X(),compLength:X(),origLength:X(),origChecksum:X()}),A+=16;var V,L=new Uint8Array(12+16*E.length+E.reduce(function(N,M){return N+M.origLength+4},0)),z=L.buffer,k=new DataView(z),I=0;return ae(y.flavor),ne(y.numTables),ne(m),ne(R),ne(T),E.forEach(function(N){ae(N.tag),ae(N.origChecksum),ae(A),ae(N.origLength),N.outOffset=A,(A+=N.origLength)%4!=0&&(A+=4-A%4)}),E.forEach(function(N){var M,K=g.slice(N.offset,N.offset+N.compLength);if(N.compLength!=N.origLength){var q=new Uint8Array(N.origLength);M=new Uint8Array(K,2),j(M,q)}else q=new Uint8Array(K);L.set(q,N.outOffset);var Y=0;(A=N.outOffset+N.origLength)%4!=0&&(Y=4-A%4),L.set(new Uint8Array(Y).buffer,N.outOffset+N.origLength),V=A+Y}),z.slice(0,V)},Object.defineProperty(s,"__esModule",{value:!0}),s}({}).convert_streams}function As(s,n){const u={M:2,L:2,Q:4,C:6,Z:0},f={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},t=1,e=2,r=4,i=8,o=16,a=32;let l;function c(U){if(!l){const F={R:e,L:t,D:r,C:o,U:a,T:i};l=new Map;for(let j in f){let P=0;f[j].split(",").forEach(ee=>{let[g,G]=ee.split("+");g=parseInt(g,36),G=G?parseInt(G,36):0,l.set(P+=g,F[j]);for(let C=G;C--;)l.set(++P,F[j])})}}return l.get(U)||a}const d=1,h=2,v=3,p=4,_=[null,"isol","init","fina","medi"];function B(U){const F=new Uint8Array(U.length);let j=a,P=d,ee=-1;for(let g=0;g<U.length;g++){const G=U.codePointAt(g);let C=c(G)|0,H=d;C&i||(j&(t|r|o)?C&(e|r|o)?(H=v,(P===d||P===v)&&F[ee]++):C&(t|a)&&(P===h||P===p)&&F[ee]--:j&(e|a)&&(P===h||P===p)&&F[ee]--,P=F[g]=H,j=C,ee=g,G>65535&&g++)}return F}function D(U,F){const j=[];for(let ee=0;ee<F.length;ee++){const g=F.codePointAt(ee);g>65535&&ee++,j.push(s.U.codeToGlyph(U,g))}const P=U.GSUB;if(P){const{lookupList:ee,featureList:g}=P;let G;const C=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,H=[];g.forEach(X=>{if(C.test(X.tag))for(let ne=0;ne<X.tab.length;ne++){if(H[X.tab[ne]])continue;H[X.tab[ne]]=!0;const ae=ee[X.tab[ne]],y=/^(isol|init|fina|medi)$/.test(X.tag);y&&!G&&(G=B(F));for(let R=0;R<j.length;R++)(!G||!y||_[G[R]]===X.tag)&&s.U._applySubs(j,R,ae,ee)}})}return j}function b(U,F){const j=new Int16Array(F.length*3);let P=0;for(;P<F.length;P++){const C=F[P];if(C===-1)continue;j[P*3+2]=U.hmtx.aWidth[C];const H=U.GPOS;if(H){const X=H.lookupList;for(let ne=0;ne<X.length;ne++){const ae=X[ne];for(let y=0;y<ae.tabs.length;y++){const R=ae.tabs[y];if(ae.ltype===1){if(s._lctf.coverageIndex(R.coverage,C)!==-1&&R.pos){G(R.pos,P);break}}else if(ae.ltype===2){let m=null,T=ee();if(T!==-1){const A=s._lctf.coverageIndex(R.coverage,F[T]);if(A!==-1){if(R.fmt===1){const E=R.pairsets[A];for(let w=0;w<E.length;w++)E[w].gid2===C&&(m=E[w])}else if(R.fmt===2){const E=s.U._getGlyphClass(F[T],R.classDef1),w=s.U._getGlyphClass(C,R.classDef2);m=R.matrix[E][w]}if(m){m.val1&&G(m.val1,T),m.val2&&G(m.val2,P);break}}}}else if(ae.ltype===4){const m=s._lctf.coverageIndex(R.markCoverage,C);if(m!==-1){const T=ee(g),A=T===-1?-1:s._lctf.coverageIndex(R.baseCoverage,F[T]);if(A!==-1){const E=R.markArray[m],w=R.baseArray[A][E.markClass];j[P*3]=w.x-E.x+j[T*3]-j[T*3+2],j[P*3+1]=w.y-E.y+j[T*3+1];break}}}else if(ae.ltype===6){const m=s._lctf.coverageIndex(R.mark1Coverage,C);if(m!==-1){const T=ee();if(T!==-1){const A=F[T];if(x(U,A)===3){const E=s._lctf.coverageIndex(R.mark2Coverage,A);if(E!==-1){const w=R.mark1Array[m],V=R.mark2Array[E][w.markClass];j[P*3]=V.x-w.x+j[T*3]-j[T*3+2],j[P*3+1]=V.y-w.y+j[T*3+1];break}}}}}}}}else if(U.kern&&!U.cff){const X=ee();if(X!==-1){const ne=U.kern.glyph1.indexOf(F[X]);if(ne!==-1){const ae=U.kern.rval[ne].glyph2.indexOf(C);ae!==-1&&(j[X*3+2]+=U.kern.rval[ne].vals[ae])}}}}return j;function ee(C){for(let H=P-1;H>=0;H--)if(F[H]!==-1&&(!C||C(F[H])))return H;return-1}function g(C){return x(U,C)===1}function G(C,H){for(let X=0;X<3;X++)j[H*3+X]+=C[X]||0}}function x(U,F){const j=U.GDEF&&U.GDEF.glyphClassDef;return j?s.U._getGlyphClass(F,j):0}function S(...U){for(let F=0;F<U.length;F++)if(typeof U[F]=="number")return U[F]}function O(U){const F=Object.create(null),j=U["OS/2"],P=U.hhea,ee=U.head.unitsPerEm,g=S(j&&j.sTypoAscender,P&&P.ascender,ee),G={unitsPerEm:ee,ascender:g,descender:S(j&&j.sTypoDescender,P&&P.descender,0),capHeight:S(j&&j.sCapHeight,g),xHeight:S(j&&j.sxHeight,g),lineGap:S(j&&j.sTypoLineGap,P&&P.lineGap),supportsCodePoint(C){return s.U.codeToGlyph(U,C)>0},forEachGlyph(C,H,X,ne){let ae=0;const y=1/G.unitsPerEm*H,R=D(U,C);let m=0;const T=b(U,R);return R.forEach((A,E)=>{if(A!==-1){let w=F[A];if(!w){const{cmds:V,crds:L}=s.U.glyphToPath(U,A);let z="",k=0;for(let q=0,Y=V.length;q<Y;q++){const Z=u[V[q]];z+=V[q];for(let re=1;re<=Z;re++)z+=(re>1?",":"")+L[k++]}let I,N,M,K;if(L.length){I=N=1/0,M=K=-1/0;for(let q=0,Y=L.length;q<Y;q+=2){let Z=L[q],re=L[q+1];Z<I&&(I=Z),re<N&&(N=re),Z>M&&(M=Z),re>K&&(K=re)}}else I=M=N=K=0;w=F[A]={index:A,advanceWidth:U.hmtx.aWidth[A],xMin:I,yMin:N,xMax:M,yMax:K,path:z}}ne.call(null,w,ae+T[E*3]*y,T[E*3+1]*y,m),ae+=T[E*3+2]*y,X&&(ae+=X*H)}m+=C.codePointAt(m)>65535?2:1}),ae}};return G}return function(F){const j=new Uint8Array(F,0,4),P=s._bin.readASCII(j,0,4);if(P==="wOFF")F=n(F);else if(P==="wOF2")throw new Error("woff2 fonts not supported");return O(s.parse(F)[0])}}const Fs=jt({name:"Typr Font Parser",dependencies:[ks,Ds,As],init(s,n,u){const f=s(),t=n();return u(f,t)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Ms(){return function(s){var n=function(){this.buckets=new Map};n.prototype.add=function(b){var x=b>>5;this.buckets.set(x,(this.buckets.get(x)||0)|1<<(31&b))},n.prototype.has=function(b){var x=this.buckets.get(b>>5);return x!==void 0&&(x&1<<(31&b))!=0},n.prototype.serialize=function(){var b=[];return this.buckets.forEach(function(x,S){b.push((+S).toString(36)+":"+x.toString(36))}),b.join(",")},n.prototype.deserialize=function(b){var x=this;this.buckets.clear(),b.split(",").forEach(function(S){var O=S.split(":");x.buckets.set(parseInt(O[0],36),parseInt(O[1],36))})};var u=Math.pow(2,8),f=u-1,t=~f;function e(b){var x=function(O){return O&t}(b).toString(16),S=function(O){return(O&t)+u-1}(b).toString(16);return"codepoint-index/plane"+(b>>16)+"/"+x+"-"+S+".json"}function r(b,x){var S=b&f,O=x.codePointAt(S/6|0);return((O=(O||48)-48)&1<<S%6)!=0}function i(b,x){var S;(S=b,S.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(O){return O.split("-").map(function(U){return parseInt(U.trim(),16)})})).forEach(function(O){var U=O[0],F=O[1];F===void 0&&(F=U),x(U,F)})}function o(b,x){i(b,function(S,O){for(var U=S;U<=O;U++)x(U)})}var a={},l={},c=new WeakMap,d="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function h(b){var x=c.get(b);return x||(x=new n,o(b.ranges,function(S){return x.add(S)}),c.set(b,x)),x}var v,p=new Map;function _(b,x,S){return b[x]?x:b[S]?S:function(O){for(var U in O)return U}(b)}function B(b,x){var S=x;if(!b.includes(S)){S=1/0;for(var O=0;O<b.length;O++)Math.abs(b[O]-x)<Math.abs(S-x)&&(S=b[O])}return S}function D(b){return v||(v=new Set,o("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(x){v.add(x)})),v.has(b)}return s.CodePointSet=n,s.clearCache=function(){a={},l={}},s.getFontsForString=function(b,x){x===void 0&&(x={});var S,O=x.lang;O===void 0&&(O=new RegExp("\\p{Script=Hangul}","u").test(S=b)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(S)?"ja":"en");var U=x.category;U===void 0&&(U="sans-serif");var F=x.style;F===void 0&&(F="normal");var j=x.weight;j===void 0&&(j=400);var P=(x.dataUrl||d).replace(/\/$/g,""),ee=new Map,g=new Uint8Array(b.length),G={},C={},H=new Array(b.length),X=new Map,ne=!1;function ae(m){var T=p.get(m);return T||(T=fetch(P+"/"+m).then(function(A){if(!A.ok)throw new Error(A.statusText);return A.json().then(function(E){if(!Array.isArray(E)||E[0]!==1)throw new Error("Incorrect schema version; need 1, got "+E[0]);return E[1]})}).catch(function(A){if(P!==d)return ne||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+P+'", trying default CDN. '+A.message),ne=!0),P=d,p.delete(m),ae(m);throw A}),p.set(m,T)),T}for(var y=function(m){var T=b.codePointAt(m),A=e(T);H[m]=A,a[A]||X.has(A)||X.set(A,ae(A).then(function(E){a[A]=E})),T>65535&&(m++,R=m)},R=0;R<b.length;R++)y(R);return Promise.all(X.values()).then(function(){X.clear();for(var m=function(A){var E=b.codePointAt(A),w=null,V=a[H[A]],L=void 0;for(var z in V){var k=C[z];if(k===void 0&&(k=C[z]=new RegExp(z).test(O||"en")),k){for(var I in L=z,V[z])if(r(E,V[z][I])){w=I;break}break}}if(!w){e:for(var N in V)if(N!==L){for(var M in V[N])if(r(E,V[N][M])){w=M;break e}}}w||(console.debug("No font coverage for U+"+E.toString(16)),w="latin"),H[A]=w,l[w]||X.has(w)||X.set(w,ae("font-meta/"+w+".json").then(function(K){l[w]=K})),E>65535&&(A++,T=A)},T=0;T<b.length;T++)m(T);return Promise.all(X.values())}).then(function(){for(var m,T=null,A=0;A<b.length;A++){var E=b.codePointAt(A);if(T&&(D(E)||h(T).has(E)))g[A]=g[A-1];else{T=l[H[A]];var w=G[T.id];if(!w){var V=T.typeforms,L=_(V,U,"sans-serif"),z=_(V[L],F,"normal"),k=B((m=V[L])===null||m===void 0?void 0:m[z],j);w=G[T.id]=P+"/font-files/"+T.id+"/"+L+"."+z+"."+k+".woff"}var I=ee.get(w);I==null&&(I=ee.size,ee.set(w,I)),g[A]=I}E>65535&&(A++,g[A]=g[A-1])}return{fontUrls:Array.from(ee.keys()),chars:g}})},Object.defineProperty(s,"__esModule",{value:!0}),s}({})}function Es(s,n){const u=Object.create(null),f=Object.create(null);function t(r,i){const o=a=>{console.error(`Failure loading font ${r}`,a)};try{const a=new XMLHttpRequest;a.open("get",r,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status>=400)o(new Error(a.statusText));else if(a.status>0)try{const l=s(a.response);l.src=r,i(l)}catch(l){o(l)}},a.onerror=o,a.send()}catch(a){o(a)}}function e(r,i){let o=u[r];o?i(o):f[r]?f[r].push(i):(f[r]=[i],t(r,a=>{a.src=r,u[r]=a,f[r].forEach(l=>l(a)),delete f[r]}))}return function(r,i,{lang:o,fonts:a=[],style:l="normal",weight:c="normal",unicodeFontsURL:d}={}){const h=new Uint8Array(r.length),v=[];r.length||D();const p=new Map,_=[];if(l!=="italic"&&(l="normal"),typeof c!="number"&&(c=c==="bold"?700:400),a&&!Array.isArray(a)&&(a=[a]),a=a.slice().filter(x=>!x.lang||x.lang.test(o)).reverse(),a.length){let U=0;(function F(j=0){for(let P=j,ee=r.length;P<ee;P++){const g=r.codePointAt(P);if(U===1&&v[h[P-1]].supportsCodePoint(g)||P>0&&/\s/.test(r[P]))h[P]=h[P-1],U===2&&(_[_.length-1][1]=P);else for(let G=h[P],C=a.length;G<=C;G++)if(G===C){const H=U===2?_[_.length-1]:_[_.length]=[P,P];H[1]=P,U=2}else{h[P]=G;const{src:H,unicodeRange:X}=a[G];if(!X||b(g,X)){const ne=u[H];if(!ne){e(H,()=>{F(P)});return}if(ne.supportsCodePoint(g)){let ae=p.get(ne);typeof ae!="number"&&(ae=v.length,v.push(ne),p.set(ne,ae)),h[P]=ae,U=1;break}}}g>65535&&P+1<ee&&(h[P+1]=h[P],P++,U===2&&(_[_.length-1][1]=P))}B()})()}else _.push([0,r.length-1]),B();function B(){if(_.length){const x=_.map(S=>r.substring(S[0],S[1]+1)).join(`
`);n.getFontsForString(x,{lang:o||void 0,style:l,weight:c,dataUrl:d}).then(({fontUrls:S,chars:O})=>{const U=v.length;let F=0;_.forEach(P=>{for(let ee=0,g=P[1]-P[0];ee<=g;ee++)h[P[0]+ee]=O[F++]+U;F++});let j=0;S.forEach((P,ee)=>{e(P,g=>{v[ee+U]=g,++j===S.length&&D()})})})}else D()}function D(){i({chars:h,fonts:v})}function b(x,S){for(let O=0;O<S.length;O++){const[U,F=U]=S[O];if(U<=x&&x<=F)return!0}return!1}}}const Rs=jt({name:"FontResolver",dependencies:[Es,Fs,Ms],init(s,n,u){return s(n,u())}});function Ls(s,n){const f=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,t="[^\\S\\u00A0]",e=new RegExp(`${t}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function r({text:v,lang:p,fonts:_,style:B,weight:D,preResolvedFonts:b,unicodeFontsURL:x},S){const O=({chars:U,fonts:F})=>{let j,P;const ee=[];for(let g=0;g<U.length;g++)U[g]!==P?(P=U[g],ee.push(j={start:g,end:g,fontObj:F[U[g]]})):j.end=g;S(ee)};b?O(b):s(v,O,{lang:p,fonts:_,style:B,weight:D,unicodeFontsURL:x})}function i({text:v="",font:p,lang:_,sdfGlyphSize:B=64,fontSize:D=400,fontWeight:b=1,fontStyle:x="normal",letterSpacing:S=0,lineHeight:O="normal",maxWidth:U=1/0,direction:F,textAlign:j="left",textIndent:P=0,whiteSpace:ee="normal",overflowWrap:g="normal",anchorX:G=0,anchorY:C=0,metricsOnly:H=!1,unicodeFontsURL:X,preResolvedFonts:ne=null,includeCaretPositions:ae=!1,chunkedBoundsSize:y=8192,colorRanges:R=null},m){const T=c(),A={fontLoad:0,typesetting:0};v.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),v=v.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),D=+D,S=+S,U=+U,O=O||"normal",P=+P,r({text:v,lang:_,style:x,weight:b,fonts:typeof p=="string"?[{src:p}]:p,unicodeFontsURL:X,preResolvedFonts:ne},E=>{A.fontLoad=c()-T;const w=isFinite(U);let V=null,L=null,z=null,k=null,I=null,N=null,M=null,K=null,q=0,Y=0,Z=ee!=="nowrap";const re=new Map,J=c();let oe=P,$=0,W=new d;const ue=[W];E.forEach(se=>{const{fontObj:le}=se,{ascender:de,descender:ge,unitsPerEm:Ce,lineGap:Ae,capHeight:pe,xHeight:me}=le;let ce=re.get(le);if(!ce){const fe=D/Ce,Ue=O==="normal"?(de-ge+Ae)*fe:O*D,et=(Ue-(de-ge)*fe)/2,Se=Math.min(Ue,(de-ge)*fe),xe=(de+ge)/2*fe+Se/2;ce={index:re.size,src:le.src,fontObj:le,fontSizeMult:fe,unitsPerEm:Ce,ascender:de*fe,descender:ge*fe,capHeight:pe*fe,xHeight:me*fe,lineHeight:Ue,baseline:-et-de*fe,caretTop:xe,caretBottom:xe-Se},re.set(le,ce)}const{fontSizeMult:ve}=ce,_e=v.slice(se.start,se.end+1);let Ie,De;le.forEachGlyph(_e,D,S,(fe,Ue,et,Se)=>{Ue+=$,Se+=se.start,Ie=Ue,De=fe;const xe=v.charAt(Se),Pe=fe.advanceWidth*ve,Ee=W.count;let be;if("isEmpty"in fe||(fe.isWhitespace=!!xe&&new RegExp(t).test(xe),fe.canBreakAfter=!!xe&&e.test(xe),fe.isEmpty=fe.xMin===fe.xMax||fe.yMin===fe.yMax||f.test(xe)),!fe.isWhitespace&&!fe.isEmpty&&Y++,Z&&w&&!fe.isWhitespace&&Ue+Pe+oe>U&&Ee){if(W.glyphAt(Ee-1).glyphObj.canBreakAfter)be=new d,oe=-Ue;else for(let He=Ee;He--;)if(He===0&&g==="break-word"){be=new d,oe=-Ue;break}else if(W.glyphAt(He).glyphObj.canBreakAfter){be=W.splitAt(He+1);const Ve=be.glyphAt(0).x;oe-=Ve;for(let Be=be.count;Be--;)be.glyphAt(Be).x-=Ve;break}be&&(W.isSoftWrapped=!0,W=be,ue.push(W),q=U)}let Re=W.glyphAt(W.count);Re.glyphObj=fe,Re.x=Ue+oe,Re.y=et,Re.width=Pe,Re.charIndex=Se,Re.fontData=ce,xe===`
`&&(W=new d,ue.push(W),oe=-(Ue+Pe+S*D)+P)}),$=Ie+De.advanceWidth*ve+S*D});let te=0;ue.forEach(se=>{let le=!0;for(let de=se.count;de--;){const ge=se.glyphAt(de);le&&!ge.glyphObj.isWhitespace&&(se.width=ge.x+ge.width,se.width>q&&(q=se.width),le=!1);let{lineHeight:Ce,capHeight:Ae,xHeight:pe,baseline:me}=ge.fontData;Ce>se.lineHeight&&(se.lineHeight=Ce);const ce=me-se.baseline;ce<0&&(se.baseline+=ce,se.cap+=ce,se.ex+=ce),se.cap=Math.max(se.cap,se.baseline+Ae),se.ex=Math.max(se.ex,se.baseline+pe)}se.baseline-=te,se.cap-=te,se.ex-=te,te+=se.lineHeight});let ie=0,Q=0;if(G&&(typeof G=="number"?ie=-G:typeof G=="string"&&(ie=-q*(G==="left"?0:G==="center"?.5:G==="right"?1:a(G)))),C&&(typeof C=="number"?Q=-C:typeof C=="string"&&(Q=C==="top"?0:C==="top-baseline"?-ue[0].baseline:C==="top-cap"?-ue[0].cap:C==="top-ex"?-ue[0].ex:C==="middle"?te/2:C==="bottom"?te:C==="bottom-baseline"?-ue[ue.length-1].baseline:a(C)*te)),!H){const se=n.getEmbeddingLevels(v,F);V=new Uint16Array(Y),L=new Uint8Array(Y),z=new Float32Array(Y*2),k={},M=[1/0,1/0,-1/0,-1/0],K=[],ae&&(N=new Float32Array(v.length*4)),R&&(I=new Uint8Array(Y*3));let le=0,de=-1,ge=-1,Ce,Ae;if(ue.forEach((pe,me)=>{let{count:ce,width:ve}=pe;if(ce>0){let _e=0;for(let Se=ce;Se--&&pe.glyphAt(Se).glyphObj.isWhitespace;)_e++;let Ie=0,De=0;if(j==="center")Ie=(q-ve)/2;else if(j==="right")Ie=q-ve;else if(j==="justify"&&pe.isSoftWrapped){let Se=0;for(let xe=ce-_e;xe--;)pe.glyphAt(xe).glyphObj.isWhitespace&&Se++;De=(q-ve)/Se}if(De||Ie){let Se=0;for(let xe=0;xe<ce;xe++){let Pe=pe.glyphAt(xe);const Ee=Pe.glyphObj;Pe.x+=Ie+Se,De!==0&&Ee.isWhitespace&&xe<ce-_e&&(Se+=De,Pe.width+=De)}}const fe=n.getReorderSegments(v,se,pe.glyphAt(0).charIndex,pe.glyphAt(pe.count-1).charIndex);for(let Se=0;Se<fe.length;Se++){const[xe,Pe]=fe[Se];let Ee=1/0,be=-1/0;for(let Re=0;Re<ce;Re++)if(pe.glyphAt(Re).charIndex>=xe){let He=Re,Ve=Re;for(;Ve<ce;Ve++){let Be=pe.glyphAt(Ve);if(Be.charIndex>Pe)break;Ve<ce-_e&&(Ee=Math.min(Ee,Be.x),be=Math.max(be,Be.x+Be.width))}for(let Be=He;Be<Ve;Be++){const rt=pe.glyphAt(Be);rt.x=be-(rt.x+rt.width-Ee)}break}}let Ue;const et=Se=>Ue=Se;for(let Se=0;Se<ce;Se++){const xe=pe.glyphAt(Se);Ue=xe.glyphObj;const Pe=Ue.index,Ee=se.levels[xe.charIndex]&1;if(Ee){const be=n.getMirroredCharacter(v[xe.charIndex]);be&&xe.fontData.fontObj.forEachGlyph(be,0,0,et)}if(ae){const{charIndex:be,fontData:Re}=xe,He=xe.x+ie,Ve=xe.x+xe.width+ie;N[be*4]=Ee?Ve:He,N[be*4+1]=Ee?He:Ve,N[be*4+2]=pe.baseline+Re.caretBottom+Q,N[be*4+3]=pe.baseline+Re.caretTop+Q;const Be=be-de;Be>1&&l(N,de,Be),de=be}if(R){const{charIndex:be}=xe;for(;be>ge;)ge++,R.hasOwnProperty(ge)&&(Ae=R[ge])}if(!Ue.isWhitespace&&!Ue.isEmpty){const be=le++,{fontSizeMult:Re,src:He,index:Ve}=xe.fontData,Be=k[He]||(k[He]={});Be[Pe]||(Be[Pe]={path:Ue.path,pathBounds:[Ue.xMin,Ue.yMin,Ue.xMax,Ue.yMax]});const rt=xe.x+ie,ht=xe.y+pe.baseline+Q;z[be*2]=rt,z[be*2+1]=ht;const ct=rt+Ue.xMin*Re,pt=ht+Ue.yMin*Re,bt=rt+Ue.xMax*Re,dt=ht+Ue.yMax*Re;ct<M[0]&&(M[0]=ct),pt<M[1]&&(M[1]=pt),bt>M[2]&&(M[2]=bt),dt>M[3]&&(M[3]=dt),be%y===0&&(Ce={start:be,end:be,rect:[1/0,1/0,-1/0,-1/0]},K.push(Ce)),Ce.end++;const Ye=Ce.rect;if(ct<Ye[0]&&(Ye[0]=ct),pt<Ye[1]&&(Ye[1]=pt),bt>Ye[2]&&(Ye[2]=bt),dt>Ye[3]&&(Ye[3]=dt),V[be]=Pe,L[be]=Ve,R){const Tt=be*3;I[Tt]=Ae>>16&255,I[Tt+1]=Ae>>8&255,I[Tt+2]=Ae&255}}}}}),N){const pe=v.length-de;pe>1&&l(N,de,pe)}}const Te=[];re.forEach(({index:se,src:le,unitsPerEm:de,ascender:ge,descender:Ce,lineHeight:Ae,capHeight:pe,xHeight:me})=>{Te[se]={src:le,unitsPerEm:de,ascender:ge,descender:Ce,lineHeight:Ae,capHeight:pe,xHeight:me}}),A.typesetting=c()-J,m({glyphIds:V,glyphFontIndices:L,glyphPositions:z,glyphData:k,fontData:Te,caretPositions:N,glyphColors:I,chunkedBounds:K,fontSize:D,topBaseline:Q+ue[0].baseline,blockBounds:[ie,Q-te,ie+q,Q],visibleBounds:M,timings:A})})}function o(v,p){i({...v,metricsOnly:!0},_=>{const[B,D,b,x]=_.blockBounds;p({width:b-B,height:x-D})})}function a(v){let p=v.match(/^([\d.]+)%$/),_=p?parseFloat(p[1]):NaN;return isNaN(_)?0:_/100}function l(v,p,_){const B=v[p*4],D=v[p*4+1],b=v[p*4+2],x=v[p*4+3],S=(D-B)/_;for(let O=0;O<_;O++){const U=(p+O)*4;v[U]=B+S*O,v[U+1]=B+S*(O+1),v[U+2]=b,v[U+3]=x}}function c(){return(self.performance||Date).now()}function d(){this.data=[]}const h=["glyphObj","x","y","width","charIndex","fontData"];return d.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/h.length)},glyphAt(v){let p=d.flyweight;return p.data=this.data,p.index=v,p},splitAt(v){let p=new d;return p.data=this.data.splice(v*h.length),p}},d.flyweight=h.reduce((v,p,_,B)=>(Object.defineProperty(v,p,{get(){return this.data[this.index*h.length+_]},set(D){this.data[this.index*h.length+_]=D}}),v),{data:null,index:0}),{typeset:i,measure:o}}const kt=()=>(self.performance||Date).now(),jn=fa();let Eo;function Os(s,n,u,f,t,e,r,i,o,a,l=!0){return l?Ps(s,n,u,f,t,e,r,i,o,a).then(null,c=>(Eo||(console.warn("WebGL SDF generation failed, falling back to JS",c),Eo=!0),Lo(s,n,u,f,t,e,r,i,o,a))):Lo(s,n,u,f,t,e,r,i,o,a)}const In=[],Is=5;let Dr=0;function da(){const s=kt();for(;In.length&&kt()-s<Is;)In.shift()();Dr=In.length?setTimeout(da,0):0}const Ps=(...s)=>new Promise((n,u)=>{In.push(()=>{const f=kt();try{jn.webgl.generateIntoCanvas(...s),n({timing:kt()-f})}catch(t){u(t)}}),Dr||(Dr=setTimeout(da,0))}),Bs=4,Gs=2e3,Ro={};let Ns=0;function Lo(s,n,u,f,t,e,r,i,o,a){const l="TroikaTextSDFGenerator_JS_"+Ns++%Bs;let c=Ro[l];return c||(c=Ro[l]={workerModule:jt({name:l,workerId:l,dependencies:[fa,kt],init(d,h){const v=d().javascript.generate;return function(...p){const _=h();return{textureData:v(...p),timing:h()-_}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),c.requests++,clearTimeout(c.idleTimer),c.workerModule(s,n,u,f,t,e).then(({textureData:d,timing:h})=>{const v=kt(),p=new Uint8Array(d.length*4);for(let _=0;_<d.length;_++)p[_*4+a]=d[_];return jn.webglUtils.renderImageData(r,p,i,o,s,n,1<<3-a),h+=kt()-v,--c.requests===0&&(c.idleTimer=setTimeout(()=>{gs(l)},Gs)),{timing:h}})}function Ws(s){s._warm||(jn.webgl.isSupported(s),s._warm=!0)}const Vs=jn.webglUtils.resizeWebGLCanvasWithoutClearing,It={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048,useWorker:!0},zs=new Wn;function Rt(){return(self.performance||Date).now()}const Oo=Object.create(null);function js(s,n){s=Hs({},s);const u=Rt(),{defaultFontURL:f}=It,t=[];if(f&&t.push({label:"default",src:Io(f)}),s.font&&t.push({label:"user",src:Io(s.font)}),s.font=t,s.text=""+s.text,s.sdfGlyphSize=s.sdfGlyphSize||It.sdfGlyphSize,s.unicodeFontsURL=s.unicodeFontsURL||It.unicodeFontsURL,s.colorRanges!=null){let h={};for(let v in s.colorRanges)if(s.colorRanges.hasOwnProperty(v)){let p=s.colorRanges[v];typeof p!="number"&&(p=zs.set(p).getHex()),h[v]=p}s.colorRanges=h}Object.freeze(s);const{textureWidth:e,sdfExponent:r}=It,{sdfGlyphSize:i}=s,o=e/i*4;let a=Oo[i];if(!a){const h=document.createElement("canvas");h.width=e,h.height=i*256/o,a=Oo[i]={glyphCount:0,sdfGlyphSize:i,sdfCanvas:h,sdfTexture:new Va(h,void 0,void 0,void 0,lo,lo),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,Xs(a)}const{sdfTexture:l,sdfCanvas:c}=a;va(s).then(h=>{const{glyphIds:v,glyphFontIndices:p,fontData:_,glyphPositions:B,fontSize:D,timings:b}=h,x=[],S=new Float32Array(v.length*4);let O=0,U=0;const F=Rt(),j=_.map(C=>{let H=a.glyphsByFont.get(C.src);return H||a.glyphsByFont.set(C.src,H=new Map),H});v.forEach((C,H)=>{const X=p[H],{src:ne,unitsPerEm:ae}=_[X];let y=j[X].get(C);if(!y){const{path:E,pathBounds:w}=h.glyphData[ne][C],V=Math.max(w[2]-w[0],w[3]-w[1])/i*(It.sdfMargin*i+.5),L=a.glyphCount++,z=[w[0]-V,w[1]-V,w[2]+V,w[3]+V];j[X].set(C,y={path:E,atlasIndex:L,sdfViewBox:z}),x.push(y)}const{sdfViewBox:R}=y,m=B[U++],T=B[U++],A=D/ae;S[O++]=m+R[0]*A,S[O++]=T+R[1]*A,S[O++]=m+R[2]*A,S[O++]=T+R[3]*A,v[H]=y.atlasIndex}),b.quads=(b.quads||0)+(Rt()-F);const P=Rt();b.sdf={};const ee=c.height,g=Math.ceil(a.glyphCount/o),G=Math.pow(2,Math.ceil(Math.log2(g*i)));G>ee&&(console.info(`Increasing SDF texture size ${ee}->${G}`),Vs(c,e,G),l.dispose()),Promise.all(x.map(C=>ha(C,a,s.gpuAccelerateSDF).then(({timing:H})=>{b.sdf[C.atlasIndex]=H}))).then(()=>{x.length&&!a.contextLost&&(pa(a),l.needsUpdate=!0),b.sdfTotal=Rt()-P,b.total=Rt()-u,n(Object.freeze({parameters:s,sdfTexture:l,sdfGlyphSize:i,sdfExponent:r,glyphBounds:S,glyphAtlasIndices:v,glyphColors:h.glyphColors,caretPositions:h.caretPositions,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))})}),Promise.resolve().then(()=>{a.contextLost||Ws(c)})}function ha({path:s,atlasIndex:n,sdfViewBox:u},{sdfGlyphSize:f,sdfCanvas:t,contextLost:e},r){if(e)return Promise.resolve({timing:-1});const{textureWidth:i,sdfExponent:o}=It,a=Math.max(u[2]-u[0],u[3]-u[1]),l=Math.floor(n/4),c=l%(i/f)*f,d=Math.floor(l/(i/f))*f,h=n%4;return Os(f,f,s,u,a,o,t,c,d,h,r)}function Xs(s){const n=s.sdfCanvas;n.addEventListener("webglcontextlost",u=>{console.log("Context Lost",u),u.preventDefault(),s.contextLost=!0}),n.addEventListener("webglcontextrestored",u=>{console.log("Context Restored",u),s.contextLost=!1;const f=[];s.glyphsByFont.forEach(t=>{t.forEach(e=>{f.push(ha(e,s,!0))})}),Promise.all(f).then(()=>{pa(s),s.sdfTexture.needsUpdate=!0})})}function Hs(s,n){for(let u in n)n.hasOwnProperty(u)&&(s[u]=n[u]);return s}let An;function Io(s){return An||(An=typeof document>"u"?{}:document.createElement("a")),An.href=s,An.href}function pa(s){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:n,sdfTexture:u}=s,{width:f,height:t}=n,e=s.sdfCanvas.getContext("webgl");let r=u.image.data;(!r||r.length!==f*t*4)&&(r=new Uint8Array(f*t*4),u.image={width:f,height:t,data:r},u.flipY=!1,u.isDataTexture=!0),e.readPixels(0,0,f,t,e.RGBA,e.UNSIGNED_BYTE,r)}}const Ys=jt({name:"Typesetter",dependencies:[Ls,Rs,ys],init(s,n,u){return s(n,u())}}),va=jt({name:"Typesetter",dependencies:[Ys],init(s){return function(n){return new Promise(u=>{s.typeset(n,u)})}},getTransferables(s){const n=[];for(let u in s)s[u]&&s[u].buffer&&n.push(s[u].buffer);return n}});va.onMainThread;const Po={};function Js(s){let n=Po[s];return n||(n=Po[s]=new Mr(1,1,s,s).translate(.5,.5,0)),n}const Ks="aTroikaGlyphBounds",Bo="aTroikaGlyphIndex",Zs="aTroikaGlyphColor";class qs extends za{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new ja,this.boundingBox=new jo}computeBoundingSphere(){}computeBoundingBox(){}set detail(n){if(n!==this._detail){this._detail=n,(typeof n!="number"||n<1)&&(n=1);let u=Js(n);["position","normal","uv"].forEach(f=>{this.attributes[f]=u.attributes[f].clone()}),this.setIndex(u.getIndex().clone())}}get detail(){return this._detail}set curveRadius(n){n!==this._curveRadius&&(this._curveRadius=n,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(n,u,f,t,e){this.updateAttributeData(Ks,n,4),this.updateAttributeData(Bo,u,1),this.updateAttributeData(Zs,e,3),this._blockBounds=f,this._chunkedBounds=t,this.instanceCount=u.length,this._updateBounds()}_updateBounds(){const n=this._blockBounds;if(n){const{curveRadius:u,boundingBox:f}=this;if(u){const{PI:t,floor:e,min:r,max:i,sin:o,cos:a}=Math,l=t/2,c=t*2,d=Math.abs(u),h=n[0]/d,v=n[2]/d,p=e((h+l)/c)!==e((v+l)/c)?-d:r(o(h)*d,o(v)*d),_=e((h-l)/c)!==e((v-l)/c)?d:i(o(h)*d,o(v)*d),B=e((h+t)/c)!==e((v+t)/c)?d*2:i(d-a(h)*d,d-a(v)*d);f.min.set(p,n[1],u<0?-B:0),f.max.set(_,n[3],u<0?0:B)}else f.min.set(n[0],n[1],0),f.max.set(n[2],n[3],0);f.getBoundingSphere(this.boundingSphere)}}applyClipRect(n){let u=this.getAttribute(Bo).count,f=this._chunkedBounds;if(f)for(let t=f.length;t--;){u=f[t].end;let e=f[t].rect;if(e[1]<n.w&&e[3]>n.y&&e[0]<n.z&&e[2]>n.x)break}this.instanceCount=u}updateAttributeData(n,u,f){const t=this.getAttribute(n);u?t&&t.array.length===u.length?(t.array.set(u),t.needsUpdate=!0):(this.setAttribute(n,new Xa(u,f)),delete this._maxInstanceCount,this.dispose()):t&&this.deleteAttribute(n)}}const Qs=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,$s=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,el=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,tl=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function nl(s){const n=kr(s,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Pn},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new uo(0,0,0,0)},uTroikaClipRect:{value:new uo(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Pn},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Wn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Ha},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Qs,vertexTransform:$s,fragmentDefs:el,fragmentColorTransform:tl,customRewriter({vertexShader:u,fragmentShader:f}){let t=/\buniform\s+vec3\s+diffuse\b/;return t.test(f)&&(f=f.replace(t,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),t.test(u)||(u=u.replace(ca,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:u,fragmentShader:f}}});return n.transparent=!0,n.forceSinglePass=!0,Object.defineProperties(n,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),n}const Pr=new Ya({color:16777215,side:Ja,transparent:!0}),Go=8421504,No=new Ka,Fn=new Fr,gr=new Fr,rn=[],rl=new Fr,_r="+x+y";function Wo(s){return Array.isArray(s)?s[0]:s}let ma=()=>{const s=new Ar(new Mr(1,1),Pr);return ma=()=>s,s},ga=()=>{const s=new Ar(new Mr(1,1,32,1),Pr);return ga=()=>s,s};const ol={type:"syncstart"},al={type:"synccomplete"},_a=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],il=_a.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class ya extends Ar{constructor(){const n=new qs;super(n,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=Go,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=_r,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(n){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(n):(this._isSyncing=!0,this.dispatchEvent(ol),js({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},u=>{this._isSyncing=!1,this._textRenderInfo=u,this.geometry.updateGlyphs(u.glyphBounds,u.glyphAtlasIndices,u.blockBounds,u.chunkedBounds,u.glyphColors);const f=this._queuedSyncs;f&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{f.forEach(t=>t&&t())})),this.dispatchEvent(al),n&&n()})))}onBeforeRender(n,u,f,t,e,r){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(n){return nl(n)}get material(){let n=this._derivedMaterial;const u=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Pr.clone());if((!n||!n.isDerivedFrom(u))&&(n=this._derivedMaterial=this.createDerivedMaterial(u),u.addEventListener("dispose",function f(){u.removeEventListener("dispose",f),n.dispose()})),this.hasOutline()){let f=n._outlineMtl;return f||(f=n._outlineMtl=Object.create(n,{id:{value:n.id+.1}}),f.isTextOutlineMaterial=!0,f.depthWrite=!1,f.map=null,n.addEventListener("dispose",function t(){n.removeEventListener("dispose",t),f.dispose()})),[f,n]}else return n}set material(n){n&&n.isTroikaTextMaterial?(this._derivedMaterial=n,this._baseMaterial=n.baseMaterial):this._baseMaterial=n}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(n){this.geometry.detail=n}get curveRadius(){return this.geometry.curveRadius}set curveRadius(n){this.geometry.curveRadius=n}get customDepthMaterial(){return Wo(this.material).getDepthMaterial()}set customDepthMaterial(n){}get customDistanceMaterial(){return Wo(this.material).getDistanceMaterial()}set customDistanceMaterial(n){}_prepareForRender(n){const u=n.isTextOutlineMaterial,f=n.uniforms,t=this.textRenderInfo;if(t){const{sdfTexture:i,blockBounds:o}=t;f.uTroikaSDFTexture.value=i,f.uTroikaSDFTextureSize.value.set(i.image.width,i.image.height),f.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,f.uTroikaSDFExponent.value=t.sdfExponent,f.uTroikaTotalBounds.value.fromArray(o),f.uTroikaUseGlyphColors.value=!u&&!!t.glyphColors;let a=0,l=0,c=0,d,h,v,p=0,_=0;if(u){let{outlineWidth:D,outlineOffsetX:b,outlineOffsetY:x,outlineBlur:S,outlineOpacity:O}=this;a=this._parsePercent(D)||0,l=Math.max(0,this._parsePercent(S)||0),d=O,p=this._parsePercent(b)||0,_=this._parsePercent(x)||0}else c=Math.max(0,this._parsePercent(this.strokeWidth)||0),c&&(v=this.strokeColor,f.uTroikaStrokeColor.value.set(v??Go),h=this.strokeOpacity,h==null&&(h=1)),d=this.fillOpacity;f.uTroikaEdgeOffset.value=a,f.uTroikaPositionOffset.value.set(p,_),f.uTroikaBlurRadius.value=l,f.uTroikaStrokeWidth.value=c,f.uTroikaStrokeOpacity.value=h,f.uTroikaFillOpacity.value=d??1,f.uTroikaCurveRadius.value=this.curveRadius||0;let B=this.clipRect;if(B&&Array.isArray(B)&&B.length===4)f.uTroikaClipRect.value.fromArray(B);else{const D=(this.fontSize||.1)*100;f.uTroikaClipRect.value.set(o[0]-D,o[1]-D,o[2]+D,o[3]+D)}this.geometry.applyClipRect(f.uTroikaClipRect.value)}f.uTroikaSDFDebug.value=!!this.debugSDF,n.polygonOffset=!!this.depthOffset,n.polygonOffsetFactor=n.polygonOffsetUnits=this.depthOffset||0;const e=u?this.outlineColor||0:this.color;if(e==null)delete n.color;else{const i=n.hasOwnProperty("color")?n.color:n.color=new Wn;(e!==i._input||typeof e=="object")&&i.set(i._input=e)}let r=this.orientation||_r;if(r!==n._orientation){let i=f.uTroikaOrient.value;r=r.replace(/[^-+xyz]/g,"");let o=r!==_r&&r.match(/^([-+])([xyz])([-+])([xyz])$/);if(o){let[,a,l,c,d]=o;Fn.set(0,0,0)[l]=a==="-"?1:-1,gr.set(0,0,0)[d]=c==="-"?-1:1,No.lookAt(rl,Fn.cross(gr),gr),i.setFromMatrix4(No)}else i.identity();n._orientation=r}}_parsePercent(n){if(typeof n=="string"){let u=n.match(/^(-?[\d.]+)%$/),f=u?parseFloat(u[1]):NaN;n=(isNaN(f)?0:f/100)*this.fontSize}return n}localPositionToTextCoords(n,u=new Pn){u.copy(n);const f=this.curveRadius;return f&&(u.x=Math.atan2(n.x,Math.abs(f)-Math.abs(n.z))*Math.abs(f)),u}worldPositionToTextCoords(n,u=new Pn){return Fn.copy(n),this.localPositionToTextCoords(this.worldToLocal(Fn),u)}raycast(n,u){const{textRenderInfo:f,curveRadius:t}=this;if(f){const e=f.blockBounds,r=t?ga():ma(),i=r.geometry,{position:o,uv:a}=i.attributes;for(let l=0;l<a.count;l++){let c=e[0]+a.getX(l)*(e[2]-e[0]);const d=e[1]+a.getY(l)*(e[3]-e[1]);let h=0;t&&(h=t-Math.cos(c/t)*t,c=Math.sin(c/t)*t),o.setXYZ(l,c,d,h)}i.boundingSphere=this.geometry.boundingSphere,i.boundingBox=this.geometry.boundingBox,r.matrixWorld=this.matrixWorld,r.material.side=this.material.side,rn.length=0,r.raycast(n,rn);for(let l=0;l<rn.length;l++)rn[l].object=this,u.push(rn[l])}}copy(n){const u=this.geometry;return super.copy(n),this.geometry=u,il.forEach(f=>{this[f]=n[f]}),this}clone(){return new this.constructor().copy(this)}}_a.forEach(s=>{const n="_private_"+s;Object.defineProperty(ya.prototype,s,{get(){return this[n]},set(u){u!==this[n]&&(this[n]=u,this._needsSync=!0)}})});new jo;new Wn;const sl=2e3,ll={__name:"Home3D",emits:["bookShow"],setup(s,{emit:n}){const u=n;let f=null,t=null,e={shi:null,fen:null,miao:null},r=null,i=null,o=null,a=null,l=null,c=null,d=null,h=null,v,p,_,B,D,b,x=!1;const S=window.devicePixelRatio||1;let O=!1;function U(){p=document.getElementById("audio"),v=p.getContext("2d"),p.width=p.clientWidth*S,p.height=p.clientHeight*S,v.scale(S,S)}function F(){b=document.createElement("video"),b.src="/home//public/mp4/test.mp4",b.loop=!0,b.crossOrigin="anonymous",b.addEventListener("play",()=>{O=!0,x||j(),P()}),b.addEventListener("pause",()=>{O=!1}),b.addEventListener("ended",()=>{y()})}function j(){const k=new AudioContext,I=k.createMediaElementSource(b);_=k.createAnalyser(),B=_.frequencyBinCount,_.fftSize=B/2,I.connect(_),_.connect(k.destination),D=new Uint8Array(B),x=!0}function P(){if(!O)return;requestAnimationFrame(P),v.clearRect(0,0,p.width,p.height),_.getByteFrequencyData(D),v.clearRect(0,0,p.width,p.height);const k=_.frequencyBinCount,I=p.width/k,N=Math.floor(k/2);for(let M=0;M<N;M++){const K=D[M],q=K*(p.height/256),Y=K+50>255?255:K+50,Z=50,re=150;v.fillStyle=`rgb(${Y},${Z},${re})`;let J=M*I,oe=p.height-q;v.fillRect(J,oe,I,q);let $=p.width-(M+1)*I,W=p.height-q;v.fillRect($,W,I,q)}}function ee(){const k=new Date,I=k.getFullYear(),N=k.getMonth()+1,M=N<10?"0"+N:N,K=k.getDate(),q=K<10?"0"+K:K;return{year:I,month:M,day:q}}function g(k,I=[0,0,0],N=1,M="bold"){const K=new ya;return K.text=k,K.font="/home/public/fonts/digital7.ttf",K.fontSize=N,K.position.set(...I),K.rotation.y=Math.PI/2,K.color=0,K.fontWeight=M,K.anchorX="center",K.anchorY="middle",K.sync(),K}const G=(k,I)=>{const N=new k.CubeTextureLoader().setPath("/home//public/images/").load(["nx.png","px.png","py.png","ny.png","nz.png","pz.png"]);I.background=N;const M=new Date().getHours();if(M>=18||M<6){I.background=new k.Color(265780);let q=[{nubmer:1850,color:16777215,size:1.5,scalar:1,multiple:500}];for(let Y=0;Y<q.length;Y++){const Z=$a(q[Y]);Z.rotation.x=Math.random()*6,Z.rotation.y=Math.random()*6,Z.rotation.z=Math.random()*6,Z.matrixAutoUpdate=!1,Z.updateMatrix(),Z.position.set(0,0,0),I.add(Z)}}},C=(k,I,N,M)=>{xn.install({THREE:k}),f=new xn(N,M.domElement),f.minZoom=.1,f.maxZoom=15,f.enableTransition=!0,f.transitionTime=1,f.mouseButtons.wheel=xn.ACTION.NONE,f.mouseButtons.left=xn.ACTION.NONE,f.update(),f.saveState(),I.addEventListener("mouseDown",function(K){f.enabled=!1}),I.addEventListener("mouseUp",function(K){f.enabled=!0})},H=(k,I)=>{const N=new k.AmbientLight(203843,.6);I.add(N);const M=new k.DirectionalLight(16777215,.3);M.position.set(-99.4535,52.788402638514,-25.3826),M.castShadow=!0,I.add(M),r=new k.PointLight(16774827,50,100),r.position.set(27.105,2.1298,-29.157),r.castShadow=!0,I.add(r),i=new k.PointLight(16777215,1,200),i.position.set(11.376385097904176,26.471699160045343,6.353171916870222),i.castShadow=!0,I.add(i);const K=new k.CylinderGeometry(1.66,1.66,4,32);o=new k.Mesh(K,new k.MeshStandardMaterial({color:1118481,transparent:!0,opacity:.46,emissive:16711680,emissiveIntensity:100,metalness:0,roughness:.5})),o.position.set(-29.33046480164147,8.629849073395794,-16.21725577998555),o.castShadow=!0,I.add(o)},X=({THREE:k,scene:I,transControls:N,camera:M,renderer:K})=>{C(k,N,M,K),G(k,I),H(k,I);const q=new k.Group,Y=st(I.children,"home");Y.position.set(0,-15,0);const Z=st(Y.children,"主体");Z.castShadow=!0,Z.receiveShadow=!0,a=st(Y.children,"xiaodeng"),a.material.emissive=new k.Color(1118481),a.material.envMapIntensity=0,a.castShadow=!0,a.receiveShadow=!0;const re=st(Y.children,"闹钟"),J=st(re.children,"shi"),oe=st(re.children,"fen"),$=st(re.children,"miao");e={shi:J,fen:oe,miao:$},e.shi.rotation.y=0,e.fen.rotation.y=0,e.miao.rotation.y=0;const W=st(Y.children,"电脑桌");W.castShadow=!0,W.receiveShadow=!0;const{year:ue,month:te,day:ie}=ee(),Q=g(`${ue}`,[-24.21810526958002,6.28957649,17.8168586],1);I.add(Q);const Te=g("Year",[-24.21810526958002,5.06957649,18.2068586],.6,"regular");I.add(Te);const se=g(`${te}`,[-24.21810526958002,6.28957649,15.8168586],1);I.add(se);const le=g("Month",[-24.21810526958002,5.06957649,15.8968586],.6,"regular");I.add(le);const de=g(`${ie}`,[-24.21810526958002,6.28957649,14.2168586],1);I.add(de);const ge=g("Day",[-24.21810526958002,5.06957649,14.0468586],.6,"regular");I.add(ge);const Ce=st(I.children,"xianshiqi");if(Ce.castShadow=!0,b.src){const fe=new k.VideoTexture(b);fe.flipY=!1;const Ue=new k.MeshBasicMaterial({map:fe});Ce.material=Ue,Ce.castShadow=!0}l=st(Y.children,"柱体014");const Ae={y:0},pe={y:Math.PI*2};h=new ti(Ae).to(pe,3e3).easing(ni.Quadratic.InOut).onUpdate(()=>{l.rotation.y=Ae.y}).delay(3e3).start();const me=[{name:"xc_db",size:[4.2,4.2],position:[25.147446346740253,20.1227880586422,-32.918080391178876],src:"/public/dfsj/db/gzlh.png"}],ce=new k.TextureLoader;for(let fe=0;fe<me.length;fe++){const Ue=me[fe];ce.load("/home/"+Ue.src,et=>{const Se=Qa(me[fe]);Se.name=me[fe].name,Se.material=new k.MeshLambertMaterial({map:et}),q.add(Se)})}const ve=new k.PlaneGeometry(16,25),_e=new k.MeshBasicMaterial({color:65280,transparent:!0,opacity:0}),Ie=new k.Mesh(ve,_e);Ie.rotation.y=Math.PI/2,Ie.position.set(-26.75,7.5,29.5),Ie.name="shujibox",q.add(Ie),I.add(q),f.rotate(72*k.MathUtils.DEG2RAD,0,!0),f.setTarget(-.2176510350531844,.06773081571016058,.014509065832072607,!0);let De=[];c=fe=>{De=[fe.clientX,fe.clientY]},d=async fe=>{const[Ue,et]=De;if(Math.abs(Ue-fe.clientX)>2||Math.abs(et-fe.clientY)>2)return;let Se=await ei({el:"#canvas",camera:M,group:q,event:fe});Se!=null&&Se.object&&(t&&(t=null),t=Se.object,console.log(t.name),t.name=="shujibox"&&R(),t.name.indexOf("xc")>-1&&m(t.index))},document.body.addEventListener("mousedown",c),document.body.addEventListener("mouseup",d),document.body.addEventListener("keydown",ae)};let ne=!0;const ae=k=>{k.key=="Control"&&(ne=!ne),k.code=="Space"&&(O?(b.pause(),Co("#audio",{bottom:"-80px"})):(b.play(),Co("#audio",{bottom:"0"})),k.preventDefault)},y=k=>{const I=new KeyboardEvent("keydown",{key:" ",code:"Space",keyCode:32,bubbles:!0,cancelable:!0});document.body.dispatchEvent(I)},R=()=>{u("bookShow")},m=k=>{fo.show("/home//public/dfsj/db/gzlh.png")},T=()=>{const k=new Date,I=k.getHours()%12||12,N=k.getMinutes(),M=k.getSeconds();return[I,N,M]},A=()=>{const{shi:k,fen:I,miao:N}=e;if(!k||!I||!N)return;e.shi.rotation.y=0,e.fen.rotation.y=0,e.miao.rotation.y=0;const[M,K,q]=T(),Y={shi:M*(2*Math.PI/12)+Math.PI/2,fen:-K*(2*Math.PI/60)+Math.PI/2,miao:q*(2*Math.PI/60)+Math.PI/2};k.rotation.y=Y.shi,I.rotation.y=Y.fen,N.rotation.y=Y.miao};let E=Date.now();const w=(k,I)=>{const N=Date.now();if(N-E>=sl){const M=new I.Color(Math.random()*16777215);k.material.emissive=M,E=N}k.material.emissiveIntensity=Math.sin(Date.now()*.001*Math.PI)*.5+.5},V=({THREE:k,scene:I,camera:N,renderer:M,clock:K,stats:q})=>{const Y=K.getDelta();f.update(Y),q.update(),A(),ne?(r.visible=!0,i.intensity=2e3,a.material.emissive=new k.Color(16777215),a.material.envMapIntensity=1):(r.visible=!1,i.intensity=20,a.material.emissive=new k.Color(1118481),a.material.envMapIntensity=0),O?w(o,k):o.material.emissive=new k.Color(0),h.update(),M.render(I,N)},{loading:L,pregress:z}=Za({el:"#canvas",background:"#111",modelPath:["house.glb"],modelName:["home"],modelScale:[2.5,2.5,2.5],cameraPosition:[-20,-0,42],control:!1,helper:!1,light:!1,transformControls:!0,showStats:!0,statsPosition:[0,0],creatMesh:X,animation:V});return Vo(()=>{fo.mount(),U(),F()}),Ra(()=>{ne=!1,document.body.removeEventListener("mousedown",c),document.body.removeEventListener("mouseup",d),document.body.removeEventListener("keydown",ae),h&&(h.stop(),ri(h),h=null)}),(k,I)=>(yt(),La(qa,{loading:so(L),pregress:so(z)},{default:Oa(()=>I[0]||(I[0]=[Xe("canvas",{id:"canvas"},null,-1),Xe("canvas",{id:"audio"},null,-1)])),_:1},8,["loading","pregress"]))}},ul=Nn(ll,[["__scopeId","data-v-009ffc42"]]),fl={__name:"Home",setup(s){const n=zo(),u=yr([]),f=()=>{u.value=Ia.menus.filter(i=>i.path!=="/"),n.setFlagStatus(!0)};Vo(()=>{f()});const t=yr(!1),e=()=>{t.value=!0},r=()=>{t.value=!1};return(i,o)=>(yt(),Ut(br,null,[Tr(ul,{onBookShow:e}),Tr(mi,{show:t.value,menus:u.value,onBookHide:r},null,8,["show","menus"]),o[0]||(o[0]=Xe("div",{class:"tip-right"},[Xe("p",null,"1.点击“书本”查看网站知识库"),Xe("p",null,"2.点击“显示器”播放MV"),Xe("p",null,"3.点击“相册”查看案例"),Xe("p",null,"4.按Ctrl键-开关灯|空格键控制视频播放")],-1))],64))}},Tl=Nn(fl,[["__scopeId","data-v-416750be"]]);export{Tl as default};
