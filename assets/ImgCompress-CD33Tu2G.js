import{s as k,A as Te,i as ke,q as Ae,c as P,o as z,g as w,f as q,z as S,x as Y,t as W,K as J}from"./vue-vendor-C-eO5OHd.js";import{_ as De}from"./index-k_b31qc0.js";import"http://115.190.117.177:10086/mds/pathList.js";/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function ve(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),t.push.apply(t,r)}return t}function H(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ve(Object(t),!0).forEach(function(r){je(a,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):ve(Object(t)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(t,r))})}return a}function Me(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function ge(a,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,xe(r.key),r)}}function Fe(a,e,t){return e&&ge(a.prototype,e),t&&ge(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function je(a,e,t){return e=xe(e),e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function N(){return N=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(a[r]=t[r])}return a},N.apply(this,arguments)}function Ce(a,e){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var r=t.call(a,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}function xe(a){var e=Ce(a,"string");return typeof e=="symbol"?e:String(e)}var Ue={exports:{}};(function(a){typeof window>"u"||(function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,r=e.Blob&&(function(){try{return!!new Blob}catch{return!1}})(),n=r&&e.Uint8Array&&(function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}})(),o=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,h=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,f=(r||o)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(l){var u,g,p,R,b,i,s,c,d;if(u=l.match(h),!u)throw new Error("invalid data URI");for(g=u[2]?u[1]:"text/plain"+(u[3]||";charset=US-ASCII"),p=!!u[4],R=l.slice(u[0].length),p?b=atob(R):b=decodeURIComponent(R),i=new ArrayBuffer(b.length),s=new Uint8Array(i),c=0;c<b.length;c+=1)s[c]=b.charCodeAt(c);return r?new Blob([n?s:i],{type:g}):(d=new o,d.append(i),d.getBlob(g))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(l,u,g){var p=this;setTimeout(function(){g&&t.toDataURL&&f?l(f(p.toDataURL(u,g))):l(p.mozGetAsFile("blob",u))})}:t.toDataURL&&f&&(t.msToBlob?t.toBlob=function(l,u,g){var p=this;setTimeout(function(){(u&&u!=="image/png"||g)&&t.toDataURL&&f?l(f(p.toDataURL(u,g))):l(p.msToBlob(u))})}:t.toBlob=function(l,u,g){var p=this;setTimeout(function(){l(f(p.toDataURL(u,g)))})})),a.exports?a.exports=f:e.dataURLtoBlob=f})(window)})(Ue);var pe=Ue.exports,Ie=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},be={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Pe=typeof window<"u"&&typeof window.document<"u",O=Pe?window:{},_=function(e){return e>0&&e<1/0},ze=Array.prototype.slice;function ee(a){return Array.from?Array.from(a):ze.call(a)}var Se=/^image\/.+$/;function Q(a){return Se.test(a)}function We(a){var e=Q(a)?a.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var Re=String.fromCharCode;function He(a,e,t){var r="",n;for(t+=e,n=e;n<t;n+=1)r+=Re(a.getUint8(n));return r}var Ne=O.btoa;function ye(a,e){for(var t=[],r=8192,n=new Uint8Array(a);n.length>0;)t.push(Re.apply(null,ee(n.subarray(0,r)))),n=n.subarray(r);return"data:".concat(e,";base64,").concat(Ne(t.join("")))}function _e(a){var e=new DataView(a),t;try{var r,n,o;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var h=e.byteLength,f=2;f+1<h;){if(e.getUint8(f)===255&&e.getUint8(f+1)===225){n=f;break}f+=1}if(n){var l=n+4,u=n+10;if(He(e,l,4)==="Exif"){var g=e.getUint16(u);if(r=g===18761,(r||g===19789)&&e.getUint16(u+2,r)===42){var p=e.getUint32(u+4,r);p>=8&&(o=u+p)}}}if(o){var R=e.getUint16(o,r),b,i;for(i=0;i<R;i+=1)if(b=o+i*12+2,e.getUint16(b,r)===274){b+=8,t=e.getUint16(b,r),e.setUint16(b,1,r);break}}}catch{t=1}return t}function Ve(a){var e=0,t=1,r=1;switch(a){case 2:t=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:r}}var Ge=/\.\d*(?:0|9){12}\d*$/;function we(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Ge.test(a)?Math.round(a*e)/e:a}function I(a){var e=a.aspectRatio,t=a.height,r=a.width,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",o=_(r),h=_(t);if(o&&h){var f=t*e;(n==="contain"||n==="none")&&f>r||n==="cover"&&f<r?t=r/e:r=t*e}else o?t=r/e:h&&(r=t*e);return{width:r,height:t}}function Xe(a){for(var e=ee(new Uint8Array(a)),t=e.length,r=[],n=0;n+3<t;){var o=e[n],h=e[n+1];if(o===255&&h===218)break;if(o===255&&h===216)n+=2;else{var f=e[n+2]*256+e[n+3],l=n+f+2,u=e.slice(n,l);r.push(u),n=l}}return r.reduce(function(g,p){return p[0]===255&&p[1]===225?g.concat(p):g},[])}function Ke(a,e){var t=ee(new Uint8Array(a));if(t[2]!==255||t[3]!==224)return a;var r=t[4]*256+t[5],n=[255,216].concat(e,t.slice(4+r));return new Uint8Array(n)}var $e=O.ArrayBuffer,Z=O.FileReader,A=O.URL||O.webkitURL,qe=/\.\w+$/,Ye=O.Compressor,Je=(function(){function a(e,t){Me(this,a),this.file=e,this.exif=[],this.image=new Image,this.options=H(H({},be),t),this.aborted=!1,this.result=null,this.init()}return Fe(a,[{key:"init",value:function(){var t=this,r=this.file,n=this.options;if(!Ie(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var o=r.type;if(!Q(o)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!A||!Z){this.fail(new Error("The current browser does not support image compression."));return}$e||(n.checkOrientation=!1,n.retainExif=!1);var h=o==="image/jpeg",f=h&&n.checkOrientation,l=h&&n.retainExif;if(A&&!f&&!l)this.load({url:A.createObjectURL(r)});else{var u=new Z;this.reader=u,u.onload=function(g){var p=g.target,R=p.result,b={},i=1;f&&(i=_e(R),i>1&&N(b,Ve(i))),l&&(t.exif=Xe(R)),f||l?!A||i>1?b.url=ye(R,o):b.url=A.createObjectURL(r):b.url=R,t.load(b)},u.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},u.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},u.onloadend=function(){t.reader=null},f||l?u.readAsArrayBuffer(r):u.readAsDataURL(r)}}},{key:"load",value:function(t){var r=this,n=this.file,o=this.image;o.onload=function(){r.draw(H(H({},t),{},{naturalWidth:o.naturalWidth,naturalHeight:o.naturalHeight}))},o.onabort=function(){r.fail(new Error("Aborted to load the image."))},o.onerror=function(){r.fail(new Error("Failed to load the image."))},O.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(O.navigator.userAgent)&&(o.crossOrigin="anonymous"),o.alt=n.name,o.src=t.url}},{key:"draw",value:function(t){var r=this,n=t.naturalWidth,o=t.naturalHeight,h=t.rotate,f=h===void 0?0:h,l=t.scaleX,u=l===void 0?1:l,g=t.scaleY,p=g===void 0?1:g,R=this.file,b=this.image,i=this.options,s=document.createElement("canvas"),c=s.getContext("2d"),d=Math.abs(f)%180===90,x=(i.resize==="contain"||i.resize==="cover")&&_(i.width)&&_(i.height),m=Math.max(i.maxWidth,0)||1/0,y=Math.max(i.maxHeight,0)||1/0,E=Math.max(i.minWidth,0)||0,B=Math.max(i.minHeight,0)||0,L=n/o,v=i.width,U=i.height;if(d){var M=[y,m];m=M[0],y=M[1];var T=[B,E];E=T[0],B=T[1];var V=[U,v];v=V[0],U=V[1]}x&&(L=v/U);var F=I({aspectRatio:L,width:m,height:y},"contain");m=F.width,y=F.height;var te=I({aspectRatio:L,width:E,height:B},"cover");if(E=te.width,B=te.height,x){var re=I({aspectRatio:L,width:v,height:U},i.resize);v=re.width,U=re.height}else{var ae=I({aspectRatio:L,width:v,height:U}),ie=ae.width;v=ie===void 0?n:ie;var ne=ae.height;U=ne===void 0?o:ne}v=Math.floor(we(Math.min(Math.max(v,E),m))),U=Math.floor(we(Math.min(Math.max(U,B),y)));var Be=-v/2,Ee=-U/2,Le=v,Oe=U,G=[];if(x){var oe=0,le=0,X=n,K=o,se=I({aspectRatio:L,width:n,height:o},{contain:"cover",cover:"contain"}[i.resize]);X=se.width,K=se.height,oe=(n-X)/2,le=(o-K)/2,G.push(oe,le,X,K)}if(G.push(Be,Ee,Le,Oe),d){var ue=[U,v];v=ue[0],U=ue[1]}s.width=v,s.height=U,Q(i.mimeType)||(i.mimeType=R.type);var ce="transparent";R.size>i.convertSize&&i.convertTypes.indexOf(i.mimeType)>=0&&(i.mimeType="image/jpeg");var fe=i.mimeType==="image/jpeg";if(fe&&(ce="#fff"),c.fillStyle=ce,c.fillRect(0,0,v,U),i.beforeDraw&&i.beforeDraw.call(this,c,s),!this.aborted&&(c.save(),c.translate(v/2,U/2),c.rotate(f*Math.PI/180),c.scale(u,p),c.drawImage.apply(c,[b].concat(G)),c.restore(),i.drew&&i.drew.call(this,c,s),!this.aborted)){var he=function(j){if(!r.aborted){var de=function(C){return r.done({naturalWidth:n,naturalHeight:o,result:C})};if(j&&fe&&i.retainExif&&r.exif&&r.exif.length>0){var me=function(C){return de(pe(ye(Ke(C,r.exif),i.mimeType)))};if(j.arrayBuffer)j.arrayBuffer().then(me).catch(function(){r.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var D=new Z;r.reader=D,D.onload=function($){var C=$.target;me(C.result)},D.onabort=function(){r.fail(new Error("Aborted to read the compressed image with FileReader."))},D.onerror=function(){r.fail(new Error("Failed to read the compressed image with FileReader."))},D.onloadend=function(){r.reader=null},D.readAsArrayBuffer(j)}}else de(j)}};s.toBlob?s.toBlob(he,i.mimeType,i.quality):he(pe(s.toDataURL(i.mimeType,i.quality)))}}},{key:"done",value:function(t){var r=t.naturalWidth,n=t.naturalHeight,o=t.result,h=this.file,f=this.image,l=this.options;if(A&&f.src.indexOf("blob:")===0&&A.revokeObjectURL(f.src),o)if(l.strict&&!l.retainExif&&o.size>h.size&&l.mimeType===h.type&&!(l.width>r||l.height>n||l.minWidth>r||l.minHeight>n||l.maxWidth<r||l.maxHeight<n))o=h;else{var u=new Date;o.lastModified=u.getTime(),o.lastModifiedDate=u,o.name=h.name,o.name&&o.type!==h.type&&(o.name=o.name.replace(qe,We(o.type)))}else o=h;this.result=o,l.success&&l.success.call(this,o)}},{key:"fail",value:function(t){var r=this.options;if(r.error)r.error.call(this,t);else throw t}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Ye,a}},{key:"setDefaults",value:function(t){N(be,t)}}]),a})();const Ze={class:"content bg"},Qe={class:"width50"},et={style:{display:"flex"}},tt={style:{"margin-left":"2rem"}},rt={for:"qualitySlider",style:{"margin-bottom":".2rem",display:"flex"}},at={style:{"margin-top":"1rem",display:"flex","align-items":"center"}},it={style:{"margin-top":"1rem",display:"flex","align-items":"center"}},nt={key:0,style:{"margin-top":"1rem"}},ot=["src"],lt={key:2},st={__name:"ImgCompress",setup(a){const e=k(null),t=k(null),r=k(.6),n=k(null),o=k(null),h=k(null),f=k(null);let l=null;function u(i,s=.8,c,d){return new Promise((x,m)=>{const y=new Image,E=URL.createObjectURL(i);y.onload=()=>{try{let B=y.naturalWidth,L=y.naturalHeight,v=1;c&&c>0&&(v=Math.min(v,c/B)),d&&d>0&&(v=Math.min(v,d/L)),v=Math.min(1,v);const U=Math.max(1,Math.round(B*v)),M=Math.max(1,Math.round(L*v)),T=document.createElement("canvas");T.width=U,T.height=M,T.getContext("2d").drawImage(y,0,0,U,M),T.toBlob(F=>{URL.revokeObjectURL(E),F?x(F):m(new Error("toBlob returned null"))},"image/jpeg",Math.max(.01,Math.min(1,s)))}catch(B){URL.revokeObjectURL(E),m(B)}},y.onerror=B=>{URL.revokeObjectURL(E),m(B)},y.src=E})}const p=((i,s)=>{let c=null;return function(...d){c&&clearTimeout(c),c=setTimeout(()=>{i.apply(this,d)},s)}})(()=>{t.value=null,R()},300);Te(()=>r.value,i=>{e.value&&p()});const R=()=>{if(!e.value){console.log("No file to compress");return}n.value=(e.value.size/1024).toFixed(2);try{const i={quality:Math.max(.1,Math.min(1,Number(r.value)||.6)),convertSize:4e6,strict:!0},s=Number(h.value),c=Number(f.value);!Number.isNaN(s)&&s>0&&(i.maxWidth=Math.floor(s)),!Number.isNaN(c)&&c>0&&(i.maxHeight=Math.floor(c)),new Je(e.value,Object.assign({},i,{success:async d=>{try{const x=d.size/1024;if(o.value=x.toFixed(2),window.URL&&URL.createObjectURL){if(l){try{URL.revokeObjectURL(l)}catch{}l=null}const m=URL.createObjectURL(d);t.value=m,l=m}else{const m=new FileReader;m.onloadend=()=>{t.value=m.result},m.readAsDataURL(d)}if(d.size>=e.value.size-100)try{const m=await u(e.value,i.quality,i.maxWidth,i.maxHeight);if(m&&m.size<d.size){if(l)try{URL.revokeObjectURL(l)}catch{}const y=URL.createObjectURL(m);t.value=y,l=y,o.value=(m.size/1024).toFixed(2)}}catch(m){console.warn("Fallback JPEG encoding failed:",m)}}catch(x){console.error("Error processing compressed result:",x)}},error(d){console.error("Compression failed:",d&&d.message?d.message:d)}}))}catch(i){console.error("compressImage error:",i)}},b=()=>{if(!t.value)return;const i=document.createElement("a");i.href=t.value,i.download="img.png",document.body.appendChild(i),i.click(),i.remove()};return ke(()=>{const i=document.getElementById("dropZone"),s=document.getElementById("fileInput");["dragenter","dragover","dragleave","drop"].forEach(x=>{i.addEventListener(x,c,!1)});function c(x){x.preventDefault(),x.stopPropagation()}["dragenter","dragover"].forEach(x=>{i.addEventListener(x,()=>i.classList.add("hover"),!1)}),["dragleave","drop"].forEach(x=>{i.addEventListener(x,()=>i.classList.remove("hover"),!1)}),i.addEventListener("click",()=>s.click(),!1),s.addEventListener("change",d,!1),i.addEventListener("drop",d,!1);function d(x){let m=x.dataTransfer,y=m?m.files:s.files;y.length>0&&(console.log(y),e.value=y[0],console.log("Selected file:",y[0].name),t.value=null,R())}}),Ae(()=>{if(l){try{URL.revokeObjectURL(l)}catch{}l=null}}),(i,s)=>(z(),P("section",Ze,[w("div",Qe,[s[9]||(s[9]=w("h1",null,"图片压缩",-1)),w("div",et,[s[8]||(s[8]=w("div",{id:"dropZone"},[S("将文件拖放到此处"),w("br"),S("或点击选择文件 "),w("input",{type:"file",style:{display:"none"},id:"fileInput"})],-1)),w("div",tt,[w("div",null,[w("label",rt,[s[3]||(s[3]=S(" 选择压缩质量 (0.1 - 1.0)。 ",-1)),w("span",null,"当前："+W(r.value),1)]),s[4]||(s[4]=S()),s[5]||(s[5]=w("br",null,null,-1)),Y(w("input",{id:"qualitySlider",type:"range","onUpdate:modelValue":s[0]||(s[0]=c=>r.value=c),min:"0.1",max:"1.0",step:"0.1"},null,512),[[J,r.value]])]),w("div",at,[s[6]||(s[6]=w("label",{for:"maxWidth"},"最大宽度:",-1)),Y(w("input",{id:"maxWidth",type:"number",style:{height:"2rem",width:"100px","margin-left":"1rem","background-color":"#fff"},"onUpdate:modelValue":s[1]||(s[1]=c=>h.value=c),min:"1",step:"1"},null,512),[[J,h.value]])]),w("div",it,[s[7]||(s[7]=w("label",{for:"maxHeight"},"最大高度:",-1)),Y(w("input",{id:"maxHeight",type:"number",style:{height:"2rem",width:"100px","margin-left":"1rem","background-color":"#fff"},"onUpdate:modelValue":s[2]||(s[2]=c=>f.value=c),min:"1",step:"1"},null,512),[[J,f.value]])])])]),n.value&&o.value?(z(),P("div",nt,[w("p",null,"原始文件大小: "+W(n.value)+"KB",1),w("p",null,"压缩后文件大小: "+W(o.value)+"KB",1),w("p",null,"压缩率: "+W(((1-o.value/n.value)*100).toFixed(2))+"%",1)])):q("",!0),t.value?(z(),P("img",{key:1,class:"codeImage",src:t.value,onClick:b,alt:""},null,8,ot)):q("",!0),t.value?(z(),P("p",lt,"点击图片下载")):q("",!0)])]))}},dt=De(st,[["__scopeId","data-v-9d342041"]]);export{dt as default};
