import{_ as Re,r as H,i as Te,o as _,j as z,a as y,m as N,t as Ae,h as De,G as Oe,k as ce}from"./index-C_oHrnUh.js";/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function he(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),t.push.apply(t,r)}return t}function F(a){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?he(Object(t),!0).forEach(function(r){Fe(a,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):he(Object(t)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(t,r))})}return a}function Le(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function de(a,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,be(r.key),r)}}function ke(a,e,t){return e&&de(a.prototype,e),t&&de(a,t),Object.defineProperty(a,"prototype",{writable:!1}),a}function Fe(a,e,t){return e=be(e),e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function C(){return C=Object.assign?Object.assign.bind():function(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(a[r]=t[r])}return a},C.apply(this,arguments)}function Ce(a,e){if(typeof a!="object"||a===null)return a;var t=a[Symbol.toPrimitive];if(t!==void 0){var r=t.call(a,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(a)}function be(a){var e=Ce(a,"string");return typeof e=="symbol"?e:String(e)}var ye={exports:{}};(function(a){typeof window>"u"||function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,r=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),i=r&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),n=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,u=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,o=(r||n)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(l){var f,c,h,v,d,s,b,m,B;if(f=l.match(u),!f)throw new Error("invalid data URI");for(c=f[2]?f[1]:"text/plain"+(f[3]||";charset=US-ASCII"),h=!!f[4],v=l.slice(f[0].length),h?d=atob(v):d=decodeURIComponent(v),s=new ArrayBuffer(d.length),b=new Uint8Array(s),m=0;m<d.length;m+=1)b[m]=d.charCodeAt(m);return r?new Blob([i?b:s],{type:c}):(B=new n,B.append(s),B.getBlob(c))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(l,f,c){var h=this;setTimeout(function(){c&&t.toDataURL&&o?l(o(h.toDataURL(f,c))):l(h.mozGetAsFile("blob",f))})}:t.toDataURL&&o&&(t.msToBlob?t.toBlob=function(l,f,c){var h=this;setTimeout(function(){(f&&f!=="image/png"||c)&&t.toDataURL&&o?l(o(h.toDataURL(f,c))):l(h.msToBlob(f))})}:t.toBlob=function(l,f,c){var h=this;setTimeout(function(){l(o(h.toDataURL(f,c)))})})),a.exports?a.exports=o:e.dataURLtoBlob=o}(window)})(ye);var ve=ye.exports,Pe=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},me={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Ie=typeof window<"u"&&typeof window.document<"u",w=Ie?window:{},P=function(e){return e>0&&e<1/0},je=Array.prototype.slice;function X(a){return Array.from?Array.from(a):je.call(a)}var Me=/^image\/.+$/;function V(a){return Me.test(a)}function Se(a){var e=V(a)?a.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var we=String.fromCharCode;function We(a,e,t){var r="",i;for(t+=e,i=e;i<t;i+=1)r+=we(a.getUint8(i));return r}var He=w.btoa;function ge(a,e){for(var t=[],r=8192,i=new Uint8Array(a);i.length>0;)t.push(we.apply(null,X(i.subarray(0,r)))),i=i.subarray(r);return"data:".concat(e,";base64,").concat(He(t.join("")))}function _e(a){var e=new DataView(a),t;try{var r,i,n;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var u=e.byteLength,o=2;o+1<u;){if(e.getUint8(o)===255&&e.getUint8(o+1)===225){i=o;break}o+=1}if(i){var l=i+4,f=i+10;if(We(e,l,4)==="Exif"){var c=e.getUint16(f);if(r=c===18761,(r||c===19789)&&e.getUint16(f+2,r)===42){var h=e.getUint32(f+4,r);h>=8&&(n=f+h)}}}if(n){var v=e.getUint16(n,r),d,s;for(s=0;s<v;s+=1)if(d=n+s*12+2,e.getUint16(d,r)===274){d+=8,t=e.getUint16(d,r),e.setUint16(d,1,r);break}}}catch{t=1}return t}function ze(a){var e=0,t=1,r=1;switch(a){case 2:t=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:r}}var Ne=/\.\d*(?:0|9){12}\d*$/;function pe(a){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Ne.test(a)?Math.round(a*e)/e:a}function k(a){var e=a.aspectRatio,t=a.height,r=a.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",n=P(r),u=P(t);if(n&&u){var o=t*e;(i==="contain"||i==="none")&&o>r||i==="cover"&&o<r?t=r/e:r=t*e}else n?t=r/e:u&&(r=t*e);return{width:r,height:t}}function Ge(a){for(var e=X(new Uint8Array(a)),t=e.length,r=[],i=0;i+3<t;){var n=e[i],u=e[i+1];if(n===255&&u===218)break;if(n===255&&u===216)i+=2;else{var o=e[i+2]*256+e[i+3],l=i+o+2,f=e.slice(i,l);r.push(f),i=l}}return r.reduce(function(c,h){return h[0]===255&&h[1]===225?c.concat(h):c},[])}function Ve(a,e){var t=X(new Uint8Array(a));if(t[2]!==255||t[3]!==224)return a;var r=t[4]*256+t[5],i=[255,216].concat(e,t.slice(4+r));return new Uint8Array(i)}var Xe=w.ArrayBuffer,G=w.FileReader,x=w.URL||w.webkitURL,Ye=/\.\w+$/,$e=w.Compressor,qe=function(){function a(e,t){Le(this,a),this.file=e,this.exif=[],this.image=new Image,this.options=F(F({},me),t),this.aborted=!1,this.result=null,this.init()}return ke(a,[{key:"init",value:function(){var t=this,r=this.file,i=this.options;if(!Pe(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var n=r.type;if(!V(n)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!x||!G){this.fail(new Error("The current browser does not support image compression."));return}Xe||(i.checkOrientation=!1,i.retainExif=!1);var u=n==="image/jpeg",o=u&&i.checkOrientation,l=u&&i.retainExif;if(x&&!o&&!l)this.load({url:x.createObjectURL(r)});else{var f=new G;this.reader=f,f.onload=function(c){var h=c.target,v=h.result,d={},s=1;o&&(s=_e(v),s>1&&C(d,ze(s))),l&&(t.exif=Ge(v)),o||l?!x||s>1?d.url=ge(v,n):d.url=x.createObjectURL(r):d.url=v,t.load(d)},f.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},f.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},f.onloadend=function(){t.reader=null},o||l?f.readAsArrayBuffer(r):f.readAsDataURL(r)}}},{key:"load",value:function(t){var r=this,i=this.file,n=this.image;n.onload=function(){r.draw(F(F({},t),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){r.fail(new Error("Aborted to load the image."))},n.onerror=function(){r.fail(new Error("Failed to load the image."))},w.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(w.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=i.name,n.src=t.url}},{key:"draw",value:function(t){var r=this,i=t.naturalWidth,n=t.naturalHeight,u=t.rotate,o=u===void 0?0:u,l=t.scaleX,f=l===void 0?1:l,c=t.scaleY,h=c===void 0?1:c,v=this.file,d=this.image,s=this.options,b=document.createElement("canvas"),m=b.getContext("2d"),B=Math.abs(o)%180===90,I=(s.resize==="contain"||s.resize==="cover")&&P(s.width)&&P(s.height),R=Math.max(s.maxWidth,0)||1/0,T=Math.max(s.maxHeight,0)||1/0,A=Math.max(s.minWidth,0)||0,D=Math.max(s.minHeight,0)||0,E=i/n,g=s.width,p=s.height;if(B){var Y=[T,R];R=Y[0],T=Y[1];var $=[D,A];A=$[0],D=$[1];var q=[p,g];g=q[0],p=q[1]}I&&(E=g/p);var K=k({aspectRatio:E,width:R,height:T},"contain");R=K.width,T=K.height;var Z=k({aspectRatio:E,width:A,height:D},"cover");if(A=Z.width,D=Z.height,I){var J=k({aspectRatio:E,width:g,height:p},s.resize);g=J.width,p=J.height}else{var Q=k({aspectRatio:E,width:g,height:p}),ee=Q.width;g=ee===void 0?i:ee;var te=Q.height;p=te===void 0?n:te}g=Math.floor(pe(Math.min(Math.max(g,A),R))),p=Math.floor(pe(Math.min(Math.max(p,D),T)));var xe=-g/2,Be=-p/2,Ee=g,Ue=p,j=[];if(I){var re=0,ae=0,M=i,S=n,ie=k({aspectRatio:E,width:i,height:n},{contain:"cover",cover:"contain"}[s.resize]);M=ie.width,S=ie.height,re=(i-M)/2,ae=(n-S)/2,j.push(re,ae,M,S)}if(j.push(xe,Be,Ee,Ue),B){var ne=[p,g];g=ne[0],p=ne[1]}b.width=g,b.height=p,V(s.mimeType)||(s.mimeType=v.type);var oe="transparent";v.size>s.convertSize&&s.convertTypes.indexOf(s.mimeType)>=0&&(s.mimeType="image/jpeg");var se=s.mimeType==="image/jpeg";if(se&&(oe="#fff"),m.fillStyle=oe,m.fillRect(0,0,g,p),s.beforeDraw&&s.beforeDraw.call(this,m,b),!this.aborted&&(m.save(),m.translate(g/2,p/2),m.rotate(o*Math.PI/180),m.scale(f,h),m.drawImage.apply(m,[d].concat(j)),m.restore(),s.drew&&s.drew.call(this,m,b),!this.aborted)){var le=function(O){if(!r.aborted){var ue=function(L){return r.done({naturalWidth:i,naturalHeight:n,result:L})};if(O&&se&&s.retainExif&&r.exif&&r.exif.length>0){var fe=function(L){return ue(ve(ge(Ve(L,r.exif),s.mimeType)))};if(O.arrayBuffer)O.arrayBuffer().then(fe).catch(function(){r.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var U=new G;r.reader=U,U.onload=function(W){var L=W.target;fe(L.result)},U.onabort=function(){r.fail(new Error("Aborted to read the compressed image with FileReader."))},U.onerror=function(){r.fail(new Error("Failed to read the compressed image with FileReader."))},U.onloadend=function(){r.reader=null},U.readAsArrayBuffer(O)}}else ue(O)}};b.toBlob?b.toBlob(le,s.mimeType,s.quality):le(ve(b.toDataURL(s.mimeType,s.quality)))}}},{key:"done",value:function(t){var r=t.naturalWidth,i=t.naturalHeight,n=t.result,u=this.file,o=this.image,l=this.options;if(x&&o.src.indexOf("blob:")===0&&x.revokeObjectURL(o.src),n)if(l.strict&&!l.retainExif&&n.size>u.size&&l.mimeType===u.type&&!(l.width>r||l.height>i||l.minWidth>r||l.minHeight>i||l.maxWidth<r||l.maxHeight<i))n=u;else{var f=new Date;n.lastModified=f.getTime(),n.lastModifiedDate=f,n.name=u.name,n.name&&n.type!==u.type&&(n.name=n.name.replace(Ye,Se(n.type)))}else n=u;this.result=n,l.success&&l.success.call(this,n)}},{key:"fail",value:function(t){var r=this.options;if(r.error)r.error.call(this,t);else throw t}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=$e,a}},{key:"setDefaults",value:function(t){C(me,t)}}]),a}();const Ke={class:"content"},Ze={class:"width50"},Je={style:{"margin-top":"1rem"}},Qe={for:"qualitySlider"},et=["src"],tt={key:1},rt={__name:"ImgCompress",setup(a){const e=H(null),t=H(null),r=H(.6),i=()=>{if(!e.value){console.log("No file to compress");return}new qe(e.value,{quality:parseFloat(r.value),success(u){console.log("Compression successful");const o=new FileReader;o.onloadend=()=>{t.value=o.result,console.log("Compressed image URL:",o.result)},o.readAsDataURL(u)},error(u){console.error("Compression failed:",u.message)}})},n=()=>{const u=document.createElement("a");u.href=t.value,u.download="qrcode.png",u.click(),u.remove()};return Te(()=>{const u=document.getElementById("dropZone"),o=document.getElementById("fileInput");["dragenter","dragover","dragleave","drop"].forEach(c=>{u.addEventListener(c,l,!1)});function l(c){c.preventDefault(),c.stopPropagation()}["dragenter","dragover"].forEach(c=>{u.addEventListener(c,()=>u.classList.add("hover"),!1)}),["dragleave","drop"].forEach(c=>{u.addEventListener(c,()=>u.classList.remove("hover"),!1)}),u.addEventListener("click",()=>o.click(),!1),o.addEventListener("change",f,!1),u.addEventListener("drop",f,!1);function f(c){let h=c.dataTransfer,v=h?h.files:o.files;v.length>0&&(console.log(v),e.value=v[0],console.log("Selected file:",v[0].name),t.value=null,i())}}),(u,o)=>(_(),z("section",Ke,[y("div",Ze,[o[2]||(o[2]=y("h1",null,"图片压缩",-1)),o[3]||(o[3]=y("div",{id:"dropZone"},[N("将文件拖放到此处"),y("br"),N("或点击选择文件 "),y("input",{type:"file",style:{display:"none"},id:"fileInput"})],-1)),y("div",Je,[y("label",Qe,[o[1]||(o[1]=N("选择压缩质量 (0.1 - 1.0)。 ")),y("span",null,"当前："+Ae(r.value),1)]),De(y("input",{id:"qualitySlider",type:"range","onUpdate:modelValue":o[0]||(o[0]=l=>r.value=l),min:"0.1",max:"1.0",step:"0.1"},null,512),[[Oe,r.value]])]),t.value?(_(),z("img",{key:0,class:"codeImage",src:t.value,onClick:n,alt:"",style:{width:"100px",height:"100px"}},null,8,et)):ce("",!0),t.value?(_(),z("p",tt,"点击图片下载")):ce("",!0)])]))}},nt=Re(rt,[["__scopeId","data-v-6f392683"]]);export{nt as default};
