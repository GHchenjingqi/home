import{s as i,i as E,q as G,c as p,a as H,x as S,f as I,w as P,u as W,y as B,g as a,t as f,H as $,F as L,D as j,o as v,n as q}from"./vue-vendor-C-eO5OHd.js";import{u as J,L as O,l as K}from"./Loading-C_ZJTo4K.js";import{_ as Q}from"./index-k_b31qc0.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./three-vendor-FOuzmdZG.js";import"./loading-Dwx6fc8s.js";import"http://115.190.117.177:10086/mds/pathList.js";const R={class:"upload-box"},X={key:0,class:"ani-box"},Y={class:"ani-tag"},Z=["onClick"],ee={__name:"Test",setup(ne){let g=null,l=null,_=null,d=null,u=i(null);const U=async({THREE:t,scene:n,camera:o,axesHelper:s,stats:r})=>{g=n,d=t,r.dom.style.top=0,r.dom.style.left=0,_=new t.Clock},D=({controls:t,scene:n,camera:o,renderer:s,stats:r,gridHelper:e})=>{if(r?.update(),t?.update(),s?.render(n,o),l){const c=_.getDelta();l.update(c)}},h=i(!1),k=i(null);function F(t){const n=t.target.files[0];if(n&&n.name.toLowerCase().endsWith(".glb")){const o=new FileReader;o.onload=async function(s){const r=s.target.result;h.value=!0;let e=await K(r);if("scene"in e){let c=e.scene;k.value={scene:e.scene,animations:e.animations},g.add(c),e.animations.length>0&&(l=new d.AnimationMixer(c),e.animations.forEach(function(z){l.clipAction(z).play()})),e.animations&&e.animations.length>0&&(l=new d.AnimationMixer(c),m.value=e.animations.length,b.value=e.animations,u.value=l.clipAction(e.animations[0]),C.value=e.animations[0].name,confirm(`检测到${m.value}个动画，是否播放第一个？`)&&w())}},o.readAsArrayBuffer(n)}else alert("请选择一个 .glb 格式的文件")}const y=i(!1),M=()=>{y.value=!y.value},m=i(0),b=i([]),x=i(0),C=i(""),w=()=>{u.value.play()};function A(){u.value.stop()}function N(t){A(),x.value=t,u.value=l.clipAction(b.value[t]),w()}const{loading:T}=J({el:"#canvas",background:"#333333",cameraPosition:[4,2.5,-6],control:!0,controlAutoSpeed:!1,helper:!0,light:!0,showStats:!0,creatMesh:U,animation:D});return E(()=>{document.getElementById("glbUploader")?.addEventListener("change",F,!1)}),G(()=>{g=null,l=null,_=null,d=null,u=null}),(t,n)=>(v(),p(L,null,[H(O,{loading:W(T)},{default:P(()=>[...n[0]||(n[0]=[a("div",{id:"canvas"},null,-1)])]),_:1},8,["loading"]),S(a("div",R,[...n[1]||(n[1]=[a("input",{type:"file",id:"glbUploader",accept:".glb"},null,-1),a("label",{for:"glbUploader"},"上传模型",-1)])],512),[[B,!h.value]]),S(a("div",{class:"object-box",style:$({width:y.value?"40vw":"20vw"}),onClick:M},[a("pre",null," "+f(JSON.stringify(k.value,null,4))+" ",1)],4),[[B,h.value]]),m.value?(v(),p("div",X,[a("h1",null,"共检测到"+f(m.value)+"个动画序列",1),a("div",Y,[(v(!0),p(L,null,j(b.value,(o,s)=>(v(),p("span",{class:q(x.value===s?"active":""),key:o.id,onClick:r=>N(s)},f(o.name),11,Z))),128))]),a("p",null,"正在播放："+f(C.value),1),a("p",null,[a("button",{onClick:w},"播放"),a("button",{onClick:A},"暂停")])])):I("",!0)],64))}},ce=Q(ee,[["__scopeId","data-v-f4d84090"]]);export{ce as default};
