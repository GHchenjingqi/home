import{E as $,V as R,C as H,u as T,L as ee}from"./Loading-DFVB7pqE.js";import{c as U,a as oe,b as X,d as te,e as ne}from"./creatMesh-o4PwuTpa.js";import{_ as re,a as ie,b as se,c as ce,w as le,d as a,u as Y}from"./index-B4xWM6pg.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./allscreen-BLpajn7o.js";import"./loading-BOZmDY10.js";const m=new $(0,0,0,"YXZ"),u=new R,ae={type:"change"},de={type:"lock"},fe={type:"unlock"},q=Math.PI/2;class me extends H{constructor(o,n=null){super(o,n),this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this._onMouseMove=ue.bind(this),this._onPointerlockChange=he.bind(this),this._onPointerlockError=pe.bind(this),this.domElement!==null&&this.connect()}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}getObject(){return console.warn("THREE.PointerLockControls: getObject() has been deprecated. Use controls.object instead."),this.object}getDirection(o){return o.set(0,0,-1).applyQuaternion(this.object.quaternion)}moveForward(o){if(this.enabled===!1)return;const n=this.object;u.setFromMatrixColumn(n.matrix,0),u.crossVectors(n.up,u),n.position.addScaledVector(u,o)}moveRight(o){if(this.enabled===!1)return;const n=this.object;u.setFromMatrixColumn(n.matrix,0),n.position.addScaledVector(u,o)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}}function ue(i){if(this.enabled===!1||this.isLocked===!1)return;const o=i.movementX||i.mozMovementX||i.webkitMovementX||0,n=i.movementY||i.mozMovementY||i.webkitMovementY||0,d=this.object;m.setFromQuaternion(d.quaternion),m.y-=o*.002*this.pointerSpeed,m.x-=n*.002*this.pointerSpeed,m.x=Math.max(q-this.maxPolarAngle,Math.min(q-this.minPolarAngle,m.x)),d.quaternion.setFromEuler(m),this.dispatchEvent(ae)}function he(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(de),this.isLocked=!0):(this.dispatchEvent(fe),this.isLocked=!1)}function pe(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}const ke={__name:"demo10",setup(i){let o=null,n=!1,d=!1,C=!1,P=!1,b=0,W=20,s=null,L=1,y=[],x=[],f=[];const O=({THREE:e,scene:r,camera:A,renderer:M})=>{let g=U({r:20,size:20,color:3368601});g.position.y=-.5,r.add(g);const V=new e.Group;[{size:[.5,.5,.5],position:[0,0,0],color:16711680},{size:[1,1,1],position:[6,0,0],color:65280},{size:[1,1,1],position:[-6,0,0],color:65535},{size:[1,1,1],position:[0,0,6],color:16776960},{size:[1,1,1],position:[0,0,-6],color:16711935}].forEach(l=>{const v=oe(l);V.add(v)}),r.add(V);let t=null,c=null,h=null,p=null,K=null,j=null,F=null,B=null;y=[{lineArr:[new e.Vector3(0,0,0),new e.Vector3(3,5,0),new e.Vector3(6,0,0)],startColor:16711680,endColor:65280},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(-3,5,0),new e.Vector3(-6,0,0)],startColor:16711680,endColor:65535},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,3),new e.Vector3(0,0,6)],startColor:16711680,endColor:16776977},{lineArr:[new e.Vector3(0,0,0),new e.Vector3(0,5,-3),new e.Vector3(0,0,-6)],startColor:16711680,endColor:16711935}],y.forEach((l,v)=>{let E=v+1;const{line:w,bufferGeometry:_}=X(l);r.add(w);const J=te({lineArr:l.lineArr,color:l.endColor,dashSize:.5,gapSize:.2});r.add(J),E==1&&(K=_,t=w),E==2&&(j=_,c=w),E==3&&(F=_,h=w),E==4&&(B=_,p=w)}),x=[t,c,h,p],f=[K,j,F,B];const I=U({r:.5,size:20,color:16711680,side:e.DoubleSide});I.position.set(0,-.4,0),r.add(I),s=new e.Group,[{r:2,circle:12,color:"#ff0000",position:[0,-.4,0]},{r:2,circle:12,color:"#00ff00",position:[6,-.4,0]},{r:2,circle:12,color:"#00ffff",position:[-6,-.4,0]},{r:2,circle:12,color:"#ffff11",position:[0,-.4,6]},{r:2,circle:12,color:"#ff00ff",position:[0,-.4,-6]}].forEach(l=>{let v=ne(l);s.add(v)}),r.add(s),o=new me(A,M.domElement),r.add(o.object);const k=document.getElementById("box"),z=function(){o.lock()};k.addEventListener("click",z),document.addEventListener("pointerlockchange",function(){document.pointerLockElement===canvas?console.log("Pointer locked"):console.log("Pointer unlocked")},!1),document.addEventListener("pointerlockerror",function(){console.error("Pointer lock failed")}),o.addEventListener("lock",function(){k.style.display="none",k.removeEventListener("click",z)}),o.addEventListener("unlock",function(){k.style.display="block",k.addEventListener("click",z)}),document.addEventListener("keydown",S),document.addEventListener("keyup",G)},S=function(e){switch(e.code){case"ArrowUp":case"KeyW":n=!0;break;case"ArrowLeft":case"KeyA":C=!0;break;case"ArrowDown":case"KeyS":d=!0;break;case"ArrowRight":case"KeyD":P=!0;break}},G=function(e){switch(e.code){case"ArrowUp":case"KeyW":n=!1;break;case"ArrowLeft":case"KeyA":C=!1;break;case"ArrowDown":case"KeyS":d=!1;break;case"ArrowRight":case"KeyD":P=!1;break}},Q=({THREE:e,scene:r,camera:A,renderer:M,stats:g})=>{var D;if(o.isLocked){const t=new e.Vector3;n&&(t.z+=1),d&&(t.z-=1),C&&(t.x-=1),P&&(t.x+=1),o.moveForward(.1*t.z),o.moveRight(.1*t.x)}b<=99?(b+=1,y.forEach((t,c)=>{var p;const{bufferGeometry:h}=X({...t,index:b,num:W});x[c]&&((p=f[c])==null||p.dispose(),x[c].geometry=h,f[c]=h)})):b=0,((D=s==null?void 0:s.children)==null?void 0:D.length)>0&&s.children.forEach(t=>{t.material.opacity<=0?(t.material.opacity=1,L=1):(t.material.opacity+=-.01,L+=.003),t.scale.x=L,t.scale.y=L}),M.render(r,A),g.update()},{loading:N,pregress:Z}=T({el:"#canvas",background:"#333333",cameraPosition:[0,4,10],control:!1,helper:!1,light:!0,creatMesh:O,animation:Q});return ie(()=>{o=null,y=[],x=[],f.length>0&&f.forEach(e=>{e.dispose()}),f=null,document.removeEventListener("keydown",S),document.removeEventListener("keyup",G)}),(e,r)=>(se(),ce(ee,{loading:Y(N),pregress:Y(Z)},{default:le(()=>r[0]||(r[0]=[a("canvas",{id:"canvas"},null,-1),a("div",{id:"box"},[a("div",{class:"box"},[a("p",null,[a("b",null,"开始体验")]),a("p",null,"请按键盘： W/A/S/D，配合鼠标控制方向哦！"),a("p",null,"ESC 退出")])],-1)])),_:1},8,["loading","pregress"]))}},_e=re(ke,[["__scopeId","data-v-7550f21c"]]);export{_e as default};
