import{O as jn,G as Nn,S as lt,a as ut,b as at,M as ft,c as ct,d as st,V as pt,B as ht,e as vt,u as gt,L as dt}from"./Loading-DX6OrYVO.js";import{a as yt,e as St,c as An,d as Et}from"./creatMesh-BajgRTpm.js";import"./transform-DlOzM7pa.js";import{u as mt,c as wt}from"./useLabel-BOR4YOkF.js";import{u as Mt}from"./useRay-Bypgdpj1.js";import{_ as Pt,e as xt,a as It,c as Lt,b as Gt,w as zt,u as Rn,d as yn}from"./index-DpGVNEm0.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./allscreen-Ccov-lO2.js";import"./loading-Vx-oxiet.js";import"https://ghchenjingqi.github.io/resources/mds/pathList.js";class _t{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const u=i[r],f=t+u,c=Math.abs(t)<Math.abs(u)?t-(f-u):u-(f-t);c&&(i[e++]=c),t=f}return i[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let i=this._n,e,r,u,f=0;if(i>0){for(f=t[--i];i>0&&(e=f,r=t[--i],f=e+r,u=r-(f-e),!u););i>0&&(u<0&&t[i-1]<0||u>0&&t[i-1]>0)&&(r=u*2,e=f+r,r==e-f&&(f=e))}return f}}function*Ct(n){for(const t of n)yield*t}function kn(n){return Array.from(Ct(n))}var O=1e-6,N=Math.PI,Z=N/2,Bn=N/4,$=N*2,F=180/N,q=N/180,D=Math.abs,bn=Math.atan,tn=Math.atan2,X=Math.cos,Nt=Math.exp,At=Math.log,Y=Math.sin,Rt=Math.sign||function(n){return n>0?1:n<0?-1:0},gn=Math.sqrt,Bt=Math.tan;function Ot(n){return n>1?0:n<-1?N:Math.acos(n)}function en(n){return n>1?Z:n<-1?-Z:Math.asin(n)}function b(){}function sn(n,t){n&&Dn.hasOwnProperty(n.type)&&Dn[n.type](n,t)}var On={Feature:function(n,t){sn(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,e=-1,r=i.length;++e<r;)sn(i[e].geometry,t)}},Dn={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)n=i[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){mn(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)mn(i[e],t,0)},Polygon:function(n,t){Tn(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,e=-1,r=i.length;++e<r;)Tn(i[e],t)},GeometryCollection:function(n,t){for(var i=n.geometries,e=-1,r=i.length;++e<r;)sn(i[e],t)}};function mn(n,t,i){var e=-1,r=n.length-i,u;for(t.lineStart();++e<r;)u=n[e],t.point(u[0],u[1],u[2]);t.lineEnd()}function Tn(n,t){var i=-1,e=n.length;for(t.polygonStart();++i<e;)mn(n[i],t,1);t.polygonEnd()}function Dt(n,t){n&&On.hasOwnProperty(n.type)?On[n.type](n,t):sn(n,t)}function wn(n){return[tn(n[1],n[0]),en(n[2])]}function Q(n){var t=n[0],i=n[1],e=X(i);return[e*X(t),e*Y(t),Y(i)]}function ln(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function pn(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Sn(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function un(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Mn(n){var t=gn(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Pn(n,t){function i(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(i.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),i}function xn(n,t){return D(n)>N&&(n-=Math.round(n/$)*$),[n,t]}xn.invert=xn;function nt(n,t,i){return(n%=$)?t||i?Pn(Yn(n),qn(t,i)):Yn(n):t||i?qn(t,i):xn}function Xn(n){return function(t,i){return t+=n,D(t)>N&&(t-=Math.round(t/$)*$),[t,i]}}function Yn(n){var t=Xn(n);return t.invert=Xn(-n),t}function qn(n,t){var i=X(n),e=Y(n),r=X(t),u=Y(t);function f(c,v){var h=X(v),o=X(c)*h,l=Y(c)*h,a=Y(v),p=a*i+o*e;return[tn(l*r-p*u,o*i-a*e),en(p*r+l*u)]}return f.invert=function(c,v){var h=X(v),o=X(c)*h,l=Y(c)*h,a=Y(v),p=a*r-l*u;return[tn(l*r+a*u,o*i+p*e),en(p*i-o*e)]},f}function Tt(n){n=nt(n[0]*q,n[1]*q,n.length>2?n[2]*q:0);function t(i){return i=n(i[0]*q,i[1]*q),i[0]*=F,i[1]*=F,i}return t.invert=function(i){return i=n.invert(i[0]*q,i[1]*q),i[0]*=F,i[1]*=F,i},t}function Xt(n,t,i,e,r,u){if(i){var f=X(t),c=Y(t),v=e*i;r==null?(r=t+e*$,u=t-v/2):(r=Vn(f,r),u=Vn(f,u),(e>0?r<u:r>u)&&(r+=e*$));for(var h,o=r;e>0?o>u:o<u;o-=v)h=wn([f,-c*X(o),-c*Y(o)]),n.point(h[0],h[1])}}function Vn(n,t){t=Q(t),t[0]-=n,Mn(t);var i=Ot(-t[1]);return((-t[2]<0?-i:i)+$-O)%$}function tt(){var n=[],t;return{point:function(i,e,r){t.push([i,e,r])},lineStart:function(){n.push(t=[])},lineEnd:b,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var i=n;return n=[],t=null,i}}}function cn(n,t){return D(n[0]-t[0])<O&&D(n[1]-t[1])<O}function an(n,t,i,e){this.x=n,this.z=t,this.o=i,this.e=e,this.v=!1,this.n=this.p=null}function et(n,t,i,e,r){var u=[],f=[],c,v;if(n.forEach(function(g){if(!((x=g.length-1)<=0)){var x,d=g[0],_=g[x],w;if(cn(d,_)){if(!d[2]&&!_[2]){for(r.lineStart(),c=0;c<x;++c)r.point((d=g[c])[0],d[1]);r.lineEnd();return}_[0]+=2*O}u.push(w=new an(d,g,null,!0)),f.push(w.o=new an(d,null,w,!1)),u.push(w=new an(_,g,null,!1)),f.push(w.o=new an(_,null,w,!0))}}),!!u.length){for(f.sort(t),Zn(u),Zn(f),c=0,v=f.length;c<v;++c)f[c].e=i=!i;for(var h=u[0],o,l;;){for(var a=h,p=!0;a.v;)if((a=a.n)===h)return;o=a.z,r.lineStart();do{if(a.v=a.o.v=!0,a.e){if(p)for(c=0,v=o.length;c<v;++c)r.point((l=o[c])[0],l[1]);else e(a.x,a.n.x,1,r);a=a.n}else{if(p)for(o=a.p.z,c=o.length-1;c>=0;--c)r.point((l=o[c])[0],l[1]);else e(a.x,a.p.x,-1,r);a=a.p}a=a.o,o=a.z,p=!p}while(!a.v);r.lineEnd()}}}function Zn(n){if(t=n.length){for(var t,i=0,e=n[0],r;++i<t;)e.n=r=n[i],r.p=e,e=r;e.n=r=n[0],r.p=e}}function En(n){return D(n[0])<=N?n[0]:Rt(n[0])*((D(n[0])+N)%$-N)}function Yt(n,t){var i=En(t),e=t[1],r=Y(e),u=[Y(i),-X(i),0],f=0,c=0,v=new _t;r===1?e=Z+O:r===-1&&(e=-Z-O);for(var h=0,o=n.length;h<o;++h)if(a=(l=n[h]).length)for(var l,a,p=l[a-1],g=En(p),x=p[1]/2+Bn,d=Y(x),_=X(x),w=0;w<a;++w,g=E,d=z,_=R,p=I){var I=l[w],E=En(I),G=I[1]/2+Bn,z=Y(G),R=X(G),S=E-g,m=S>=0?1:-1,L=m*S,y=L>N,A=d*z;if(v.add(tn(A*m*Y(L),_*R+A*X(L))),f+=y?S+m*$:S,y^g>=i^E>=i){var C=pn(Q(p),Q(I));Mn(C);var M=pn(u,C);Mn(M);var s=(y^S>=0?-1:1)*en(M[2]);(e>s||e===s&&(C[0]||C[1]))&&(c+=y^S>=0?1:-1)}}return(f<-O||f<O&&v<-1e-12)^c&1}function it(n,t,i,e){return function(r){var u=t(r),f=tt(),c=t(f),v=!1,h,o,l,a={point:p,lineStart:x,lineEnd:d,polygonStart:function(){a.point=_,a.lineStart=w,a.lineEnd=I,o=[],h=[]},polygonEnd:function(){a.point=p,a.lineStart=x,a.lineEnd=d,o=kn(o);var E=Yt(h,e);o.length?(v||(r.polygonStart(),v=!0),et(o,Vt,E,i,r)):E&&(v||(r.polygonStart(),v=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),v&&(r.polygonEnd(),v=!1),o=h=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function p(E,G){n(E,G)&&r.point(E,G)}function g(E,G){u.point(E,G)}function x(){a.point=g,u.lineStart()}function d(){a.point=p,u.lineEnd()}function _(E,G){l.push([E,G]),c.point(E,G)}function w(){c.lineStart(),l=[]}function I(){_(l[0][0],l[0][1]),c.lineEnd();var E=c.clean(),G=f.result(),z,R=G.length,S,m,L;if(l.pop(),h.push(l),l=null,!!R){if(E&1){if(m=G[0],(S=m.length-1)>0){for(v||(r.polygonStart(),v=!0),r.lineStart(),z=0;z<S;++z)r.point((L=m[z])[0],L[1]);r.lineEnd()}return}R>1&&E&2&&G.push(G.pop().concat(G.shift())),o.push(G.filter(qt))}}return a}}function qt(n){return n.length>1}function Vt(n,t){return((n=n.x)[0]<0?n[1]-Z-O:Z-n[1])-((t=t.x)[0]<0?t[1]-Z-O:Z-t[1])}const Fn=it(function(){return!0},Zt,$t,[-N,-Z]);function Zt(n){var t=NaN,i=NaN,e=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(u,f){var c=u>0?N:-N,v=D(u-t);D(v-N)<O?(n.point(t,i=(i+f)/2>0?Z:-Z),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(c,i),n.point(u,i),r=0):e!==c&&v>=N&&(D(t-e)<O&&(t-=e*O),D(u-c)<O&&(u-=c*O),i=Ft(t,i,u,f),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(c,i),r=0),n.point(t=u,i=f),e=c},lineEnd:function(){n.lineEnd(),t=i=NaN},clean:function(){return 2-r}}}function Ft(n,t,i,e){var r,u,f=Y(n-i);return D(f)>O?bn((Y(t)*(u=X(e))*Y(i)-Y(e)*(r=X(t))*Y(n))/(r*u*f)):(t+e)/2}function $t(n,t,i,e){var r;if(n==null)r=i*Z,e.point(-N,r),e.point(0,r),e.point(N,r),e.point(N,0),e.point(N,-r),e.point(0,-r),e.point(-N,-r),e.point(-N,0),e.point(-N,r);else if(D(n[0]-t[0])>O){var u=n[0]<t[0]?N:-N;r=i*u/2,e.point(-u,r),e.point(0,r),e.point(u,r)}else e.point(t[0],t[1])}function Ht(n){var t=X(n),i=2*q,e=t>0,r=D(t)>O;function u(o,l,a,p){Xt(p,n,i,a,o,l)}function f(o,l){return X(o)*X(l)>t}function c(o){var l,a,p,g,x;return{lineStart:function(){g=p=!1,x=1},point:function(d,_){var w=[d,_],I,E=f(d,_),G=e?E?0:h(d,_):E?h(d+(d<0?N:-N),_):0;if(!l&&(g=p=E)&&o.lineStart(),E!==p&&(I=v(l,w),(!I||cn(l,I)||cn(w,I))&&(w[2]=1)),E!==p)x=0,E?(o.lineStart(),I=v(w,l),o.point(I[0],I[1])):(I=v(l,w),o.point(I[0],I[1],2),o.lineEnd()),l=I;else if(r&&l&&e^E){var z;!(G&a)&&(z=v(w,l,!0))&&(x=0,e?(o.lineStart(),o.point(z[0][0],z[0][1]),o.point(z[1][0],z[1][1]),o.lineEnd()):(o.point(z[1][0],z[1][1]),o.lineEnd(),o.lineStart(),o.point(z[0][0],z[0][1],3)))}E&&(!l||!cn(l,w))&&o.point(w[0],w[1]),l=w,p=E,a=G},lineEnd:function(){p&&o.lineEnd(),l=null},clean:function(){return x|(g&&p)<<1}}}function v(o,l,a){var p=Q(o),g=Q(l),x=[1,0,0],d=pn(p,g),_=ln(d,d),w=d[0],I=_-w*w;if(!I)return!a&&o;var E=t*_/I,G=-t*w/I,z=pn(x,d),R=un(x,E),S=un(d,G);Sn(R,S);var m=z,L=ln(R,m),y=ln(m,m),A=L*L-y*(ln(R,R)-1);if(!(A<0)){var C=gn(A),M=un(m,(-L-C)/y);if(Sn(M,R),M=wn(M),!a)return M;var s=o[0],P=l[0],B=o[1],T=l[1],V;P<s&&(V=s,s=P,P=V);var k=P-s,H=D(k-N)<O,W=H||k<O;if(!H&&T<B&&(V=B,B=T,T=V),W?H?B+T>0^M[1]<(D(M[0]-s)<O?B:T):B<=M[1]&&M[1]<=T:k>N^(s<=M[0]&&M[0]<=P)){var J=un(m,(-L+C)/y);return Sn(J,R),[M,wn(J)]}}}function h(o,l){var a=e?n:N-n,p=0;return o<-a?p|=1:o>a&&(p|=2),l<-a?p|=4:l>a&&(p|=8),p}return it(f,c,u,e?[0,-n]:[-N,n-N])}function Jt(n,t,i,e,r,u){var f=n[0],c=n[1],v=t[0],h=t[1],o=0,l=1,a=v-f,p=h-c,g;if(g=i-f,!(!a&&g>0)){if(g/=a,a<0){if(g<o)return;g<l&&(l=g)}else if(a>0){if(g>l)return;g>o&&(o=g)}if(g=r-f,!(!a&&g<0)){if(g/=a,a<0){if(g>l)return;g>o&&(o=g)}else if(a>0){if(g<o)return;g<l&&(l=g)}if(g=e-c,!(!p&&g>0)){if(g/=p,p<0){if(g<o)return;g<l&&(l=g)}else if(p>0){if(g>l)return;g>o&&(o=g)}if(g=u-c,!(!p&&g<0)){if(g/=p,p<0){if(g>l)return;g>o&&(o=g)}else if(p>0){if(g<o)return;g<l&&(l=g)}return o>0&&(n[0]=f+o*a,n[1]=c+o*p),l<1&&(t[0]=f+l*a,t[1]=c+l*p),!0}}}}}var nn=1e9,fn=-nn;function Wt(n,t,i,e){function r(h,o){return n<=h&&h<=i&&t<=o&&o<=e}function u(h,o,l,a){var p=0,g=0;if(h==null||(p=f(h,l))!==(g=f(o,l))||v(h,o)<0^l>0)do a.point(p===0||p===3?n:i,p>1?e:t);while((p=(p+l+4)%4)!==g);else a.point(o[0],o[1])}function f(h,o){return D(h[0]-n)<O?o>0?0:3:D(h[0]-i)<O?o>0?2:1:D(h[1]-t)<O?o>0?1:0:o>0?3:2}function c(h,o){return v(h.x,o.x)}function v(h,o){var l=f(h,1),a=f(o,1);return l!==a?l-a:l===0?o[1]-h[1]:l===1?h[0]-o[0]:l===2?h[1]-o[1]:o[0]-h[0]}return function(h){var o=h,l=tt(),a,p,g,x,d,_,w,I,E,G,z,R={point:S,lineStart:A,lineEnd:C,polygonStart:L,polygonEnd:y};function S(s,P){r(s,P)&&o.point(s,P)}function m(){for(var s=0,P=0,B=p.length;P<B;++P)for(var T=p[P],V=1,k=T.length,H=T[0],W,J,on=H[0],U=H[1];V<k;++V)W=on,J=U,H=T[V],on=H[0],U=H[1],J<=e?U>e&&(on-W)*(e-J)>(U-J)*(n-W)&&++s:U<=e&&(on-W)*(e-J)<(U-J)*(n-W)&&--s;return s}function L(){o=l,a=[],p=[],z=!0}function y(){var s=m(),P=z&&s,B=(a=kn(a)).length;(P||B)&&(h.polygonStart(),P&&(h.lineStart(),u(null,null,1,h),h.lineEnd()),B&&et(a,c,s,u,h),h.polygonEnd()),o=h,a=p=g=null}function A(){R.point=M,p&&p.push(g=[]),G=!0,E=!1,w=I=NaN}function C(){a&&(M(x,d),_&&E&&l.rejoin(),a.push(l.result())),R.point=S,E&&o.lineEnd()}function M(s,P){var B=r(s,P);if(p&&g.push([s,P]),G)x=s,d=P,_=B,G=!1,B&&(o.lineStart(),o.point(s,P));else if(B&&E)o.point(s,P);else{var T=[w=Math.max(fn,Math.min(nn,w)),I=Math.max(fn,Math.min(nn,I))],V=[s=Math.max(fn,Math.min(nn,s)),P=Math.max(fn,Math.min(nn,P))];Jt(T,V,n,t,i,e)?(E||(o.lineStart(),o.point(T[0],T[1])),o.point(V[0],V[1]),B||o.lineEnd(),z=!1):B&&(o.lineStart(),o.point(s,P),z=!1)}w=s,I=P,E=B}return R}}const $n=n=>n;var j=1/0,hn=j,rn=-j,vn=rn,Hn={point:Ut,lineStart:b,lineEnd:b,polygonStart:b,polygonEnd:b,result:function(){var n=[[j,hn],[rn,vn]];return rn=vn=-(hn=j=1/0),n}};function Ut(n,t){n<j&&(j=n),n>rn&&(rn=n),t<hn&&(hn=t),t>vn&&(vn=t)}function zn(n){return function(t){var i=new In;for(var e in n)i[e]=n[e];return i.stream=t,i}}function In(){}In.prototype={constructor:In,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _n(n,t,i){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),Dt(i,n.stream(Hn)),t(Hn.result()),e!=null&&n.clipExtent(e),n}function rt(n,t,i){return _n(n,function(e){var r=t[1][0]-t[0][0],u=t[1][1]-t[0][1],f=Math.min(r/(e[1][0]-e[0][0]),u/(e[1][1]-e[0][1])),c=+t[0][0]+(r-f*(e[1][0]+e[0][0]))/2,v=+t[0][1]+(u-f*(e[1][1]+e[0][1]))/2;n.scale(150*f).translate([c,v])},i)}function Kt(n,t,i){return rt(n,[[0,0],t],i)}function Qt(n,t,i){return _n(n,function(e){var r=+t,u=r/(e[1][0]-e[0][0]),f=(r-u*(e[1][0]+e[0][0]))/2,c=-u*e[0][1];n.scale(150*u).translate([f,c])},i)}function jt(n,t,i){return _n(n,function(e){var r=+t,u=r/(e[1][1]-e[0][1]),f=-u*e[0][0],c=(r-u*(e[1][1]+e[0][1]))/2;n.scale(150*u).translate([f,c])},i)}var Jn=16,kt=X(30*q);function Wn(n,t){return+t?ne(n,t):bt(n)}function bt(n){return zn({point:function(t,i){t=n(t,i),this.stream.point(t[0],t[1])}})}function ne(n,t){function i(e,r,u,f,c,v,h,o,l,a,p,g,x,d){var _=h-e,w=o-r,I=_*_+w*w;if(I>4*t&&x--){var E=f+a,G=c+p,z=v+g,R=gn(E*E+G*G+z*z),S=en(z/=R),m=D(D(z)-1)<O||D(u-l)<O?(u+l)/2:tn(G,E),L=n(m,S),y=L[0],A=L[1],C=y-e,M=A-r,s=w*C-_*M;(s*s/I>t||D((_*C+w*M)/I-.5)>.3||f*a+c*p+v*g<kt)&&(i(e,r,u,f,c,v,y,A,m,E/=R,G/=R,z,x,d),d.point(y,A),i(y,A,m,E,G,z,h,o,l,a,p,g,x,d))}}return function(e){var r,u,f,c,v,h,o,l,a,p,g,x,d={point:_,lineStart:w,lineEnd:E,polygonStart:function(){e.polygonStart(),d.lineStart=G},polygonEnd:function(){e.polygonEnd(),d.lineStart=w}};function _(S,m){S=n(S,m),e.point(S[0],S[1])}function w(){l=NaN,d.point=I,e.lineStart()}function I(S,m){var L=Q([S,m]),y=n(S,m);i(l,a,o,p,g,x,l=y[0],a=y[1],o=S,p=L[0],g=L[1],x=L[2],Jn,e),e.point(l,a)}function E(){d.point=_,e.lineEnd()}function G(){w(),d.point=z,d.lineEnd=R}function z(S,m){I(r=S,m),u=l,f=a,c=p,v=g,h=x,d.point=I}function R(){i(l,a,o,p,g,x,u,f,r,c,v,h,Jn,e),d.lineEnd=E,E()}return d}}var te=zn({point:function(n,t){this.stream.point(n*q,t*q)}});function ee(n){return zn({point:function(t,i){var e=n(t,i);return this.stream.point(e[0],e[1])}})}function ie(n,t,i,e,r){function u(f,c){return f*=e,c*=r,[t+n*f,i-n*c]}return u.invert=function(f,c){return[(f-t)/n*e,(i-c)/n*r]},u}function Un(n,t,i,e,r,u){if(!u)return ie(n,t,i,e,r);var f=X(u),c=Y(u),v=f*n,h=c*n,o=f/n,l=c/n,a=(c*i-f*t)/n,p=(c*t+f*i)/n;function g(x,d){return x*=e,d*=r,[v*x-h*d+t,i-h*x-v*d]}return g.invert=function(x,d){return[e*(o*x-l*d+a),r*(p-l*x-o*d)]},g}function re(n){return oe(function(){return n})()}function oe(n){var t,i=150,e=480,r=250,u=0,f=0,c=0,v=0,h=0,o,l=0,a=1,p=1,g=null,x=Fn,d=null,_,w,I,E=$n,G=.5,z,R,S,m,L;function y(s){return S(s[0]*q,s[1]*q)}function A(s){return s=S.invert(s[0],s[1]),s&&[s[0]*F,s[1]*F]}y.stream=function(s){return m&&L===s?m:m=te(ee(o)(x(z(E(L=s)))))},y.preclip=function(s){return arguments.length?(x=s,g=void 0,M()):x},y.postclip=function(s){return arguments.length?(E=s,d=_=w=I=null,M()):E},y.clipAngle=function(s){return arguments.length?(x=+s?Ht(g=s*q):(g=null,Fn),M()):g*F},y.clipExtent=function(s){return arguments.length?(E=s==null?(d=_=w=I=null,$n):Wt(d=+s[0][0],_=+s[0][1],w=+s[1][0],I=+s[1][1]),M()):d==null?null:[[d,_],[w,I]]},y.scale=function(s){return arguments.length?(i=+s,C()):i},y.translate=function(s){return arguments.length?(e=+s[0],r=+s[1],C()):[e,r]},y.center=function(s){return arguments.length?(u=s[0]%360*q,f=s[1]%360*q,C()):[u*F,f*F]},y.rotate=function(s){return arguments.length?(c=s[0]%360*q,v=s[1]%360*q,h=s.length>2?s[2]%360*q:0,C()):[c*F,v*F,h*F]},y.angle=function(s){return arguments.length?(l=s%360*q,C()):l*F},y.reflectX=function(s){return arguments.length?(a=s?-1:1,C()):a<0},y.reflectY=function(s){return arguments.length?(p=s?-1:1,C()):p<0},y.precision=function(s){return arguments.length?(z=Wn(R,G=s*s),M()):gn(G)},y.fitExtent=function(s,P){return rt(y,s,P)},y.fitSize=function(s,P){return Kt(y,s,P)},y.fitWidth=function(s,P){return Qt(y,s,P)},y.fitHeight=function(s,P){return jt(y,s,P)};function C(){var s=Un(i,0,0,a,p,l).apply(null,t(u,f)),P=Un(i,e-s[0],r-s[1],a,p,l);return o=nt(c,v,h),R=Pn(t,P),S=Pn(o,R),z=Wn(R,G),M()}function M(){return m=L=null,y}return function(){return t=n.apply(this,arguments),y.invert=t.invert&&A,C()}}function Cn(n,t){return[n,At(Bt((Z+t)/2))]}Cn.invert=function(n,t){return[n,2*bn(Nt(t))-Z]};function le(){return ue(Cn).scale(961/$)}function ue(n){var t=re(n),i=t.center,e=t.scale,r=t.translate,u=t.clipExtent,f=null,c,v,h;t.scale=function(l){return arguments.length?(e(l),o()):e()},t.translate=function(l){return arguments.length?(r(l),o()):r()},t.center=function(l){return arguments.length?(i(l),o()):i()},t.clipExtent=function(l){return arguments.length?(l==null?f=c=v=h=null:(f=+l[0][0],c=+l[0][1],v=+l[1][0],h=+l[1][1]),o()):f==null?null:[[f,c],[v,h]]};function o(){var l=N*e(),a=t(Tt(t.rotate()).invert([0,0]));return u(f==null?[[a[0]-l,a[1]-l],[a[0]+l,a[1]+l]]:n===Cn?[[Math.max(a[0]-l,f),c],[Math.min(a[0]+l,v),h]]:[[f,Math.max(a[1]-l,c)],[v,Math.min(a[1]+l,h)]])}return o()}let Ln=null,dn,K,Gn,ot=null;const ae=async({mapJson:n,lineColor:t,color:i,depth:e,mapLabel:r,canvasbox:u,pointColor:f})=>{if(n)return dn=le().center([109,34.5]).scale(1e3).translate([0,0]),K=new jn,r&&(Gn=new Nn,Ln=new Nn,ot=await mt({labelBox:r,canvasbox:u})),await fe(n,i,t,e,r,f)},fe=async(n,t,i,e,r,u)=>(n.features.forEach(c=>{const v=new jn;v.properties=c.properties.name,v.name=c.properties.name,K.name=c.properties.name;const h=c.geometry.coordinates;if(c.geometry.type==="MultiPolygon"&&h.forEach(o=>{o.forEach(l=>{const a=Kn(l,t,e);a.properties=c.properties.name;const p=Qn(l,i,e);v.add(a),v.add(p)})}),c.geometry.type==="Polygon"&&h.forEach(o=>{const l=Kn(o,t,e);l.properties=c.properties.name;const a=Qn(o,i,e);v.add(l),v.add(a)}),r&&c.properties.name){const{center:o,centroid:l,name:a}=c.properties,[p,g]=dn(l||o),x=wt(a,"#fff",{x:p,y:-g,z:0});Gn.add(x);const d=yt({r:1,size:36,color:u});d.position.set(p,-g,e+1.1),d.rotation.x=Math.PI,d.name="point",v.pointPosition=[p,-g,e],Ln.add(d)}K.add(v)}),K.add(Gn),K.add(Ln),{mapContainer:K,labelRenderer:ot}),Kn=(n,t,i)=>{const e=new lt;n.forEach((v,h)=>{const[o,l]=dn(v);h===0?e.moveTo(o,-l):e.lineTo(o,-l)});const r={steps:2,depth:i,bevelEnabled:!0,bevelThickness:1,bevelSize:1,bevelOffset:0,bevelSegments:1};let u=null;t=="random"?u=new ut(`hsl( 225, ${Math.random()*30+55}%, ${Math.random()*30+55}%)`).getHex():u=t;const f=new at(e,r),c=new ft({color:u,transparent:!0,opacity:.6});return new ct(f,c)},Qn=(n,t,i)=>{const e=new st({color:t}),r=[];n.forEach((f,c)=>{const[v,h]=dn(f);r.push(new pt(v,-h,i+1))});const u=new ht().setFromPoints(r);return new vt(u,e)},ce=async({mapJson:n,color:t="#d13a34",depth:i=8,lineColor:e="#ffffff",mapLabel:r=null,pointColor:u="#ffffff",canvasbox:f="canvas"})=>{let{mapContainer:c,labelRenderer:v}=await ae({mapJson:n,lineColor:e,color:t,depth:i,mapLabel:r,pointColor:u,canvasbox:f});return{mapMesh:c,labelRenderer:v}},se={__name:"demo11",setup(n){let t=null,i=null,e=null,r=1,u=null,f=null,c=null,v=null,h=[],o=0,l=20;const a={郑州市:"13000",开封市:"10000",洛阳市:"12000",平顶山市:"9000",安阳市:"8000",鹤壁市:"7000",新乡市:"6000",焦作市:"5000",濮阳市:"4000",许昌市:"3000",漯河市:"2000",三门峡市:"1000",南阳市:"900",商丘市:"800",信阳市:"700",周口市:"600",驻马店市:"500",济源市:"400"},p={x:78.14521484916168,y:2.6758705717486464,z:8},g=xt(()=>document.querySelector("#canvas").getBoundingClientRect()),x=async({THREE:S,scene:m,renderer:L,camera:y,control:A})=>{if(t=await(await fetch("https://ghchenjingqi.github.io/resources/json/henan.json")).json(),!t)return;c=new S.Group;const M={mapJson:t,mapLabel:"map",canvasbox:"canvas",color:"#13407d",pointColor:"#009fff"};let{mapMesh:s,labelRenderer:P}=await ce(M);s.rotation.x=-Math.PI/2,s.position.set(-8,0,-2),s.scale.set(.1,.1,.1),c.add(s),m.add(c),await d(s,m,S),i=P,I(S,y)},d=async(S,m,L)=>{e=new L.Group,u=new L.Group,f=new L.Group;let y=[];if(S.children&&S.children.length>0)for(let A=0;A<S.children.length;A++){let C=S.children[A].pointPosition;if(C){const[M,s,P]=C,B=St({r:3,circle:12,color:"#009fff",position:[M,s,P+1.1]});if(B.name="pointCircle",B.rotation.x=Math.PI*2,e.add(B),p.x!==M&&p.y!==s){const T=_([p.x,p.y,p.z],C,L);y.push(T)}}}e.position.set(-8,0,-2),e.scale.set(.1,.1,.1),e.rotation.x=-Math.PI/2,m.add(e),y.forEach((A,C)=>{const{line:M,bufferGeometry:s}=An(A);u.add(M);const P=Et({lineArr:A.lineArr,color:A.endColor,dashSize:.5,gapSize:.2});f.add(P),h.push({bufferGeometry:s,line:M,obj:A})}),u.position.set(-8,0,-2),u.scale.set(.1,.1,.1),u.rotation.x=-Math.PI/2,f.position.set(-8,0,-2),f.scale.set(.1,.1,.1),f.rotation.x=-Math.PI/2,m.add(u),m.add(f)},_=(S,m,L)=>{const[y,A,C]=m,[M,s,P]=S,B=new L.Vector3(y,A,C),T=new L.Vector3((y+M)/2,(A+s)/2,20),V=new L.Vector3(M,s,P);return{lineArr:[B,T,V],startColor:65280,endColor:40959}};let w=null;const I=(S,m)=>{const L=document.getElementById("tip");let y=[];w=async A=>{if(y.length)for(let C=0;C<y.length;C++)y[C].object.material.color.set(y[C].object.material.oldcolor);y=[],v=await Mt({el:"#canvas",camera:S,group:c,event:A}),v?.object?v.object.type==="Mesh"&&(v.object.material.hasOwnProperty("oldcolor")||(v.object.material.oldcolor=JSON.parse(JSON.stringify(v.object.material.color))),v.object.name!="point"&&(v.object.material.color.set(40959),y.push(v)),L.style.left=A.clientX-g.value.left+"px",L.style.top=A.clientY-g.value.top+"px",E(L,v.object)):L.style.visibility="hidden",y.length===0&&(L.style.visibility="hidden")},w&&m.domElement?.addEventListener("pointermove",w)},E=(S,m)=>{m.parent&&m.parent.properties?(S.textContent=m.parent.properties+"："+a[m.parent.properties],S.style.visibility="visible"):S.style.visibility="hidden"},G=({scene:S,camera:m,renderer:L,controls:y,stats:A,THREE:C})=>{t&&(e?.children?.length>0&&e.children.forEach(M=>{M.material.opacity<=0?(M.material.opacity=1,r=1):(M.material.opacity+=-.008,r+=3e-4),M.scale.x=r,M.scale.y=r}),o<=99?(o+=1,h.forEach(({obj:M,line:s,bufferGeometry:P},B)=>{const{bufferGeometry:T}=An({...M,index:o,num:l});h[B]&&(P?.dispose(),s.geometry=T,P=T)})):o=0,y.update(),L.render(S,m),A.update(),i&&i.render(S,m))},{loading:z,pregress:R}=gt({el:"#canvas",background:"#02284c",cameraPosition:[0,8,5],controlAuto:!1,helper:!1,light:!0,creatMesh:x,animation:G});return It(()=>{h.length>0&&h.forEach(S=>{S.bufferGeometry.dispose?.(),S.bufferGeometry=null}),i&&(i.dispose?.(),i=null),h=null,e=null,r=1,u=null,f=null,c=null}),(S,m)=>(Gt(),Lt(dt,{loading:Rn(z),pregress:Rn(R)},{default:zt(()=>[...m[0]||(m[0]=[yn("div",{id:"canvas"},null,-1),yn("div",{id:"map"},null,-1),yn("div",{id:"tip"},null,-1)])]),_:1},8,["loading","pregress"]))}},Pe=Pt(se,[["__scopeId","data-v-e21f171b"]]);export{Pe as default};
