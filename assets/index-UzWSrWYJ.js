import{_ as L,r as c,k as M,o as S,a as B,l as y,b as m,d as i,F as k,x as q,n as x,t as C,A as $,z as R,B as H,m as E,c as T,C as z,D as I,E as U,G as D}from"./index-BIF3Vx7O.js";import{N as j}from"./Notification-3iZQWiAq.js";import{h as G}from"./highlight.pack-DAfgiNWA.js";import"./_commonjsHelpers-Cpj98o6Y.js";const K={class:"sub-ml"},P=["onClick"],J=["id"],O={__name:"FolderMenu",props:{items:Array},setup(w){const f=c(""),_=w,p=c(!1),v=document.querySelector(".know-box"),t=c([]);M(()=>_.items,a=>{a&&a.length>0&&(t.value=a,t.value&&t.value.length>0&&(f.value=t.value[0].id))},{immediate:!0});const g=a=>{f.value=a.id,v.scrollTo({top:a.pixel,behavior:"smooth"})},u=c(null),h=()=>{let a=v.scrollTop+v.offsetTop+1+135;const r=t.value.reduce((o,e)=>e.pixel<=a&&(o===null||a-e.pixel<a-o.pixel)?e:o,null);if(r){let o=u.value.scrollHeight*r.pixel/v.scrollHeight-10;u.value.scrollTo({top:o,behavior:"smooth"}),f.value=r.id}p.value=!0},d=()=>{v.addEventListener("scroll",h,{passive:!0})};return S(()=>{t.value=_.items,u.value=document.querySelector(".sub-ml"),t.value&&t.value.length>0&&(f.value=t.value[0].id),d()}),B(()=>{p.value&&(v.removeEventListener("scroll",h),p.value=!1)}),(a,r)=>(m(),y(k,null,[r[0]||(r[0]=i("h3",{class:"sub-class"},"导航器",-1)),i("div",K,[i("ul",null,[(m(!0),y(k,null,q(t.value,o=>(m(),y("li",{key:o.id,class:x(o.class),onClick:e=>g(o)},[i("span",{id:o.id,class:x({active:f.value==o.id})},C(o.title),11,J)],10,P))),128))])])],64))}},V=L(O,[["__scopeId","data-v-824df357"]]),W=["title","onClick"],X={class:"content-box"},Y=["innerHTML"],Z={__name:"index",setup(w){const f=R(),_=U(),p=c([]),v=c(null),t=c(""),g=async l=>{if(l==t.value)return!1;d.value=-1,r.value=[],u.value&&(u.value.scrollTop=0),v.value=await z(l),t.value=l;let s=setTimeout(()=>{const n=document.querySelectorAll("pre code");n&&n.length>0&&n.forEach(b=>{G.highlightBlock(b)}),clearTimeout(s),o()},0)},u=c(null),h=c(!1),d=c(0),a=()=>{u.value.scrollTop>100?h.value=!0:h.value=!1},r=c([]),o=async()=>{const l=document.querySelector(".contenter");if(!l)return!1;d.value<0?d.value=Math.floor(Math.random()*1e3):d.value++,r.value=await I(l),F()},e=c({show:!1,message:"",type:""}),N=()=>{e.value.show=!1,e.value.message=""},A=async l=>{if(l)try{if(navigator.clipboard)await navigator.clipboard.writeText(l.innerText),e.value.message="复制成功",e.value.type="success";else{const s=document.createElement("input");s.value=l.innerText,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s),e.value.message="复制成功",e.value.type="success"}e.value.show=!0}catch{e.value.message="复制失败，请重试",e.value.type="error",e.value.show=!0}else e.value.message="未找到代码块",e.value.type="warning",e.value.show=!0},F=()=>{document.querySelectorAll("pre code").forEach(s=>{const n=document.createElement("button");n.className="copy-btn",n.textContent="复制代码",n.onclick=()=>A(s),s.parentElement.appendChild(n)})};return M(()=>_.query,async l=>{l&&l.name&&await g(l.name)}),S(()=>{u.value&&u.value.addEventListener("scroll",a)}),B(()=>{u.value&&u.value.removeEventListener("scroll",a)}),$(async()=>{const s=f.currentRoute.value.query.name||"";p.value=H(),p.value.length>0&&(s?await g(s):await g(p.value[0])),d.value=1001,o()}),(l,s)=>(m(),y("div",{class:"know-box",ref_key:"knowsElement",ref:u},[i("div",{class:x(["mulu",{"fixed-sidebar":h.value}])},[s[0]||(s[0]=i("div",{class:"ml-title"},[i("h4",null,"知识库")],-1)),i("ul",null,[(m(!0),y(k,null,q(p.value,(n,b)=>(m(),y("li",{style:D({color:n==t.value?"red":""}),key:b,title:n,onClick:Q=>g(n)},C(n.charAt(0).toUpperCase()+n.slice(1)),13,W))),128))])],2),i("div",X,[i("h1",null,C(t.value.charAt(0).toUpperCase()+t.value.slice(1)),1),i("div",{id:"codebox",class:"contenter",innerHTML:v.value},null,8,Y)]),d.value>0&&r.value.length>0?(m(),y("div",{key:0,class:x(["sub-mulu",{"fixed-sidebar":h.value}])},[(m(),T(V,{items:r.value,key:d.value},null,8,["items"]))],2)):E("",!0),e.value.show?(m(),T(j,{key:1,message:e.value.message,type:e.value.type,duration:3e3,onClosed:N},null,8,["message","type"])):E("",!0)],512))}},oe=L(Z,[["__scopeId","data-v-5b2ac8b4"]]);export{oe as default};
