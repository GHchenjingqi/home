import{s as r,A as L,i as M,q as S,c as p,o as v,g as u,F as x,D as q,n as k,t as C,h as $,E as H,f as E,e as T,G as R,H as I}from"./vue-vendor-C-eO5OHd.js";import{_ as B,g as U,d as z,e as D}from"./index-k_b31qc0.js";import{N as j}from"./Notification-kFUdJqKO.js";import{h as G}from"./highlight.pack-DAfgiNWA.js";import"http://115.190.117.177:10086/mds/pathList.js";import"./_commonjsHelpers-Cpj98o6Y.js";const K={class:"sub-ml"},P=["onClick"],J=["id"],O={__name:"FolderMenu",props:{items:Array},setup(w){const h=r(""),_=w,f=r(!1),d=document.querySelector(".know-box"),s=r([]);L(()=>_.items,a=>{a&&a.length>0&&(s.value=a,s.value&&s.value.length>0&&(h.value=s.value[0].id))},{immediate:!0});const g=a=>{h.value=a.id,d.scrollTo({top:a.pixel,behavior:"smooth"})},c=r(null),y=()=>{let a=d.scrollTop+d.offsetTop+1+135;const i=s.value.reduce((o,e)=>e.pixel<=a&&(o===null||a-e.pixel<a-o.pixel)?e:o,null);if(i){let o=c.value.scrollHeight*i.pixel/d.scrollHeight-10;c.value.scrollTo({top:o,behavior:"smooth"}),h.value=i.id}f.value=!0},m=()=>{d.addEventListener("scroll",y,{passive:!0})};return M(()=>{s.value=_.items,c.value=document.querySelector(".sub-ml"),s.value&&s.value.length>0&&(h.value=s.value[0].id),m()}),S(()=>{f.value&&(d.removeEventListener("scroll",y),f.value=!1)}),(a,i)=>(v(),p(x,null,[i[0]||(i[0]=u("h3",{class:"sub-class"},"导航器",-1)),u("div",K,[u("ul",null,[(v(!0),p(x,null,q(s.value,o=>(v(),p("li",{key:o.id,class:k(o.class),onClick:e=>g(o)},[u("span",{id:o.id,class:k({active:h.value==o.id})},C(o.title),11,J)],10,P))),128))])])],64))}},V=B(O,[["__scopeId","data-v-824df357"]]),W=["title","onClick"],X={class:"content-box"},Y=["innerHTML"],Z={key:1,class:"loading"},Q={__name:"index",setup(w){const h=H(),_=R(),f=r([]),d=r(null),s=r(""),g=async l=>{if(l==s.value)return!1;m.value=-1,i.value=[],c.value&&(c.value.scrollTop=0),d.value=await z(l),s.value=l;let t=setTimeout(()=>{const n=document.querySelectorAll("pre code");n&&n.length>0&&n.forEach(b=>{G.highlightBlock(b)}),clearTimeout(t),o()},0)},c=r(null),y=r(!1),m=r(0),a=()=>{c.value.scrollTop>100?y.value=!0:y.value=!1},i=r([]),o=async()=>{const l=document.querySelector(".contenter");if(!l)return!1;m.value<0?m.value=Math.floor(Math.random()*1e3):m.value++,i.value=await D(l),F()},e=r({show:!1,message:"",type:""}),N=()=>{e.value.show=!1,e.value.message=""},A=async l=>{if(l)try{if(navigator.clipboard)await navigator.clipboard.writeText(l.innerText),e.value.message="复制成功",e.value.type="success";else{const t=document.createElement("input");t.value=l.innerText,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),e.value.message="复制成功",e.value.type="success"}e.value.show=!0}catch{e.value.message="复制失败，请重试",e.value.type="error",e.value.show=!0}else e.value.message="未找到代码块",e.value.type="warning",e.value.show=!0},F=()=>{document.querySelectorAll("pre code").forEach(t=>{const n=document.createElement("button");n.className="copy-btn",n.textContent="复制代码",n.onclick=()=>A(t),t.parentElement.appendChild(n)})};return L(()=>_.query,async l=>{l&&l.name&&await g(l.name)}),M(()=>{c.value&&c.value.addEventListener("scroll",a)}),S(()=>{c.value&&c.value.removeEventListener("scroll",a)}),$(async()=>{const t=h.currentRoute.value.query.name||"";f.value=U(),f.value.length>0&&(t?await g(t):await g(f.value[0])),m.value=1001,o()}),(l,t)=>(v(),p("div",{class:"know-box",ref_key:"knowsElement",ref:c},[u("div",{class:k(["mulu",{"fixed-sidebar":y.value}])},[t[0]||(t[0]=u("div",{class:"ml-title"},[u("h4",null,"知识库")],-1)),u("ul",null,[(v(!0),p(x,null,q(f.value,(n,b)=>(v(),p("li",{style:I({color:n==s.value?"red":""}),key:b,title:n,onClick:ee=>g(n)},C(n.charAt(0).toUpperCase()+n.slice(1)),13,W))),128))])],2),u("div",X,[d.value?(v(),p(x,{key:0},[u("h1",null,C(s.value.charAt(0).toUpperCase()+s.value.slice(1)),1),u("div",{id:"codebox",class:"contenter",innerHTML:d.value},null,8,Y)],64)):(v(),p("div",Z,[...t[1]||(t[1]=[u("img",{src:"http://115.190.117.177:10086/images/loading.gif"},null,-1),u("p",null,"加载中...",-1)])]))]),m.value>0&&i.value.length>0?(v(),p("div",{key:0,class:k(["sub-mulu",{"fixed-sidebar":y.value}])},[(v(),T(V,{items:i.value,key:m.value},null,8,["items"]))],2)):E("",!0),e.value.show?(v(),T(j,{key:1,message:e.value.message,type:e.value.type,duration:3e3,onClosed:N},null,8,["message","type"])):E("",!0)],512))}},ue=B(Q,[["__scopeId","data-v-50e1eda3"]]);export{ue as default};
