import{r as u}from"./index-ChFF_AJc.js";class h{constructor(e,i=500,n=16.666){this.keyCode=e,this.holdTime=i,this.throttleTime=n,this.isHolding=!1,this.isMoving=!1,this.timeoutId=null,this.holdIntervalId=null,this.listeners={start:[],holding:[],end:[]}}addEventListener(e,i){this.listeners[e]&&this.listeners[e].push(i)}removeEventListener(e,i){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(n=>n!==i))}triggerEvent(e,i){this.listeners[e]&&this.listeners[e].forEach(n=>n(i))}handleKeyDown(e){e.keyCode===this.keyCode&&(this.triggerEvent("start",e),this.isHolding=!0,this.startHolding(e))}handleKeyUp(e){e.keyCode===this.keyCode&&(this.triggerEvent("end",e),this.stopHolding())}startHolding(e){this.timeoutId=setTimeout(()=>{this.isMoving=!0,this.triggerEvent("holding",e),this.holdIntervalId=setInterval(()=>{this.isMoving&&this.triggerEvent("holding",e)},this.throttleTime)},this.holdTime)}stopHolding(){this.isHolding=!1,this.isMoving=!1,clearTimeout(this.timeoutId),clearInterval(this.holdIntervalId)}static init(){const e={},i=s=>{for(const t in e)e[t].handleKeyDown(s)},n=s=>{for(const t in e)e[t].handleKeyUp(s)};return document.addEventListener("keydown",i),document.addEventListener("keyup",n),{registerKey:(s,t=500,o=16.666)=>{const l=new h(s,t,o);return e[s]=l,l},unregisterKey:s=>{e[s]&&(e[s].stopHolding(),e[s].removeAllListeners(),delete e[s])},registerComponent:s=>{const t=()=>{for(const o in e)e[o].stopHolding(),e[o].removeAllListeners();document.removeEventListener("keydown",i),document.removeEventListener("keyup",n)};s.exposed?.cleanup?s.exposed.cleanup=t:s.cleanup=t}}}}h.prototype.removeAllListeners=function(){for(const r in this.listeners)this.listeners[r]=[]};const{registerKey:c,unregisterKey:g,registerComponent:v}=h.init(),y=async()=>{let r={};const e=u({}),i=(t,o=500,l=16.666)=>{const d=c(t,o,l);return r[t]=d,e.value[t]=1,d.addEventListener("holding",a=>{e.value[t]+=a.deltaTime}),d},n=t=>e.value[t]||0,s=()=>{for(const t in r)r[t]&&(r[t].stopHolding(),r[t].removeAllListeners(),g(t));e.value={}};return v({cleanup:s}),{keyEvent:i,getKeyTime:n,clearKeys:s}},f={A:65,D:68,S:83,W:87};export{f as K,y as u};
