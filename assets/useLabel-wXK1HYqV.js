import{f as O,V as y,O as _,j as W}from"./Loading-DruFyOl3.js";import{u as R}from"./allscreen-BRzil6w2.js";import{e as b,k as q}from"./index-BW9tvWnl.js";class A extends _{constructor(r=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=r,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new W(.5,.5),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof n.element.ownerDocument.defaultView.Element&&n.element.parentNode!==null&&n.element.remove()})})}copy(r,n){return super.copy(r,n),this.element=r.element.cloneNode(!0),this.center=r.center,this}}const m=new y,g=new O,w=new O,v=new y,C=new y;class T{constructor(r={}){const n=this;let i,a,f,c;const h={objects:new WeakMap},u=r.element!==void 0?r.element:document.createElement("div");u.style.overflow="hidden",this.domElement=u,this.getSize=function(){return{width:i,height:a}},this.render=function(e,t){e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),g.copy(t.matrixWorldInverse),w.multiplyMatrices(t.projectionMatrix,g),x(e,e,t),D(e)},this.setSize=function(e,t){i=e,a=t,f=i/2,c=a/2,u.style.width=e+"px",u.style.height=t+"px"};function S(e){e.isCSS2DObject&&(e.element.style.display="none");for(let t=0,l=e.children.length;t<l;t++)S(e.children[t])}function x(e,t,l){if(e.visible===!1){S(e);return}if(e.isCSS2DObject){m.setFromMatrixPosition(e.matrixWorld),m.applyMatrix4(w);const s=m.z>=-1&&m.z<=1&&e.layers.test(l.layers)===!0,o=e.element;o.style.display=s===!0?"":"none",s===!0&&(e.onBeforeRender(n,t,l),o.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(m.x*f+f)+"px,"+(-m.y*c+c)+"px)",o.parentNode!==u&&u.appendChild(o),e.onAfterRender(n,t,l));const p={distanceToCameraSquared:M(l,e)};h.objects.set(e,p)}for(let s=0,o=e.children.length;s<o;s++)x(e.children[s],t,l)}function M(e,t){return v.setFromMatrixPosition(e.matrixWorld),C.setFromMatrixPosition(t.matrixWorld),v.distanceToSquared(C)}function z(e){const t=[];return e.traverseVisible(function(l){l.isCSS2DObject&&t.push(l)}),t}function D(e){const t=z(e).sort(function(s,o){if(s.renderOrder!==o.renderOrder)return o.renderOrder-s.renderOrder;const p=h.objects.get(s).distanceToCameraSquared,E=h.objects.get(o).distanceToCameraSquared;return p-E}),l=t.length;for(let s=0,o=t.length;s<o;s++)t[s].element.style.zIndex=l-s}}}const B=R(),F=async({labelBox:d,canvas:r})=>{const n=new T;return n.setSize(r.width,r.height),n.domElement.style.position="absolute",n.domElement.style.top="0px",(d=="body"?document.body:document.getElementById(d)).appendChild(n.domElement),n},I=(d,r="#fff",n)=>{const i=document.createElement("div");i.className="label",i.textContent=d,i.style.color=r,i.style.marginTop="-0em",i.style.fontSize="14px",i.style.opacity=1;const a=new A(i);return a.position.set(n.x,n.y,n.z),a},L=async({labelBox:d,canvasbox:r="canvas"})=>{const n=b(()=>document.querySelector(r).getBoundingClientRect());let i=await F({labelBox:d,canvas:n});return q(()=>B.getFlagStatus,(a,f)=>{if(!i)return;let c=document.querySelector(r);c&&a!=f&&i.setSize(c.getBoundingClientRect().width,c.getBoundingClientRect().height)},{immediate:!0}),i};export{I as c,L as u};
