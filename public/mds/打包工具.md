## Rolldown
### 介绍
Rolldown是用Rust编写的专为Vite设计的打包构建工具，构建是rollup的10-30倍。

官方：[https://rolldown.rs/](https://rolldown.rs/)

### 安装使用
```bash
# 全局
npm install -g rolldown
# 本地安装
npm install -D rolldown
npm install rolldown --save-dev
```

#### 单行打包命令
```javascript
"scripts": {
    "build-iife": "rolldown src/index.js --format iife --output dist/bundle.js",
    "build-cjs": "rolldown src/index.js --format cjs --output dist/bundle.js",
    "build-esm": "rolldown src/main.js --format esm --output dist/bundle.js",	
    "build-umd": "rolldown src/index.js --format umd --output dist/bundle.js"
}
```

#### 配置文件多类型
新建配置文件 <font style="color:rgb(9, 105, 218) !important;">rolldown.config.js</font>

```css
export default {
  
  input: 'src/main.js',
  output: [
    // ESM 格式
    {
      file: 'dist/canvas-utils.esm.js',
      format: 'esm',
      exports: 'default'
    },
    // CommonJS 格式
    {
      file: 'dist/canvas-utils.cjs.js',
      format: 'cjs',
      exports: 'auto'
    },
    // IIFE 格式
    {
      file: 'dist/canvas-utils.min.js',
      format: 'iife',
      name: 'CanvasUtils',
      globals: {}, // 如果有外部依赖在这里声明
      plugins: []  // 可以添加压缩插件
    }
  ],
  // 确保不会错误处理浏览器API
  context: 'window',
  // 外部依赖声明
  external: [],
  // 启用摇树优化
  treeshake: true,
  // 错误处理
  onwarn(warning, warn) {
    if (warning.code === 'THIS_IS_UNDEFINED') return;
    warn(warning);
  }
};
```

修改 <font style="color:rgb(31, 35, 40);">package.json 文件</font>

```javascript
{
  "type": "module",
  "scripts": {
    "build": "rolldown --config rolldown.config.js"
  },
}
```

## Rollup
### <font style="color:rgb(44, 44, 54);">介绍</font>
<font style="color:rgb(44, 44, 54);">Rollup 是用 JavaScript 编写的打包工具，意味着开发者可以利用庞大的 npm 包库来扩展 Rollup 的功能。</font>

### <font style="color:rgb(44, 44, 54);">安装使用</font>
```bash
# 全局安装
npm install --global rollup
# 本地安装
npm install rollup --save-dev
```

#### 单行打包命令
```javascript
"scripts": {
    "build-cjs": "rollup src/main.js -o bundle.js -f cjs",
    "build-umd": "rollup src/main.js -o bundle.js -f umd",
    "build-esm": "rollup src/main.js -o bundle.js -f esm",	
    "build-iife": "npx rollup src/main.js -o bundle.js -f iife"
}
```

#### 批量打包多类型
新建配置文件 rollup.config.js

```javascript
// rollup.config.js
export default {
  input: 'src/main.js',
  output: [
    { file: 'dist/esm.js', format: 'esm' },
    { file: 'dist/cjs.js', format: 'cjs' },
    { file: 'dist/iife.js', format: 'iife', name: 'MyLib' }
  ]
};
```

修改配置文件package.json

```javascript
{
  "type": "module",
  "scripts": {
    "build": "rollup -c"
  },
}
```

